define("discourse/plugins/discourse-jira/discourse/components/fields/dj-base-field",["exports","@ember/component"],function(e,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class t extends s.default{tagName=""
field=null
label=null
saveIssue=null}e.default=t}),define("discourse/plugins/discourse-jira/discourse/components/fields/dj-date-field",["exports","@ember/component","@ember/helper","@ember/modifier","@ember/object","discourse/components/d-button","discourse/helpers/with-event-value","discourse/plugins/discourse-jira/discourse/components/fields/dj-base-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-field-label","@ember/template-factory"],function(e,s,t,i,o,n,r,l,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends l.default{convertToUniversalTime(e){return e&&this.set("field.value",moment(e).utc().format())}static{dt7948.n(this.prototype,"convertToUniversalTime",[o.action])}get localTime(){return this.field.value&&moment(this.field.value).local().format(moment.HTML5_FMT.DATETIME_LOCAL)}static{dt7948.n(this.prototype,"localTime",[(0,o.computed)("field.metadata.value")])}static{(0,s.setComponentTemplate)((0,d.createTemplateFactory)({id:"wpiQhq0n",block:'[[[1,"\\n    "],[10,"section"],[14,0,"field date-field"],[12],[1,"\\n      "],[10,0],[14,0,"control-group"],[12],[1,"\\n        "],[8,[32,0],null,[["@label","@field"],[[30,0,["label"]],[30,0,["field"]]]],null],[1,"\\n\\n        "],[10,0],[14,0,"controls"],[12],[1,"\\n          "],[10,0],[14,0,"controls-row"],[12],[1,"\\n            "],[8,[32,1],[[4,[32,2],["input",[28,[32,3],[[30,0,["convertToUniversalTime"]]],null]],null]],[["@value","@type"],[[28,[31,0],[[30,0,["localTime"]]],null],"date"]],null],[1,"\\n\\n"],[41,[30,0,["field","value"]],[[[1,"              "],[8,[32,4],null,[["@icon","@action"],["trash-alt",[28,[32,5],[[28,[31,2],[[30,0,["field","value"]]],null],null],null]]],null],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,["readonly","if","mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/fields/dj-date-field.js",scope:()=>[a.default,s.Input,i.on,r.default,n.default,t.fn],isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-jira/discourse/components/fields/dj-dropdown-field",["exports","@ember/helper","@ember/object","select-kit/components/combo-box","discourse/plugins/discourse-jira/discourse/components/fields/dj-base-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-field-label","@ember/component","@ember/template-factory"],function(e,s,t,i,o,n,r,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends o.default{get replacedContent(){return(this.field.options||[]).map(e=>({id:e.id,name:e.value}))}static{dt7948.n(this.prototype,"replacedContent",[(0,t.computed)("field.options.[]")])}static{(0,r.setComponentTemplate)((0,l.createTemplateFactory)({id:"+zRbit3/",block:'[[[1,"\\n    "],[10,0],[14,0,"field control-group"],[12],[1,"\\n      "],[8,[32,0],null,[["@label","@field"],[[30,0,["label"]],[30,0,["field"]]]],null],[1,"\\n\\n      "],[10,0],[14,0,"controls"],[12],[1,"\\n        "],[8,[32,1],null,[["@value","@content","@onChange","@options"],[[30,0,["field","value"]],[30,0,["replacedContent"]],[28,[32,2],[[28,[31,0],[[30,0,["field","value"]]],null]],null],[28,[32,3],null,[["allowAny","disabled"],[false,[30,0,["field","isDisabled"]]]]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,["mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/fields/dj-dropdown-field.js",scope:()=>[n.default,i.default,s.fn,s.hash],isStrictMode:!0}),this)}}e.default=a}),define("discourse/plugins/discourse-jira/discourse/components/fields/dj-field-label",["exports","@ember/component","@ember/template-factory"],function(e,s,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends s.default{field=null
label=null
static{(0,s.setComponentTemplate)((0,t.createTemplateFactory)({id:"C1ygoq22",block:'[[[1,"\\n"],[41,[30,0,["label"]],[[[1,"      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[10,1],[12],[1,"\\n          "],[1,[30,0,["label"]]],[1,"\\n"],[41,[30,0,["field","required"]],[[[1,"            *\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/fields/dj-field-label.js",isStrictMode:!0}),this)}}e.default=i}),define("discourse/plugins/discourse-jira/discourse/components/fields/dj-multiselect-field",["exports","@ember/helper","@ember/object","select-kit/components/multi-select","discourse/plugins/discourse-jira/discourse/components/fields/dj-base-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-field-label","@ember/component","@ember/template-factory"],function(e,s,t,i,o,n,r,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends o.default{get replacedContent(){return(this.field.options||[]).map(e=>({id:e.id,name:e.value}))}static{dt7948.n(this.prototype,"replacedContent",[(0,t.computed)("field.options.[]")])}static{(0,r.setComponentTemplate)((0,l.createTemplateFactory)({id:"09Wsu5Up",block:'[[[1,"\\n    "],[10,0],[14,0,"field control-group"],[12],[1,"\\n      "],[8,[32,0],null,[["@label","@field"],[[30,0,["label"]],[30,0,["field"]]]],null],[1,"\\n\\n      "],[10,0],[14,0,"controls"],[12],[1,"\\n        "],[8,[32,1],null,[["@content","@value","@onChange"],[[30,0,["replacedContent"]],[30,0,["field","value"]],[28,[32,2],[[28,[31,0],[[30,0,["field","value"]]],null]],null]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,["mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/fields/dj-multiselect-field.js",scope:()=>[n.default,i.default,s.fn],isStrictMode:!0}),this)}}e.default=a}),define("discourse/plugins/discourse-jira/discourse/components/fields/dj-text-field",["exports","@ember/component","@ember/helper","@ember/modifier","discourse/helpers/with-event-value","discourse/plugins/discourse-jira/discourse/components/fields/dj-base-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-field-label","@ember/template-factory"],function(e,s,t,i,o,n,r,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends n.default{static{(0,s.setComponentTemplate)((0,l.createTemplateFactory)({id:"LKQItgy+",block:'[[[1,"\\n    "],[10,"section"],[14,0,"field text-field"],[12],[1,"\\n      "],[10,0],[14,0,"control-group"],[12],[1,"\\n        "],[8,[32,0],null,[["@label","@field"],[[30,0,["label"]],[30,0,["field"]]]],null],[1,"\\n\\n        "],[10,0],[14,0,"controls"],[12],[1,"\\n          "],[10,0],[14,0,"field-wrapper"],[12],[1,"\\n            "],[8,[32,1],[[4,[32,2],["input",[28,[32,3],[[28,[32,4],[[28,[31,0],[[30,0,["field","value"]]],null]],null]],null]],null]],[["@value","@required"],[[30,0,["field","value"]],[30,0,["field","required"]]]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,["mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/fields/dj-text-field.js",scope:()=>[r.default,s.Input,i.on,o.default,t.fn],isStrictMode:!0}),this)}}e.default=a}),define("discourse/plugins/discourse-jira/discourse/components/fields/dj-textarea-field",["exports","@ember/helper","discourse/components/d-textarea","discourse/helpers/with-event-value","discourse/plugins/discourse-jira/discourse/components/fields/dj-field-label","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,s,t,i,o,n,r,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.setComponentTemplate)((0,r.createTemplateFactory)({id:"WwDRUa0r",block:'[[[1,"\\n  "],[10,"section"],[14,0,"field text-field"],[12],[1,"\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[8,[32,0],null,[["@label","@field"],[[30,0,["label"]],[30,0,["field"]]]],null],[1,"\\n\\n      "],[10,0],[14,0,"controls"],[12],[1,"\\n        "],[10,0],[14,0,"field-wrapper"],[12],[1,"\\n          "],[8,[32,1],null,[["@value","@input"],[[30,0,["field","metadata","value"]],[28,[32,2],[[28,[32,3],[[28,[31,0],[[30,0,["field","metadata","value"]]],null]],null]],null]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[],false,["mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/fields/dj-textarea-field.js",scope:()=>[o.default,t.default,i.default,s.fn],isStrictMode:!0}),(0,l.default)(void 0,"dj-textarea-field:DjTextareaField"))
e.default=a}),define("discourse/plugins/discourse-jira/discourse/components/jira-field",["exports","@glimmer/component","discourse/plugins/discourse-jira/discourse/components/fields/dj-date-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-dropdown-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-multiselect-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-text-field","discourse/plugins/discourse-jira/discourse/components/fields/dj-textarea-field","@ember/component","@ember/template-factory"],function(e,s,t,i,o,n,r,l,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends s.default{get component(){switch(this.args.field.field_type){case"string":return["description","summary"].includes(this.args.field.key)?r.default:n.default
case"array":return o.default
case"option":return i.default
case"date":return t.default
default:return n.default}}static{(0,l.setComponentTemplate)((0,a.createTemplateFactory)({id:"b90vXJXe",block:'[[[1,"\\n    "],[8,[30,0,["component"]],null,[["@field","@saveIssue","@label"],[[30,1],[30,2],[30,1,["name"]]]],null],[1,"\\n  "]],["@field","@saveIssue"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/jira-field.js",isStrictMode:!0}),this)}}e.default=d}),define("discourse/plugins/discourse-jira/discourse/components/jira-issue",["exports","@glimmer/component","@ember/helper","discourse/helpers/concat-class","discourse/helpers/d-icon","@ember/component","@ember/template-factory"],function(e,s,t,i,o,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends s.default{static shouldRender(e){return e.post.jira_issue}get issue(){return this.args.post.jira_issue}get url(){return this.issue.self.replace(/\/rest\/api\/.*$/,"/browse/"+this.issue.key)}static{(0,n.setComponentTemplate)((0,r.createTemplateFactory)({id:"4aonL63h",block:'[[[1,"\\n    "],[10,0],[14,0,"cooked"],[12],[1,"\\n      "],[10,"aside"],[14,0,"quote jira-issue"],[15,"data-jira-key",[30,0,["issue","key"]]],[12],[1,"\\n        "],[10,0],[14,0,"title"],[12],[1,"\\n          "],[1,[28,[32,0],["tag"],null]],[1,"\\n          "],[10,3],[15,6,[30,0,["url"]]],[12],[1,[30,0,["issue","fields","summary"]]],[13],[1,"\\n        "],[13],[1,"\\n        "],[10,"blockquote"],[12],[1,"\\n          "],[10,"i"],[12],[1,"("],[1,[30,0,["issue","key"]]],[1,")"],[13],[1,"\\n          "],[10,1],[15,0,[28,[32,1],["jira-status",[28,[32,2],["jira-status-",[30,0,["issue","fields","status","id"]]],null]],null]],[12],[1,"\\n            "],[1,[30,0,["issue","fields","status","name"]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/jira-issue.js",scope:()=>[o.default,i.default,t.concat],isStrictMode:!0}),this)}}e.default=l}),define("discourse/plugins/discourse-jira/discourse/components/modal/attach",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/object","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax","discourse/lib/ajax-error","discourse-i18n","@ember/template-factory"],function(e,s,t,i,o,n,r,l,a,d,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends s.default{static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#e=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"issueKey",[t.tracked],function(){return null})}#s=void dt7948.i(this,"issueKey")
static{dt7948.g(this.prototype,"issueUrl",[t.tracked],function(){return null})}#t=void dt7948.i(this,"issueUrl")
topicId=this.args.model.topic_id
postNumber=this.args.model.post_number
get disabled(){return this.loading||!this.issueKey}async attachIssue(){try{this.loading=!0
const e=await(0,l.ajax)("/jira/issues/attach",{type:"POST",data:{issue_key:this.issueKey,topic_id:this.topicId,post_number:this.postNumber}})
this.issueKey=e.issue_key,this.issueUrl=e.issue_url}catch(e){(0,a.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"attachIssue",[o.action])}static{(0,i.setComponentTemplate)((0,u.createTemplateFactory)({id:"WrOUNuq1",block:'[[[1,"\\n    "],[8,[32,0],null,[["@title","@closeModal"],[[28,[32,1],["discourse_jira.attach_issue"],null],[30,1]]],[["body","footer"],[[[[1,"\\n"],[41,[30,0,["issueUrl"]],[[[1,"          "],[10,2],[12],[1,"\\n            "],[1,[28,[32,1],["discourse_jira.issue_creation_success"],[["issueKey"],[[30,0,["issueKey"]]]]]],[1,"\\n          "],[13],[1,"\\n          "],[10,2],[12],[10,3],[15,6,[30,0,["issueUrl"]]],[12],[1,[30,0,["issueKey"]]],[13],[13],[1,"\\n"]],[]],[[[1,"          "],[10,0],[14,0,"form"],[12],[1,"\\n            "],[10,"section"],[14,0,"field"],[12],[1,"\\n              "],[10,"section"],[14,0,"field-item"],[12],[1,"\\n                "],[10,"label"],[12],[1,[28,[32,1],["discourse_jira.attach_form.issue_key"],null]],[13],[1,"\\n                "],[8,[32,2],[[24,0,"jira-key"],[24,"autofocus","autofocus"]],[["@value"],[[30,0,["issueKey"]]]],null],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"      "]],[]],[[[1,"\\n"],[41,[30,0,["issueUrl"]],[[[1,"          "],[8,[32,3],[[24,0,"btn-primary"]],[["@action","@label"],[[30,1],"discourse_jira.attach_form.continue"]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,3],[[24,0,"btn-primary"]],[["@action","@label","@disabled","@isLoading"],[[30,0,["attachIssue"]],"discourse_jira.attach_issue",[30,0,["disabled"]],[30,0,["loading"]]]],null],[1,"\\n"]],[]]],[1,"      "]],[]]]]],[1,"\\n  "]],["@closeModal"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/modal/attach.js",scope:()=>[r.default,d.i18n,i.Input,n.default],isStrictMode:!0}),this)}}e.default=c}),define("discourse/plugins/discourse-jira/discourse/components/modal/create",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/object","@ember-compat/tracked-built-ins","discourse/components/d-button","discourse/components/d-modal","discourse/components/d-textarea","discourse/lib/ajax","discourse/lib/ajax-error","discourse-i18n","select-kit/components/combo-box","discourse/plugins/discourse-jira/discourse/components/jira-field","@ember/template-factory"],function(e,s,t,i,o,n,r,l,a,d,u,c,p,f,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class j extends s.default{static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#e=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"projects",[t.tracked],function(){return[]})}#i=void dt7948.i(this,"projects")
static{dt7948.g(this.prototype,"topicId",[t.tracked],function(){return null})}#o=void dt7948.i(this,"topicId")
static{dt7948.g(this.prototype,"postNumber",[t.tracked],function(){return null})}#n=void dt7948.i(this,"postNumber")
static{dt7948.g(this.prototype,"projectId",[t.tracked],function(){return null})}#r=void dt7948.i(this,"projectId")
static{dt7948.g(this.prototype,"issueTypeId",[t.tracked],function(){return null})}#l=void dt7948.i(this,"issueTypeId")
static{dt7948.g(this.prototype,"fields",[t.tracked],function(){return new n.TrackedArray([])})}#a=void dt7948.i(this,"fields")
static{dt7948.g(this.prototype,"title",[t.tracked],function(){return""})}#d=void dt7948.i(this,"title")
static{dt7948.g(this.prototype,"description",[t.tracked],function(){return""})}#u=void dt7948.i(this,"description")
static{dt7948.g(this.prototype,"issueKey",[t.tracked],function(){return null})}#s=void dt7948.i(this,"issueKey")
static{dt7948.g(this.prototype,"issueUrl",[t.tracked],function(){return null})}#t=void dt7948.i(this,"issueUrl")
constructor(){super(...arguments),this.preflightChecks(),this.fillDescription(this.args.model)}get issueTypes(){const e=this.projects.findBy("id",this.projectId)
return e?e.issue_types:[]}get disabled(){return this.loading||!this.projectId||!this.issueTypeId||!this.description||this.requiredFields.filter(e=>!e.value).length}get descriptionText(){return this.topicId?"discourse_jira.create_form.review_description":"discourse_jira.create_form.provide_description"}get requiredFields(){return this.fields.filter(e=>e.required)}get optionalFields(){return this.fields.filter(e=>!e.required)}async preflightChecks(){this.loading=!0
try{const e=await(0,d.ajax)("/jira/issues/preflight")
e.projects&&(this.projects=e.projects)}catch(e){(0,u.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"preflightChecks",[o.action])}async fillDescription(e){this.loading=!0
try{const s=await(0,d.ajax)("/jira/posts",{type:"PUT",data:{topic_id:e.topic_id,post_number:e.post_number}})
s&&(this.topicId=e.topic_id,this.postNumber=e.post_number,this.title=e.topic.title,this.description=s.formatted_post_history.substring(0,32767))}catch(s){(0,u.popupAjaxError)(s)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"fillDescription",[o.action])}async createIssue(){this.loading=!0
try{const e=this.fields.map(e=>({required:e.required,value:e.value,key:e.key,field_type:e.field_type})),s=await(0,d.ajax)("/jira/issues",{type:"POST",data:{project_id:this.projectId,issue_type_id:this.issueTypeId,title:this.title,description:this.description,topic_id:this.topicId,post_number:this.postNumber,fields:e}})
this.issueKey=s.issue_key,this.issueUrl=s.issue_url}catch(e){(0,u.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"createIssue",[o.action])}onChangeProject(e){this.projectId=e}static{dt7948.n(this.prototype,"onChangeProject",[o.action])}onChangeIssueType(e){this.issueTypeId=e,this.fetchFields()}static{dt7948.n(this.prototype,"onChangeIssueType",[o.action])}fetchFields(){this.loading=!0,(0,d.ajax)("/jira/issue/createmeta",{type:"GET",data:{project_id:this.projectId,issue_type_id:this.issueTypeId}}).then(e=>{e.fields&&(this.fields=e.fields.map(e=>new n.TrackedObject(e)))}).catch(u.popupAjaxError).finally(()=>this.loading=!1)}static{(0,i.setComponentTemplate)((0,m.createTemplateFactory)({id:"sCIXG4vM",block:'[[[1,"\\n    "],[8,[32,0],null,[["@title","@closeModal"],[[28,[32,1],["discourse_jira.attach_issue"],null],[30,1]]],[["body","footer"],[[[[1,"\\n"],[41,[30,0,["issueKey"]],[[[1,"          "],[10,2],[12],[1,[28,[32,1],["discourse_jira.issue_creation_success"],[["issueKey"],[[30,0,["issueKey"]]]]]],[13],[1,"\\n          "],[10,2],[12],[10,3],[15,6,[30,0,["issueUrl"]]],[12],[1,[30,0,["issueKey"]]],[13],[13],[1,"\\n"]],[]],[[[1,"          "],[10,0],[14,0,"create-issue form"],[12],[1,"\\n            "],[10,"section"],[14,0,"field"],[12],[1,"\\n              "],[10,"section"],[14,0,"field-item project"],[12],[1,"\\n                "],[10,"label"],[12],[1,[28,[32,1],["discourse_jira.create_form.project"],null]],[13],[1,"\\n                "],[8,[32,2],null,[["@name","@content","@valueProperty","@value","@onChange"],["project_id",[30,0,["projects"]],"id",[30,0,["projectId"]],[30,0,["onChangeProject"]]]],null],[1,"\\n              "],[13],[1,"\\n\\n              "],[10,"section"],[14,0,"field-item issue-type"],[12],[1,"\\n                "],[10,"label"],[12],[1,[28,[32,1],["discourse_jira.create_form.issue_type"],null]],[13],[1,"\\n                "],[8,[32,2],null,[["@name","@content","@value","@onChange"],["issue_type",[30,0,["issueTypes"]],[30,0,["issueTypeId"]],[30,0,["onChangeIssueType"]]]],null],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,"section"],[14,0,"field"],[12],[1,"\\n              "],[10,"label"],[12],[1,[28,[32,1],["discourse_jira.create_form.title"],null]],[13],[1,"\\n              "],[8,[32,3],[[24,0,"jira-title"],[24,"autofocus","autofocus"]],[["@value"],[[30,0,["title"]]]],null],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,"section"],[14,0,"field"],[12],[1,"\\n              "],[10,"label"],[12],[1,[28,[32,1],["discourse_jira.create_form.description"],null]],[13],[1,"\\n              "],[8,[32,4],[[24,0,"jira-description"],[24,"autofocus","autofocus"]],[["@value","@maxlength"],[[30,0,["description"]],"32767"]],null],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,0],[14,0,"required-fields"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["requiredFields"]]],null]],null],null,[[[1,"                "],[8,[32,5],null,[["@field"],[[30,2]]],null],[1,"\\n"]],[2]],null],[1,"            "],[13],[1,"\\n\\n"],[41,[30,0,["optionalFields"]],[[[1,"              "],[10,"details"],[14,0,"optional-fields"],[12],[1,"\\n                "],[10,"summary"],[12],[1,"Optional Fields"],[13],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["optionalFields"]]],null]],null],null,[[[1,"                  "],[8,[32,5],null,[["@field"],[[30,3]]],null],[1,"\\n"]],[3]],null],[1,"              "],[13],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n"]],[]]],[1,"\\n      "]],[]],[[[1,"\\n"],[41,[30,0,["issueKey"]],[[[1,"          "],[8,[32,6],[[24,0,"btn-primary"]],[["@action","@label"],[[30,1],"discourse_jira.create_form.continue"]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,6],[[24,0,"btn-primary"]],[["@action","@label","@disabled","@isLoading"],[[30,0,["createIssue"]],"discourse_jira.create_issue",[30,0,["disabled"]],[30,0,["loading"]]]],null],[1,"\\n"]],[]]],[1,"      "]],[]]]]],[1,"\\n  "]],["@closeModal","field","field"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/modal/create.js",scope:()=>[l.default,c.i18n,p.default,i.Input,a.default,f.default,r.default],isStrictMode:!0}),this)}}e.default=j}),define("discourse/plugins/discourse-jira/discourse/components/post-menu/jira-menu-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/components/dropdown-menu","discourse-i18n","float-kit/components/d-menu","discourse/plugins/discourse-jira/discourse/components/modal/attach","discourse/plugins/discourse-jira/discourse/components/modal/create","@ember/component","@ember/template-factory"],function(e,s,t,i,o,n,r,l,a,d,u,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends s.default{static shouldRender(e){return!e.post.jira_issue}static{dt7948.g(this.prototype,"modal",[i.service])}#c=void dt7948.i(this,"modal")
attachIssue(){this.modal.show(a.default,{model:this.args.post})}static{dt7948.n(this.prototype,"attachIssue",[t.action])}createIssue(){this.modal.show(d.default,{model:this.args.post})}static{dt7948.n(this.prototype,"createIssue",[t.action])}static{(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"7KgHLPOK",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"post-action-menu__jira-menu jira-menu"],[17,1]],[["@autofocus","@identifier","@icon","@modalForMobile","@title"],[true,"post-jira-menu","fab-jira",true,[28,[32,1],["discourse_jira.menu.title"],null]]],[["default"],[[[[1,"\\n      "],[8,[32,2],null,null,[["default"],[[[[1,"\\n        "],[8,[30,2,["item"]],null,null,[["default"],[[[[1,"\\n          "],[8,[32,3],[[24,0,"post-action-menu__jira-create-issue create-issue btn-transparent"]],[["@action","@icon","@label"],[[30,0,["createIssue"]],"plus","discourse_jira.menu.create_issue"]],null],[1,"\\n        "]],[]]]]],[1,"\\n        "],[8,[30,2,["item"]],null,null,[["default"],[[[[1,"\\n          "],[8,[32,3],[[24,0,"post-action-menu__jira-attach-issue attach-issue btn-transparent"]],[["@action","@icon","@label"],[[30,0,["attachIssue"]],"paperclip","discourse_jira.menu.attach_issue"]],null],[1,"\\n        "]],[]]]]],[1,"\\n      "]],[2]]]]],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["&attrs","dropdown"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/components/post-menu/jira-menu-button.js",scope:()=>[l.default,r.i18n,n.default,o.default],isStrictMode:!0}),this)}}e.default=p}),define("discourse/plugins/discourse-jira/discourse/connectors/category-custom-settings/jira-settings",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","discourse/helpers/with-event-value","discourse/lib/ajax","discourse/lib/ajax-error","discourse-i18n","select-kit/components/combo-box","@ember/component","@ember/template-factory"],function(e,s,t,i,o,n,r,l,a,d,u,c,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class f extends s.default{static shouldRender(e,s){return s.siteSettings.discourse_jira_enabled}static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#e=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"projects",[t.tracked],function(){return[]})}#i=void dt7948.i(this,"projects")
static{dt7948.g(this.prototype,"projectId",[t.tracked],function(){return null})}#r=void dt7948.i(this,"projectId")
static{dt7948.g(this.prototype,"issueTypeId",[t.tracked],function(){return null})}#l=void dt7948.i(this,"issueTypeId")
constructor(){super(...arguments),this.preflightChecks()}get category(){return this.args.outletArgs.category}get issueTypes(){const e=this.projects.findBy("id",this.projectId)
return e?e.issue_types:[]}onChangeProject(e){this.projectId=e,this.category.custom_fields.jira_project_id=e}static{dt7948.n(this.prototype,"onChangeProject",[n.action])}onChangeIssueType(e){this.issueTypeId=e,this.category.custom_fields.jira_issue_type_id=e}static{dt7948.n(this.prototype,"onChangeIssueType",[n.action])}async preflightChecks(){this.loading=!0
try{const e=await(0,l.ajax)("/jira/issues/preflight")
e.projects&&(this.projects=e.projects,this.projectId=this.category.custom_fields.jira_project_id,this.issueTypeId=this.category.custom_fields.jira_issue_type_id)}catch(e){(0,a.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"preflightChecks",[n.action])}static{(0,c.setComponentTemplate)((0,p.createTemplateFactory)({id:"J3FOZV9U",block:'[[[1,"\\n    "],[10,0],[14,0,"jira-settings"],[12],[1,"\\n      "],[10,"h3"],[12],[1,[28,[32,0],["discourse_jira.category_setting.title"],null]],[13],[1,"\\n      "],[10,"section"],[14,0,"field jira-project"],[12],[1,"\\n        "],[10,"label"],[12],[1,[28,[32,0],["discourse_jira.category_setting.project"],null]],[13],[1,"\\n        "],[10,0],[14,0,"controls"],[12],[1,"\\n          "],[8,[32,1],null,[["@name","@content","@valueProperty","@value","@onChange"],["project_id",[30,0,["projects"]],"id",[30,0,["projectId"]],[30,0,["onChangeProject"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[10,"section"],[14,0,"field jira-project"],[12],[1,"\\n        "],[10,"label"],[12],[1,[28,[32,0],["discourse_jira.category_setting.issue_type"],null]],[13],[1,"\\n        "],[10,0],[14,0,"controls"],[12],[1,"\\n          "],[8,[32,1],null,[["@name","@content","@value","@onChange"],["issue_type",[30,0,["issueTypes"]],[30,0,["issueTypeId"]],[30,0,["onChangeIssueType"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[10,"section"],[14,0,"field jira-project"],[12],[1,"\\n        "],[10,"label"],[12],[1,[28,[32,0],["discourse_jira.category_setting.num_likes_auto_create_issue"],null]],[13],[1,"\\n        "],[10,0],[14,0,"controls"],[12],[1,"\\n          "],[11,"input"],[24,"min","1"],[16,2,[30,0,["category","custom_fields","jira_num_likes_auto_create_issue"]]],[24,4,"number"],[4,[32,2],["input",[28,[32,3],[[28,[32,4],[[28,[31,0],[[30,0,["category","custom_fields","jira_num_likes_auto_create_issue"]]],null]],null]],null]],null],[12],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,["mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-jira/discourse/connectors/category-custom-settings/jira-settings.js",scope:()=>[d.i18n,u.default,o.on,r.default,i.fn],isStrictMode:!0}),this)}}e.default=f}),define("discourse/plugins/discourse-jira/discourse/initializers/add-discourse-jira-button",["exports","discourse/lib/deprecated","discourse/lib/icon-library","discourse/lib/plugin-api","discourse/widgets/post-cooked","discourse/plugins/discourse-jira/discourse/components/jira-issue","discourse/plugins/discourse-jira/discourse/components/post-menu/jira-menu-button"],function(e,s,t,i,o,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-jira",initialize(e){e.lookup("service:site-settings").discourse_jira_enabled&&(0,i.withPluginApi)(e=>{(function(e){e.addTrackedPostProperties("jira_issue"),e.renderAfterWrapperOutlet("post-content-cooked-html",n.default),(0,s.withSilencedDeprecations)("discourse.post-stream-widget-overrides",()=>function(e){e.decorateWidget("post-contents:after-cooked",e=>{const s=e.getModel()
if(!s||!s.jira_issue)return
const i=s.jira_issue,n=i.self.replace(/\/rest\/api\/.*$/,"/browse/"+i.key),r=`\n            <aside class='quote jira-issue' data-jira-key='${i.key}'>\n              <div class='title'>\n                ${(0,t.iconHTML)("tag")}\n                <a href='${n}'>${i.fields.summary}</a>\n              </div>\n              <blockquote>\n                <i>(${i.key})</i>\n                <span class='jira-status jira-status-${i.fields.status.id}'>\n                  ${i.fields.status.name}\n                </span>\n              </blockquote>\n            </aside>\n          `,l=new o.default({cooked:r},e)
return e.rawHtml(l.init())})}(e))})(e),function(e){const s=e.getCurrentUser()
e.registerValueTransformer("post-menu-buttons",({value:e,context:{firstButtonKey:t}})=>{s?.can_create_jira_issue&&e.add("jira",r.default,{before:t})})}(e)})}}})

//# sourceMappingURL=discourse-jira-c9fed07c.map