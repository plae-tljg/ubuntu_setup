define("discourse/plugins/discourse-translator/discourse/components/post-menu/toggle-translation-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/ajax-error","@ember/component","@ember/template-factory"],function(t,s,e,a,n,i,r,o,l){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0
class d extends s.default{static shouldRender(t){return t.post.can_translate}static{dt7948.g(this.prototype,"modal",[a.service])}#t=void dt7948.i(this,"modal")
static{dt7948.g(this.prototype,"translator",[a.service])}#s=void dt7948.i(this,"translator")
get isTranslating(){return this.args.post.isTranslating}get isTranslated(){return this.args.post.isTranslated}get showButton(){return this.args.post.can_translate}get title(){return this.isTranslating?"translator.translating":this.isTranslated?"translator.hide_translation":"translator.view_translation"}hideTranslation(){this.args.post.isTranslated=!1,this.args.post.isTranslating=!1,this.translator.clearPostTranslation(this.args.post)}static{dt7948.n(this.prototype,"hideTranslation",[e.action])}toggleTranslation(){return this.args.post.isTranslated?this.hideTranslation():this.translate()}static{dt7948.n(this.prototype,"toggleTranslation",[e.action])}async translate(){const t=this.args.post
t.isTranslating=!0
try{await this.translator.translatePost(t),t.isTranslated=!0}catch(s){this.translator.clearPostTranslation(this.args.post),t.isTranslated=!1,(0,r.popupAjaxError)(s)}finally{t.isTranslating=!1}}static{dt7948.n(this.prototype,"translate",[e.action])}static{(0,o.setComponentTemplate)((0,l.createTemplateFactory)({id:"GKS3VYUU",block:'[[[1,"\\n"],[41,[30,0,["showButton"]],[[[1,"      "],[8,[32,0],[[16,0,[28,[32,1],["post-action-menu__translate",[52,[30,0,["isTranslated"]],"translated"]],null]],[17,1]],[["@action","@disabled","@icon","@label","@title"],[[30,0,["toggleTranslation"]],[30,0,["isTranslating"]],"globe",[52,[30,2],[30,0,["title"]]],[30,0,["title"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],["&attrs","@showLabel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-translator/discourse/components/post-menu/toggle-translation-button.js",scope:()=>[n.default,i.default],isStrictMode:!0}),this)}}t.default=d}),define("discourse/plugins/discourse-translator/discourse/components/translated-post-indicator",["exports","@glimmer/component","discourse-i18n","float-kit/components/d-tooltip","@ember/component","@ember/template-factory"],function(t,s,e,a,n,i){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0
class r extends s.default{get tooltip(){return(0,e.i18n)("translator.originally_written_in",{language:this.args.data.detectedLanguage})}static{(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"6jkTZpUr",block:'[[[1,"\\n    "],[8,[32,0],null,[["@identifier","@icon","@content"],["discourse-translator_translated-post-indicator","language",[30,0,["tooltip"]]]],null],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-translator/discourse/components/translated-post-indicator.js",scope:()=>[a.default],isStrictMode:!0}),this)}}t.default=r}),define("discourse/plugins/discourse-translator/discourse/components/translated-post",["exports","@glimmer/component","@ember/service","@ember/template","discourse/components/conditional-loading-spinner","discourse-i18n","@ember/component","@ember/template-factory"],function(t,s,e,a,n,i,r,o){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0
class l extends s.default{static shouldRender(t){return t.post.isTranslated||t.post.isTranslating}static{dt7948.g(this.prototype,"siteSettings",[e.service])}#e=void dt7948.i(this,"siteSettings")
get loading(){return this.post.isTranslating}get isTranslated(){return this.post.isTranslated}get post(){return this.args.outletArgs.post}get translatedText(){return this.post.translatedText}get translatedTitle(){return this.post.translatedTitle}static{(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"3o7+qr7j",block:'[[[1,"\\n    "],[10,0],[14,0,"post-translation"],[12],[1,"\\n      "],[8,[32,0],[[24,0,"post-translation"]],[["@condition","@size"],[[30,0,["loading"]],"small"]],[["default"],[[[[1,"\\n        "],[10,"hr"],[12],[13],[1,"\\n"],[41,[30,0,["translatedTitle"]],[[[1,"          "],[10,0],[14,0,"topic-attribution"],[12],[1,"\\n            "],[1,[30,0,["translatedTitle"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"        "],[10,0],[14,0,"post-attribution"],[12],[1,"\\n          "],[1,[28,[32,1],["translator.translated_from"],[["language","translator"],[[30,0,["post","detectedLang"]],[30,0,["siteSettings","translator_provider"]]]]]],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"cooked"],[12],[1,"\\n          "],[1,[28,[32,2],[[30,0,["post","translatedText"]]],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-translator/discourse/components/translated-post.js",scope:()=>[n.default,i.i18n,a.htmlSafe],isStrictMode:!0}),this)}}t.default=l}),define("discourse/plugins/discourse-translator/discourse/initializers/extend-for-translate-button",["exports","discourse/lib/plugin-api","discourse/plugins/discourse-translator/discourse/components/post-menu/toggle-translation-button","discourse/plugins/discourse-translator/discourse/components/translated-post"],function(t,s,e,a){"use strict"
function n(t){t.container.lookup("service:site-settings").translator_enabled&&function(t){t.registerValueTransformer("post-menu-buttons",({value:t,context:{firstButtonKey:s}})=>{t.add("translate",e.default,{before:s})}),t.addTrackedPostProperties("detectedLang","isTranslating","isTranslated","translatedText","translatedTitle"),t.renderBeforeWrapperOutlet("post-menu",a.default)}(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0
t.default={name:"extend-for-translate-button",initialize(){(0,s.withPluginApi)("1.39.2",t=>n(t))}}}),define("discourse/plugins/discourse-translator/discourse/services/translator",["exports","@ember/service","discourse/lib/ajax"],function(t,s,e){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0
class a extends s.default{static{dt7948.g(this.prototype,"siteSettings",[s.service])}#e=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"appEvents",[s.service])}#a=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"documentTitle",[s.service])}#n=void dt7948.i(this,"documentTitle")
async translatePost(t){const s=await(0,e.ajax)("/translator/translate",{type:"POST",data:{post_id:t.id}})
t.detectedLang=s.detected_lang,t.translatedText=s.translation,t.translatedTitle=s.title_translation}clearPostTranslation(t){t.detectedLang=null,t.translatedText=null,t.translatedTitle=null}}t.default=a})

//# sourceMappingURL=discourse-translator-3db31bfa.map