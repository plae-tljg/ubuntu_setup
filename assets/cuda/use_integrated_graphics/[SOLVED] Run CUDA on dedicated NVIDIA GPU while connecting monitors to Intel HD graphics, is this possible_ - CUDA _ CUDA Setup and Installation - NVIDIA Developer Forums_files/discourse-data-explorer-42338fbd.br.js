define("discourse/plugins/discourse-data-explorer/admin/adapters/query",["exports","admin/adapters/build-plugin"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.default)("explorer").extend({})}),define("discourse/plugins/discourse-data-explorer/discourse/components/code-view",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,t.setComponentTemplate)((0,r.createTemplateFactory)({id:"Y/NEd3wQ",block:'[[[1,"\\n  "],[10,"pre"],[12],[10,"code"],[15,0,[30,1]],[12],[1,[30,2]],[13],[13],[1,"\\n"]],["@codeClass","@value"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/code-view.js",isStrictMode:!0}),(0,s.default)(void 0,"code-view:CodeView"))
e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/components/data-explorer-bar-chart",["exports","@glimmer/component","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","discourse/lib/decorators","discourse/lib/load-script","discourse/plugins/discourse-data-explorer/discourse/lib/themeColor","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n,a,l,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{chart
barsColor=(0,a.default)("--tertiary")
barsHoverColor=(0,a.default)("--tertiary-high")
gridColor=(0,a.default)("--primary-low")
labelsColor=(0,a.default)("--primary-medium")
willDestroy(){super.willDestroy(...arguments),this.chart.destroy()}get config(){return{type:"bar",data:this.data,options:this.options}}get data(){return{labels:this.args.labels,datasets:[{label:this.args.datasetName,data:this.args.values,backgroundColor:this.barsColor,hoverBackgroundColor:this.barsHoverColor}]}}get options(){return{scales:{legend:{labels:{fontColor:this.labelsColor}},xAxes:[{gridLines:{color:this.gridColor,zeroLineColor:this.gridColor},ticks:{fontColor:this.labelsColor}}],yAxes:[{gridLines:{color:this.gridColor,zeroLineColor:this.gridColor},ticks:{beginAtZero:!0,fontColor:this.labelsColor}}]}}}async initChart(e){await(0,n.default)("/javascripts/Chart.min.js")
const t=e.getContext("2d")
this.chart=new Chart(t,this.config)}static{dt7948.n(this.prototype,"initChart",[i.bind])}updateChartData(){this.chart.data=this.data,this.chart.update()}static{dt7948.n(this.prototype,"updateChartData",[s.action])}static{(0,l.setComponentTemplate)((0,u.createTemplateFactory)({id:"wYJzNUVF",block:'[[[1,"\\n    "],[11,"canvas"],[4,[32,0],[[30,0,["initChart"]]],null],[4,[32,1],["change",[30,0,["updateChartData"]]],null],[12],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/data-explorer-bar-chart.js",scope:()=>[o.default,r.on],isStrictMode:!0}),this)}}e.default=d}),define("discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/utils","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/helpers/with-event-value","discourse/lib/decorators","discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema/one-table","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n,a,l,u,d,c,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static{dt7948.g(this.prototype,"filter",[r.tracked])}#e=void dt7948.i(this,"filter")
static{dt7948.g(this.prototype,"loading",[r.tracked])}#t=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"hideSchema",[r.tracked],function(){return this.args.hideSchema})}#r=void dt7948.i(this,"hideSchema")
get transformedSchema(){const e=this.args.schema
for(const t in e)e.hasOwnProperty(t)&&e[t].forEach(e=>{const t=[]
e.primary&&t.push("primary key"),e.is_nullable&&t.push("null"),e.column_default&&t.push("default "+e.column_default),e.fkey_info&&t.push("fkey "+e.fkey_info),e.denormal&&t.push("denormal "+e.denormal)
const r=t.join(", ")
r&&(e.notes=r),(e.enum||e.column_desc)&&(e.havepopup=!0),e.havetypeinfo=!!(e.notes||e.enum||e.column_desc)})
return e}get filteredTables(){let e=[],t=this.filter
try{(0,i.isBlank)(this.filter)||(t=new RegExp(this.filter))}catch{t=null}const r=!!t
for(const s in this.transformedSchema)if(this.transformedSchema.hasOwnProperty(s))if(r)if(t.source===s||t.source+"s"===s)e.unshift({name:s,columns:this.transformedSchema[s],open:r})
else if(t.test(s))e.push({name:s,columns:this.transformedSchema[s],open:r})
else{let o=[]
this.transformedSchema[s].forEach(e=>{t.source===e.column_name?o.unshift(e):t.test(e.column_name)&&o.push(e)}),(0,i.isEmpty)(o)||e.push({name:s,columns:o,open:r})}else e.push({name:s,columns:this.transformedSchema[s],open:!1})
return e}updateFilter(e){this.filter=e.toLowerCase(),this.loading=!1}static{dt7948.n(this.prototype,"updateFilter",[(0,u.debounce)(500)])}filterChanged(e){this.loading=!0,this.updateFilter(e)}static{dt7948.n(this.prototype,"filterChanged",[o.action])}collapseSchema(){this.hideSchema=!0,this.args.updateHideSchema(!0)}static{dt7948.n(this.prototype,"collapseSchema",[o.action])}expandSchema(){this.hideSchema=!1,this.args.updateHideSchema(!1)}static{dt7948.n(this.prototype,"expandSchema",[o.action])}static{(0,c.setComponentTemplate)((0,p.createTemplateFactory)({id:"QYfHpBC4",block:'[[[1,"\\n"],[41,[30,0,["hideSchema"]],[[[1,"      "],[8,[32,0],[[24,0,"no-text unhide"]],[["@action","@icon"],[[30,0,["expandSchema"]],"chevron-left"]],null],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"schema"],[12],[1,"\\n        "],[10,0],[14,0,"schema-search inline-form full-width"],[12],[1,"\\n          "],[11,"input"],[24,4,"text"],[4,[32,1],["input",[28,[32,2],[[30,0,["filterChanged"]]],null]],null],[12],[13],[1,"\\n          "],[8,[32,0],[[24,0,"no-text"]],[["@action","@icon"],[[30,0,["collapseSchema"]],"chevron-right"]],null],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"schema-container"],[12],[1,"\\n          "],[8,[32,3],null,[["@condition"],[[30,0,["loading"]]]],[["default"],[[[[1,"\\n            "],[10,"ul"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["filteredTables"]]],null]],null],null,[[[1,"                "],[8,[32,4],null,[["@table"],[[30,1]]],null],[1,"\\n"]],[1]],null],[1,"            "],[13],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]]],[1,"  "]],["table"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema.js",scope:()=>[a.default,s.on,l.default,n.default,d.default],isStrictMode:!0}),this)}}e.default=m}),define("discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema/enum-info",["exports","@glimmer/component","@ember/component","@ember/template-factory"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get enuminfo(){return Object.entries(this.args.col.enum).map(([e,t])=>({value:e,name:t}))}static{(0,r.setComponentTemplate)((0,s.createTemplateFactory)({id:"EnzLmMgQ",block:'[[[1,"\\n    "],[10,"ol"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["enuminfo"]]],null]],null],null,[[[1,"        "],[10,"li"],[15,2,[30,1,["value"]]],[12],[1,"\\n          "],[1,[30,1,["name"]]],[1,"\\n        "],[13],[1,"\\n"]],[1]],null],[1,"    "],[13],[1,"\\n  "]],["enum"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema/enum-info.js",isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema/one-table",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","discourse/helpers/d-icon","discourse/lib/decorators","discourse-i18n","discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema/enum-info","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n,a,l,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static{dt7948.g(this.prototype,"open",[r.tracked],function(){return this.args.table.open})}#s=void dt7948.i(this,"open")
get styles(){return this.open?"open":""}toggleOpen(){this.open=!this.open}static{dt7948.n(this.prototype,"toggleOpen",[i.bind])}static{(0,l.setComponentTemplate)((0,u.createTemplateFactory)({id:"dy2GmGnx",block:'[[[1,"\\n    "],[10,"li"],[15,0,[29,["schema-table ",[30,0,["styles"]]]]],[12],[1,"\\n"],[1,"      "],[11,0],[24,0,"schema-table-name"],[24,"role","button"],[4,[32,0],["click",[30,0,["toggleOpen"]]],null],[12],[1,"\\n"],[41,[30,0,["open"]],[[[1,"          "],[1,[28,[32,1],["caret-down"],null]],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[32,1],["caret-right"],null]],[1,"\\n"]],[]]],[1,"        "],[1,[30,1,["name"]]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"schema-table-cols"],[12],[1,"\\n"],[41,[30,0,["open"]],[[[1,"          "],[10,"dl"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1,["columns"]]],null]],null],null,[[[1,"              "],[10,0],[12],[1,"\\n                "],[10,"dt"],[15,0,[52,[30,2,["sensitive"]],"sensitive"]],[15,"title",[52,[30,2,["sensitive"]],[28,[32,2],["explorer.schema.sensitive"],null]]],[12],[1,"\\n"],[41,[30,2,["sensitive"]],[[[1,"                    "],[1,[28,[32,1],["triangle-exclamation"],null]],[1,"\\n"]],[]],null],[1,"                  "],[1,[30,2,["column_name"]]],[1,"\\n                "],[13],[1,"\\n                "],[10,"dd"],[12],[1,"\\n                  "],[1,[30,2,["data_type"]]],[1,"\\n"],[41,[30,2,["havetypeinfo"]],[[[1,"                    "],[10,"br"],[12],[13],[1,"\\n"],[41,[30,2,["havepopup"]],[[[1,"                      "],[10,0],[14,0,"popup-info"],[12],[1,"\\n                        "],[1,[28,[32,1],["info"],null]],[1,"\\n                        "],[10,0],[14,0,"popup"],[12],[1,"\\n                          "],[1,[30,2,["column_desc"]]],[1,"\\n"],[41,[30,2,["enum"]],[[[1,"                            "],[8,[32,3],null,[["@col"],[[30,2]]],null],[1,"\\n"]],[]],null],[1,"                        "],[13],[1,"\\n                      "],[13],[1,"\\n"]],[]],null],[1,"                    "],[10,1],[14,0,"schema-typenotes"],[12],[1,"\\n                      "],[1,[30,2,["notes"]]],[1,"\\n                    "],[13],[1,"\\n"]],[]],null],[1,"                "],[13],[1,"\\n              "],[13],[1,"\\n"]],[2]],null],[1,"          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@table","col"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema/one-table.js",scope:()=>[s.on,o.default,n.i18n,a.default],isStrictMode:!0}),this)}}e.default=d}),define("discourse/plugins/discourse-data-explorer/discourse/components/modal/query-help",["exports","@ember/template","discourse/components/d-modal","discourse-i18n","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,o.setComponentTemplate)((0,i.createTemplateFactory)({id:"DG9/T/vs",block:'[[[1,"\\n  "],[8,[32,0],null,[["@title","@closeModal"],[[28,[32,1],["explorer.help.modal_title"],null],[30,1]]],[["body"],[[[[1,"\\n      "],[1,[28,[32,2],[[28,[32,1],["explorer.help.auto_resolution"],null]],null]],[1,"\\n      "],[1,[28,[32,2],[[28,[32,1],["explorer.help.custom_params"],null]],null]],[1,"\\n      "],[1,[28,[32,2],[[28,[32,1],["explorer.help.default_values"],null]],null]],[1,"\\n      "],[1,[28,[32,2],[[28,[32,1],["explorer.help.data_types"],null]],null]],[1,"\\n    "]],[]]]]],[1,"\\n"]],["@closeModal"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/modal/query-help.js",scope:()=>[r.default,s.i18n,t.htmlSafe],isStrictMode:!0}),(0,n.default)(void 0,"query-help:QueryHelp"))
e.default=a}),define("discourse/plugins/discourse-data-explorer/discourse/components/param-input-form",["exports","@glimmer/component","@ember/object","@ember/service","@ember/string","@ember/utils","discourse/components/conditional-loading-spinner","discourse/components/form","discourse/models/category","discourse-i18n","discourse/plugins/discourse-data-explorer/discourse/components/param-input/boolean-three","discourse/plugins/discourse-data-explorer/discourse/components/param-input/category-id-input","discourse/plugins/discourse-data-explorer/discourse/components/param-input/group-input","discourse/plugins/discourse-data-explorer/discourse/components/param-input/user-id-input","discourse/plugins/discourse-data-explorer/discourse/components/param-input/user-list-input","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i,n,a,l,u,d,c,p,m,h,f,g,y){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ParamValidationError=e.ERRORS=void 0
class b extends Error{}e.ParamValidationError=b
const x={int:"int",bigint:"string",boolean:"boolean",string:"string",time:"time",date:"date",datetime:"datetime",double:"string",user_id:"user_id",post_id:"string",topic_id:"generic",category_id:"category_id",group_id:"group_list",badge_id:"generic",int_list:"generic",string_list:"generic",user_list:"user_list",group_list:"group_list"},v=e.ERRORS={REQUIRED:(0,u.i18n)("form_kit.errors.required"),NOT_AN_INTEGER:(0,u.i18n)("form_kit.errors.not_an_integer"),NOT_A_NUMBER:(0,u.i18n)("form_kit.errors.not_a_number"),OVERFLOW_HIGH:(0,u.i18n)("form_kit.errors.too_high",{count:2147484647}),OVERFLOW_LOW:(0,u.i18n)("form_kit.errors.too_low",{count:-2147484648}),INVALID:(0,u.i18n)("explorer.form.errors.invalid"),NO_SUCH_CATEGORY:(0,u.i18n)("explorer.form.errors.no_such_category"),NO_SUCH_GROUP:(0,u.i18n)("explorer.form.errors.no_such_group"),INVALID_DATE:e=>(0,u.i18n)("explorer.form.errors.invalid_date",{date:e}),INVALID_TIME:e=>(0,u.i18n)("explorer.form.errors.invalid_time",{time:e})}
function _(e,t){switch(e){case"string":case"int":return null!=t?String(t):""
case"boolean":return String(t)
case"group_list":case"user_list":return t?.join(",")
case"group_id":return t[0]
case"datetime":return t?.replaceAll("T"," ")
default:return t?.toString()}}function w(e){switch(x[e.type]){case"boolean":return e.nullable?"required":""
case"string":case"string_list":case"generic":return e.nullable?"":"required:trim"
default:return e.nullable?"":"required"}}const k={int:(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"Ui8byv2k",block:'[[[1,"\\n    "],[8,[30,1,["Input"]],[[16,3,[30,2,["identifier"]]]],[["@type"],["number"]],null],[1,"\\n  "]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input-form.js",isStrictMode:!0}),(0,y.default)(void 0,void 0)),boolean:(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"EZWX6cT0",block:'[[[8,[30,1,["Checkbox"]],[[16,3,[30,2,["identifier"]]]],null,null]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input-form.js",isStrictMode:!0}),(0,y.default)(void 0,void 0)),boolean_three:d.default,category_id:c.default,user_id:m.default,user_list:h.default,group_list:p.default,date:(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"OzZxZsFL",block:'[[[1,"\\n    "],[8,[30,1,["Input"]],[[16,3,[30,2,["identifier"]]]],[["@type"],["date"]],null],[1,"\\n  "]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input-form.js",isStrictMode:!0}),(0,y.default)(void 0,void 0)),time:(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"fJpbDe7u",block:'[[[1,"\\n    "],[8,[30,1,["Input"]],[[16,3,[30,2,["identifier"]]]],[["@type"],["time"]],null],[1,"\\n  "]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input-form.js",isStrictMode:!0}),(0,y.default)(void 0,void 0)),datetime:(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"LSXrF4Ey",block:'[[[1,"\\n    "],[8,[30,1,["Input"]],[[16,3,[30,2,["identifier"]]]],[["@type"],["datetime-local"]],null],[1,"\\n  "]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input-form.js",isStrictMode:!0}),(0,y.default)(void 0,void 0)),default:(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"RWJET0M1",block:'[[[8,[30,1,["Input"]],[[16,3,[30,2,["identifier"]]]],null,null]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input-form.js",isStrictMode:!0}),(0,y.default)(void 0,void 0))}
function j(e){let t=x[e.type]||"generic"
return e.nullable&&"boolean"===t&&(t="boolean_three"),k[t]||k.default}class T extends t.default{static{dt7948.g(this.prototype,"site",[s.service])}#o=void dt7948.i(this,"site")
data={}
paramInfo=[]
infoOf={}
form=null
promiseNormalizations=[]
formLoaded=new Promise(e=>{this.__form_load_callback=e})
constructor(){super(...arguments),this.initializeParams(),this.args.onRegisterApi?.({submit:this.submit,allNormalized:Promise.allSettled(this.promiseNormalizations)})}initializeParams(){this.args.paramInfo.forEach(e=>{const t=e.identifier,r=this.createParamInfo(e)
this.paramInfo.push(r),this.infoOf[t]=e
const s=this.getNormalizedValue(e)
s instanceof Promise?this.handlePromiseNormalization(s,r):this.data[t]=s})}createParamInfo(e){return r.default.create({...e,validation:w(e),validate:this.validatorOf(e),component:j(e)})}async addError(e,t){await this.formLoaded,this.form.addError(e,{title:e,message:t})}static{dt7948.n(this.prototype,"addError",[r.action])}normalizeValue(e,t){switch(e.type){case"category_id":return function(e){return e=String(e||""),!/^\d+$/.test(e)&&e.trim()?l.default.asyncFindBySlugPath((0,o.dasherize)(e)).then(e=>e.id).catch(t=>{throw 404===t.jqXHR?.status?new b(`${v.NO_SUCH_CATEGORY}: ${e}`):new Error(t.errorThrow||t.message)}):e}(t)
case"boolean":return null==t||"#null"===t?!!e.nullable&&"#null":"true"===t
case"group_id":case"group_list":const r=this.normalizeGroups(t)
return r.errorMsg&&this.addError(e.identifier,r.errorMsg),"group_id"===e.type?r.value.slice(0,1):r.value
case"user_list":return Array.isArray(t)?t||null:t?.split(",")||null
case"user_id":return Array.isArray(t)?t[0]:t
case"date":try{return t?moment(t).format("YYYY-MM-DD"):null}catch{return this.addError(e.identifier,v.INVALID_DATE(String(t))),null}case"time":try{return t?moment(new Date(`1970/01/01 ${t}`).toISOString()).format("HH:mm"):null}catch{return this.addError(e.identifier,v.INVALID_TIME(String(t))),null}case"datetime":try{return t?moment(new Date(t).toISOString()).format("YYYY-MM-DD HH:mm"):null}catch{return this.addError(e.identifier,v.INVALID_TIME(String(t))),null}default:return t}}static{dt7948.n(this.prototype,"normalizeValue",[r.action])}getNormalizedValue(e){const t=this.args.initialValues,r=e.identifier
return this.normalizeValue(e,t&&r in t?t[r]:e.default)}handlePromiseNormalization(e,t){this.promiseNormalizations.push(e),t.set("loading",!0),this.data[t.identifier]=null,e.then(e=>this.form.set(t.identifier,e)).catch(e=>this.addError(t.identifier,e.message)).finally(()=>t.set("loading",!1))}normalizeGroups(e){e||=[],"string"==typeof e&&(e=e.split(","))
const t=new Set(this.site.get("groups").map(e=>e.name)),r=Object.fromEntries(this.site.get("groups").map(e=>[e.id,e.name])),s=[],o=[]
for(const i of e)t.has(i)?s.push(i):r[Number(i)]?s.push(r[Number(i)]):o.push(String(i))
return{value:s,errorMsg:0!==o.length?`${v.NO_SUCH_GROUP}: ${o.join(", ")}`:null}}static{dt7948.n(this.prototype,"normalizeGroups",[r.action])}getErrorFn(e){const t=e=>/^\d+$/.test(e)
return{int:e=>e>=2147483648?v.OVERFLOW_HIGH:e<=-2147483649?v.OVERFLOW_LOW:null,bigint:e=>isNaN(parseInt(e,10))?v.NOT_A_NUMBER:/^-?\d+$/.test(e)?null:v.NOT_AN_INTEGER,boolean:e=>/^Y|N|#null|true|false/.test(String(e))?null:v.INVALID,double:e=>isNaN(parseFloat(e))?/^(-?)Inf(inity)?$/i.test(e)||/^(-?)NaN$/i.test(e)?null:v.NOT_A_NUMBER:null,int_list:e=>e.split(",").every(e=>/^(-?\d+|null)$/.test(e.trim()))?null:v.INVALID,post_id:e=>t(e)||/\d+\/\d+(\?u=.*)?$/.test(e)||/\/t\/[^/]+\/(\d+)(\?u=.*)?/.test(e)?null:v.INVALID,topic_id:e=>t(e)||/\/t\/[^/]+\/(\d+)/.test(e)?null:v.INVALID,category_id:e=>this.site.categoriesById.get(Number(e))?null:v.NO_SUCH_CATEGORY,group_list:e=>this.normalizeGroups(e).errorMsg,group_id:e=>this.normalizeGroups(e).errorMsg}[e.type]??(()=>null)}validatorOf(e){const t=this.getErrorFn(e)
return(r,s,{addError:o})=>{if((0,i.isEmpty)(s)||null==s)return
const n=t(s)
null!=n&&o(r,{title:e.identifier,message:n})}}async submit(){if(null==this.form)throw"No form"
if(this.serializedData=null,await this.form.submit(),null==this.serializedData)throw new b("validation_failed")
return this.serializedData}static{dt7948.n(this.prototype,"submit",[r.action])}onRegisterApi(e){this.__form_load_callback(),this.form=e}static{dt7948.n(this.prototype,"onRegisterApi",[r.action])}onSubmit(e){const t={}
for(const[r,s]of Object.entries(e))t[r]=_(this.infoOf[r].type,s)??void 0
this.serializedData=t}static{dt7948.n(this.prototype,"onSubmit",[r.action])}static{(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"K6kFJTOW",block:'[[[1,"\\n    "],[10,0],[14,0,"query-params"],[12],[1,"\\n      "],[8,[32,0],[[24,0,"params-form"]],[["@data","@onRegisterApi","@onSubmit"],[[30,0,["data"]],[30,0,["onRegisterApi"]],[30,0,["onSubmit"]]]],[["default"],[[[[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["paramInfo"]]],null]],null],null,[[[1,"          "],[10,0],[14,0,"param"],[12],[1,"\\n            "],[8,[30,1,["Field"]],null,[["@name","@title","@validation","@validate"],[[30,2,["identifier"]],[30,2,["identifier"]],[30,2,["validation"]],[30,2,["validate"]]]],[["default"],[[[[1,"\\n              "],[8,[30,2,["component"]],null,[["@field","@info"],[[30,3],[30,2]]],null],[1,"\\n              "],[8,[32,1],null,[["@condition","@size"],[[30,2,["loading"]],"small"]],null],[1,"\\n            "]],[3]]]]],[1,"\\n          "],[13],[1,"\\n"]],[2]],null],[1,"      "]],[1]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["form","info","field"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input-form.js",scope:()=>[a.default,n.default],isStrictMode:!0}),this)}}e.default=T}),define("discourse/plugins/discourse-data-explorer/discourse/components/param-input/boolean-three",["exports","discourse-i18n","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,r.setComponentTemplate)((0,s.createTemplateFactory)({id:"cc7ywRhg",block:'[[[1,"\\n  "],[8,[30,1,["Select"]],[[16,3,[30,2,["identifier"]]]],null,[["default"],[[[[1,"\\n    "],[8,[30,3,["Option"]],null,[["@value"],["Y"]],[["default"],[[[[1,"\\n      "],[1,[28,[32,0],["explorer.types.bool.true"],null]],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[30,3,["Option"]],null,[["@value"],["N"]],[["default"],[[[[1,"\\n      "],[1,[28,[32,0],["explorer.types.bool.false"],null]],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[30,3,["Option"]],null,[["@value"],["#null"]],[["default"],[[[[1,"\\n      "],[1,[28,[32,0],["explorer.types.bool.null_"],null]],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[3]]]]],[1,"\\n"]],["@field","@info","select"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input/boolean-three.js",scope:()=>[t.i18n],isStrictMode:!0}),(0,o.default)(void 0,"boolean-three:BooleanThree"))
e.default=i}),define("discourse/plugins/discourse-data-explorer/discourse/components/param-input/category-id-input",["exports","@glimmer/component","@ember/helper","select-kit/components/category-chooser","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{get data(){return{value:this.args.field.value}}static{(0,o.setComponentTemplate)((0,i.createTemplateFactory)({id:"wmz1RnhC",block:'[[[1,"\\n    "],[8,[30,1,["Custom"]],[[16,1,[30,1,["id"]]]],null,[["default"],[[[[1,"\\n      "],[8,[32,0],[[16,3,[30,2,["identifier"]]]],[["@value","@onChange","@options"],[[30,0,["data","value"]],[30,1,["set"]],[28,[32,1],null,[["allowUncategorized","autoInsertNoneItem","none"],[null,true,true]]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input/category-id-input.js",scope:()=>[s.default,r.hash],isStrictMode:!0}),this)}}e.default=n}),define("discourse/plugins/discourse-data-explorer/discourse/components/param-input/group-input",["exports","@glimmer/component","@ember/service","select-kit/components/group-chooser","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{static{dt7948.g(this.prototype,"site",[r.service])}#o=void dt7948.i(this,"site")
get allGroups(){return this.site.get("groups")}get groupChooserOption(){return"group_id"===this.args.info.type?{maximum:1}:{}}static{(0,o.setComponentTemplate)((0,i.createTemplateFactory)({id:"+pze88n5",block:'[[[1,"\\n    "],[8,[30,1,["Custom"]],[[16,1,[30,1,["id"]]]],null,[["default"],[[[[1,"\\n      "],[8,[32,0],[[16,3,[30,2,["identifier"]]]],[["@content","@value","@labelProperty","@valueProperty","@onChange","@options"],[[30,0,["allGroups"]],[30,1,["value"]],"name","name",[30,1,["set"]],[30,0,["groupChooserOption"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input/group-input.js",scope:()=>[s.default],isStrictMode:!0}),this)}}e.default=n}),define("discourse/plugins/discourse-data-explorer/discourse/components/param-input/user-id-input",["exports","@ember/helper","select-kit/components/email-group-user-chooser","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,s.setComponentTemplate)((0,o.createTemplateFactory)({id:"CNPvwRat",block:'[[[1,"\\n  "],[8,[30,1,["Custom"]],[[16,1,[30,1,["id"]]]],null,[["default"],[[[[1,"\\n    "],[8,[32,0],[[16,3,[30,2,["identifier"]]]],[["@value","@options","@onChange"],[[30,1,["value"]],[28,[32,1],null,[["maximum"],[1]]],[30,1,["set"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input/user-id-input.js",scope:()=>[r.default,t.hash],isStrictMode:!0}),(0,i.default)(void 0,"user-id-input:UserIdInput"))
e.default=n}),define("discourse/plugins/discourse-data-explorer/discourse/components/param-input/user-list-input",["exports","select-kit/components/email-group-user-chooser","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,r.setComponentTemplate)((0,s.createTemplateFactory)({id:"y3XBxOri",block:'[[[1,"\\n  "],[8,[30,1,["Custom"]],[[16,1,[30,1,["id"]]]],null,[["default"],[[[[1,"\\n    "],[8,[32,0],[[16,3,[30,2,["identifier"]]]],[["@value","@onChange"],[[30,1,["value"]],[30,1,["set"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],["@field","@info"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/param-input/user-list-input.js",scope:()=>[t.default],isStrictMode:!0}),(0,o.default)(void 0,"user-list-input:UserListInput"))
e.default=i}),define("discourse/plugins/discourse-data-explorer/discourse/components/query-result",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","@ember/string","discourse/components/d-button","discourse/lib/ajax","discourse/lib/get-url","discourse/models/badge","discourse/models/category","discourse-i18n","discourse/plugins/discourse-data-explorer/discourse/components/data-explorer-bar-chart","discourse/plugins/discourse-data-explorer/discourse/components/query-row-content","discourse/plugins/discourse-data-explorer/discourse/components/result-types/badge","discourse/plugins/discourse-data-explorer/discourse/components/result-types/category","discourse/plugins/discourse-data-explorer/discourse/components/result-types/group","discourse/plugins/discourse-data-explorer/discourse/components/result-types/html","discourse/plugins/discourse-data-explorer/discourse/components/result-types/json","discourse/plugins/discourse-data-explorer/discourse/components/result-types/post","discourse/plugins/discourse-data-explorer/discourse/components/result-types/reltime","discourse/plugins/discourse-data-explorer/discourse/components/result-types/tag-group","discourse/plugins/discourse-data-explorer/discourse/components/result-types/text","discourse/plugins/discourse-data-explorer/discourse/components/result-types/topic","discourse/plugins/discourse-data-explorer/discourse/components/result-types/url","discourse/plugins/discourse-data-explorer/discourse/components/result-types/user","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n,a,l,u,d,c,p,m,h,f,g,y,b,x,v,_,w,k,j,T,C,S,N){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const P={topic:j.default,text:k.default,post:v.default,reltime:_.default,badge:f.default,url:T.default,user:C.default,group:y.default,html:b.default,json:x.default,category:g.default,tag_group:w.default}
class q extends t.default{static{dt7948.g(this.prototype,"site",[i.service])}#o=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"chartDisplayed",[r.tracked],function(){return!1})}#i=void dt7948.i(this,"chartDisplayed")
get colRender(){return this.args.content.colrender||{}}get rows(){return this.args.content.rows}get columns(){return this.args.content.columns}get params(){return this.args.content.params}get explainText(){return this.args.content.explain}get chartDatasetName(){return this.columnNames[1]}get columnNames(){return this.columns?this.columns.map(e=>{if(e.endsWith("_id"))return e.slice(0,-3)
const t=e.indexOf("$")
return t>=0?e.substring(t+1):e}):[]}get columnComponents(){return this.columns?this.columns.map((e,t)=>{let r="text"
return this.colRender[t]&&(r=this.colRender[t]),{name:r,component:P[r]}}):[]}get chartValues(){return this.rows.mapBy(1)}get colCount(){return this.columns.length}get resultCount(){const e=this.args.content.result_count
return e===this.args.content.default_limit?(0,p.i18n)("explorer.max_result_count",{count:e}):(0,p.i18n)("explorer.result_count",{count:e})}get duration(){return(0,p.i18n)("explorer.run_time",{value:p.default.toNumber(this.args.content.duration,{precision:1})})}get parameterAry(){let e=[]
for(let t in this.params)this.params.hasOwnProperty(t)&&e.push({key:t,value:this.params[t]})
return e}get transformedUserTable(){return O(this.args.content.relations.user)}get transformedBadgeTable(){return O(this.args.content.relations.badge,d.default)}get transformedPostTable(){return O(this.args.content.relations.post)}get transformedTopicTable(){return O(this.args.content.relations.topic)}get transformedTagGroupTable(){return O(this.args.content.relations.tag_group)}get transformedGroupTable(){return O(this.site.groups)}get canShowChart(){const e=2===this.colCount,t=this.resultCount[0]>0&&"number"==typeof this.rows[0][1],r=this.colRender[1]
return e&&t&&!r}get chartLabels(){const e={user:e=>e.username,badge:e=>e.name,topic:e=>e.title,group:e=>e.name,category:e=>e.name},t=this.colRender[0]
if(t){const r=this[`lookup${(0,n.capitalize)(t)}`],s=e[t]
if(r&&s)return this.rows.map(e=>{const t=r.call(this,e[0]),o=s(t)
return this._cutChartLabel(o)})}return this.rows.map(e=>this._cutChartLabel(e[0]))}lookupUser(e){return this.transformedUserTable[e]}lookupBadge(e){return this.transformedBadgeTable[e]}lookupPost(e){return this.transformedPostTable[e]}lookupTopic(e){return this.transformedTopicTable[e]}lookupTagGroup(e){return this.transformedTagGroupTable[e]}lookupGroup(e){return this.transformedGroupTable[e]}lookupCategory(e){return c.default.findById(e)}_cutChartLabel(e){const t=e.toString()
return t.length>25?`${t.substring(0,25)}...`:t}downloadResultJson(){this._downloadResult("json")}static{dt7948.n(this.prototype,"downloadResultJson",[s.action])}downloadResultCsv(){this._downloadResult("csv")}static{dt7948.n(this.prototype,"downloadResultCsv",[s.action])}showChart(){this.chartDisplayed=!0}static{dt7948.n(this.prototype,"showChart",[s.action])}hideChart(){this.chartDisplayed=!1}static{dt7948.n(this.prototype,"hideChart",[s.action])}_download_url(){return this.args.group?`/g/${this.args.group.name}/reports/`:"/admin/plugins/explorer/queries/"}_downloadResult(e){let t="xxxxxxxx".replace(/[xy]/g,()=>(16*Math.random()|0).toString(16))
window.open("data:text/html;base64,"+btoa("<style>body{font-size:36px;display:flex;justify-content:center;align-items:center;}</style><body>Click anywhere to close this window once the download finishes.<script>window.onclick=function(){window.close()};<\/script>"),t)
let r=document.createElement("form")
function s(e,t){let s
s=document.createElement("input"),s.setAttribute("name",e),s.setAttribute("value",t),r.appendChild(s)}r.setAttribute("id","query-download-result"),r.setAttribute("method","post"),r.setAttribute("action",(0,u.default)(this._download_url()+this.args.query.id+"/run."+e+"?download=1")),r.setAttribute("target",t),r.setAttribute("style","display:none;"),s("params",JSON.stringify(this.params)),s("explain",this.explainText),s("limit","1000000"),(0,l.ajax)("/session/csrf.json").then(e=>{s("authenticity_token",e.csrf),document.body.appendChild(r),r.submit(),(0,o.schedule)("afterRender",()=>document.body.removeChild(r))})}static{(0,S.setComponentTemplate)((0,N.createTemplateFactory)({id:"8dx01CEW",block:'[[[1,"\\n    "],[10,"article"],[12],[1,"\\n      "],[10,"header"],[14,0,"result-header"],[12],[1,"\\n        "],[10,0],[14,0,"result-info"],[12],[1,"\\n          "],[8,[32,0],null,[["@action","@icon","@label"],[[30,0,["downloadResultJson"]],"download","explorer.download_json"]],null],[1,"\\n\\n          "],[8,[32,0],null,[["@action","@icon","@label"],[[30,0,["downloadResultCsv"]],"download","explorer.download_csv"]],null],[1,"\\n\\n"],[41,[30,0,["canShowChart"]],[[[41,[30,0,["chartDisplayed"]],[[[1,"              "],[8,[32,0],null,[["@action","@icon","@label"],[[30,0,["hideChart"]],"table","explorer.show_table"]],null],[1,"\\n"]],[]],[[[1,"              "],[8,[32,0],null,[["@action","@icon","@label"],[[30,0,["showChart"]],"chart-bar","explorer.show_graph"]],null],[1,"\\n"]],[]]]],[]],null],[1,"        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"result-about"],[12],[1,"\\n          "],[1,[30,0,["resultCount"]]],[1,"\\n          "],[1,[30,0,["duration"]]],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,"br"],[12],[13],[41,[30,0,["explainText"]],[[[1,"          "],[10,"pre"],[14,0,"result-explain"],[12],[1,"        "],[10,"code"],[12],[1,[30,0,["explainText"]]],[1,"\\n            "],[13],[1,"\\n      "],[13]],[]],null],[1,"\\n        "],[10,"br"],[12],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,"section"],[12],[1,"\\n"],[41,[30,0,["chartDisplayed"]],[[[1,"          "],[8,[32,1],null,[["@labels","@values","@datasetName"],[[30,0,["chartLabels"]],[30,0,["chartValues"]],[30,0,["chartDatasetName"]]]],null],[1,"\\n"]],[]],[[[1,"          "],[10,"table"],[12],[1,"\\n            "],[10,"thead"],[12],[1,"\\n              "],[10,"tr"],[14,0,"headers"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["columnNames"]]],null]],null],null,[[[1,"                  "],[10,"th"],[12],[1,[30,1]],[13],[1,"\\n"]],[1]],null],[1,"              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,"tbody"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["rows"]]],null]],null],null,[[[1,"                "],[8,[32,2],null,[["@row","@columnComponents","@lookupUser","@lookupBadge","@lookupPost","@lookupTopic","@lookupTagGroup","@lookupGroup","@lookupCategory","@transformedPostTable","@transformedBadgeTable","@transformedUserTable","@transformedTagGroupTable","@transformedGroupTable","@transformedTopicTable","@site"],[[30,2],[30,0,["columnComponents"]],[30,0,["lookupUser"]],[30,0,["lookupBadge"]],[30,0,["lookupPost"]],[30,0,["lookupTopic"]],[30,0,["lookupTagGroup"]],[30,0,["lookupGroup"]],[30,0,["lookupCategory"]],[30,0,["transformedPostTable"]],[30,0,["transformedBadgeTable"]],[30,0,["transformedUserTable"]],[30,0,["transformedTagGroupTable"]],[30,0,["transformedGroupTable"]],[30,0,["transformedTopicTable"]],[30,0,["site"]]]],null],[1,"\\n"]],[2]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["col","row"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/query-result.js",scope:()=>[a.default,m.default,h.default],isStrictMode:!0}),this)}}function O(e,t){const r={}
return e?.forEach(e=>{r[e.id]=t?t.create(e):e}),r}e.default=q}),define("discourse/plugins/discourse-data-explorer/discourse/components/query-results-wrapper",["exports","discourse/plugins/discourse-data-explorer/discourse/components/query-result","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,r.setComponentTemplate)((0,s.createTemplateFactory)({id:"+ZPGx9xE",block:'[[[1,"\\n"],[41,[30,1],[[[1,"    "],[10,0],[14,0,"query-results"],[12],[1,"\\n"],[41,[30,2],[[[1,"        "],[8,[32,0],null,[["@query","@content"],[[30,3],[30,1]]],null],[1,"\\n"]],[]],[[[42,[28,[31,2],[[28,[31,2],[[30,1,["errors"]]],null]],null],null,[[[1,"          "],[10,"pre"],[14,0,"query-error"],[12],[10,"code"],[12],[1,[30,4]],[13],[13],[1,"\\n"]],[4]],null]],[]]],[1,"    "],[13],[1,"\\n"]],[]],null]],["@results","@showResults","@query","err"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/query-results-wrapper.js",scope:()=>[t.default],isStrictMode:!0}),(0,o.default)(void 0,"query-results-wrapper:QueryResultsWrapper"))
e.default=i}),define("discourse/plugins/discourse-data-explorer/discourse/components/query-row-content",["exports","@glimmer/component","@glimmer/tracking","@ember/string","discourse/lib/get-url","discourse/lib/utilities","discourse/plugins/discourse-data-explorer/discourse/components/result-types/text","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n,a,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{get results(){return this.args.columnComponents.map((e,t)=>{const r=this.args.row[t],a=parseInt(r,10),l={value:r,id:a,baseuri:(0,o.default)("")}
if(null===this.args.row[t])return{component:n.default,textValue:"NULL"}
if("text"===e.name)return{component:n.default,textValue:(0,i.escapeExpression)(this.args.row[t].toString())}
const u=this.args[`lookup${(0,s.classify)(e.name)}`]
if(u&&(l[e.name]=u.call(this.args,a)),"url"===e.name){let[e,t]=function(e){let[t,r]=[e,e]
const s=e.split(/,(.+)/)
s.length>1&&(r=s[0],t=s[1])
return[t,r]}(r)
l.href=e,l.target=t}try{return{component:e.component||n.default,ctx:l}}catch{return"error"}})}static{dt7948.n(this.prototype,"results",[r.cached])}static{(0,a.setComponentTemplate)((0,l.createTemplateFactory)({id:"mgr3Q2Gs",block:'[[[1,"\\n    "],[10,"tr"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["results"]]],null]],null],null,[[[1,"        "],[10,"td"],[12],[1,"\\n          "],[8,[30,1,["component"]],null,[["@ctx","@params","@textValue"],[[30,1,["ctx"]],[30,1,["params"]],[30,1,["textValue"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[1]],null],[1,"    "],[13],[1,"\\n  "]],["result"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/query-row-content.js",isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/badge",["exports","@glimmer/component","@ember/template","@ember/utils","discourse/lib/icon-library","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{get iconOrImageReplacement(){if((0,s.isEmpty)(this.args.ctx.badge.icon))return""
if(this.args.ctx.badge.icon.indexOf("fa-")>-1){const e=(0,o.iconHTML)((0,o.convertIconClass)(this.args.ctx.badge.icon))
return(0,r.htmlSafe)(e)}return(0,r.htmlSafe)("<img src='"+this.args.ctx.badge.icon+"'>")}static{(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"1B7XbnF8",block:'[[[1,"\\n    "],[10,3],[15,6,[29,[[30,1,["baseuri"]],"/badges/",[30,1,["badge","id"]],"/",[30,1,["badge","name"]]]]],[15,0,[29,["user-badge ",[30,1,["badge","badgeTypeClassName"]]]]],[15,"title",[30,1,["badge","display_name"]]],[15,"data-badge-name",[30,1,["badge","name"]]],[12],[1,"\\n      "],[1,[30,0,["iconOrImageReplacement"]]],[1,"\\n      "],[10,1],[14,0,"badge-display-name"],[12],[1,[30,1,["badge","display_name"]]],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@ctx"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/badge.js",isStrictMode:!0}),this)}}e.default=a}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/category",["exports","@glimmer/component","discourse/helpers/category-link","@ember/component","@ember/template-factory"],function(e,t,r,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get categoryBadgeReplacement(){return(0,r.categoryLinkHTML)(this.args.ctx.category,{allowUncategorized:!0})}static{(0,s.setComponentTemplate)((0,o.createTemplateFactory)({id:"jmdDnYNj",block:'[[[1,"\\n"],[41,[30,1,["category"]],[[[1,"      "],[1,[30,0,["categoryBadgeReplacement"]]],[1,"\\n"]],[]],[[[1,"      "],[10,3],[15,6,[29,[[30,1,["baseuri"]],"/t/",[30,1,["id"]]]]],[12],[1,[30,1,["id"]]],[13],[1,"\\n"]],[]]],[1,"  "]],["@ctx"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/category.js",isStrictMode:!0}),this)}}e.default=i}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/group",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,t.setComponentTemplate)((0,r.createTemplateFactory)({id:"xZ46TGLy",block:'[[[1,"\\n"],[41,[30,1,["group"]],[[[1,"    "],[10,3],[15,6,[29,[[30,1,["baseuri"]],"/groups/",[30,1,["group","name"]]]]],[12],[1,[30,1,["group","name"]]],[13],[1,"\\n"]],[]],[[[1,"    "],[1,[30,1,["id"]]],[1,"\\n"]],[]]]],["@ctx"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/group.js",isStrictMode:!0}),(0,s.default)(void 0,"group:Group"))
e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/html",["exports","@ember/template","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,r.setComponentTemplate)((0,s.createTemplateFactory)({id:"YvBUbslp",block:'[[[1,[28,[32,0],[[30,1,["value"]]],null]]],["@ctx"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/html.js",scope:()=>[t.htmlSafe],isStrictMode:!0}),(0,o.default)(void 0,"html:Html"))
e.default=i}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/json",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/components/d-button","discourse/components/modal/fullscreen-code","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n,a,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static{dt7948.g(this.prototype,"modal",[o.service])}#n=void dt7948.i(this,"modal")
get parsedJson(){try{return JSON.parse(this.args.ctx.value)}catch{return null}}static{dt7948.n(this.prototype,"parsedJson",[r.cached])}viewJson(){this.modal.show(n.default,{model:{code:this.parsedJson?JSON.stringify(this.parsedJson,null,2):this.args.ctx.value,codeClasses:""}})}static{dt7948.n(this.prototype,"viewJson",[s.action])}static{(0,a.setComponentTemplate)((0,l.createTemplateFactory)({id:"xYsvKknA",block:'[[[1,"\\n    "],[10,0],[14,0,"result-json"],[12],[1,"\\n      "],[10,0],[14,0,"result-json-value"],[12],[1,[30,1,["value"]]],[13],[1,"\\n      "],[8,[32,0],[[24,0,"result-json-button"]],[["@action","@icon","@title"],[[30,0,["viewJson"]],"ellipsis","explorer.view_json"]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@ctx"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/json.js",scope:()=>[i.default],isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/post",["exports","@ember/template","discourse/helpers/avatar","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,s.setComponentTemplate)((0,o.createTemplateFactory)({id:"aLLtMfP4",block:'[[[1,"\\n"],[41,[30,1,["post"]],[[[1,"    "],[10,"aside"],[14,0,"quote"],[15,"data-post",[30,1,["post","post_number"]]],[15,"data-topic",[30,1,["post","topic_id"]]],[12],[1,"\\n      "],[10,0],[14,0,"title"],[12],[1,"\\n        "],[10,0],[14,0,"quote-controls"],[12],[1,"\\n"],[1,"          "],[10,3],[15,6,[29,["/t/via-quote/",[30,1,["post","topic_id"]],"/",[30,1,["post","post_number"]]]]],[14,"title","go to the quoted post"],[14,0,"quote-other-topic"],[12],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,3],[14,0,"result-post-link"],[15,6,[29,["/t/",[30,1,["post","topic_id"]],"/",[30,1,["post","post_number"]]]]],[12],[1,"\\n          "],[1,[28,[32,0],[[30,1,["post"]]],[["imageSize"],["tiny"]]]],[1,[30,1,["post","username"]]],[1,":\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,"blockquote"],[12],[1,"\\n        "],[10,2],[12],[1,"\\n          "],[1,[28,[32,1],[[30,1,["post","excerpt"]]],null]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[1,[30,1,["id"]]],[1,"\\n"]],[]]]],["@ctx"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/post.js",scope:()=>[r.default,t.htmlSafe],isStrictMode:!0}),(0,i.default)(void 0,"post:Post"))
e.default=n}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/reltime",["exports","@glimmer/component","@ember/template","discourse/lib/formatter","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{get boundDateReplacement(){return(0,r.htmlSafe)((0,s.autoUpdatingRelativeAge)(new Date(this.args.ctx.value),{title:!0}))}static{(0,o.setComponentTemplate)((0,i.createTemplateFactory)({id:"c8iHnTSP",block:'[[[1,[30,0,["boundDateReplacement"]]]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/reltime.js",isStrictMode:!0}),this)}}e.default=n}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/tag-group",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,t.setComponentTemplate)((0,r.createTemplateFactory)({id:"9L2pZwcl",block:'[[[1,"\\n"],[41,[30,1,["tag_group"]],[[[1,"    "],[10,3],[15,6,[29,[[30,1,["baseuri"]],"/tag_groups/",[30,1,["id"]]]]],[12],[1,[30,1,["tag_group","name"]]],[13],[1,"\\n"]],[]],[[[1,"    "],[1,[30,1,["id"]]],[1,"\\n"]],[]]]],["@ctx"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/tag-group.js",isStrictMode:!0}),(0,s.default)(void 0,"tag-group:Group"))
e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/text",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,t.setComponentTemplate)((0,r.createTemplateFactory)({id:"hy6VFAA0",block:'[[[1,[30,1]]],["@textValue"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/text.js",isStrictMode:!0}),(0,s.default)(void 0,"text:Text"))
e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/topic",["exports","@ember/template","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,r.setComponentTemplate)((0,s.createTemplateFactory)({id:"rjoTujnl",block:'[[[1,"\\n"],[41,[30,1,["topic"]],[[[1,"    "],[10,3],[15,6,[29,[[30,1,["baseuri"]],"/t/",[30,1,["topic","slug"]],"/",[30,1,["topic","id"]]]]],[12],[1,"\\n      "],[1,[28,[32,0],[[30,1,["topic","fancy_title"]]],null]],[1,"\\n    "],[13],[1,"\\n    ("],[1,[30,1,["topic","posts_count"]]],[1,")\\n"]],[]],[[[1,"    "],[10,3],[15,6,[29,[[30,1,["baseuri"]],"/t/",[30,1,["id"]]]]],[12],[1,[30,1,["id"]]],[13],[1,"\\n"]],[]]]],["@ctx"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/topic.js",scope:()=>[t.htmlSafe],isStrictMode:!0}),(0,o.default)(void 0,"topic:Topic"))
e.default=i}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/url",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,t.setComponentTemplate)((0,r.createTemplateFactory)({id:"HtAqu+Im",block:'[[[1,"\\n  "],[10,3],[15,6,[30,1,["href"]]],[12],[1,[30,1,["target"]]],[13],[1,"\\n"]],["@ctx"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/url.js",isStrictMode:!0}),(0,s.default)(void 0,"url:Url"))
e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/components/result-types/user",["exports","discourse/helpers/avatar","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,r.setComponentTemplate)((0,s.createTemplateFactory)({id:"XVrAUXPm",block:'[[[1,"\\n"],[41,[30,1,["user"]],[[[1,"    "],[10,3],[15,6,[29,[[30,1,["baseuri"]],"/u/",[30,1,["user","username"]],"/activity"]]],[15,"data-user-card",[30,1,["user","username"]]],[12],[1,"\\n      "],[1,[28,[32,0],[[30,1,["user"]]],[["imageSize"],["tiny"]]]],[1,"\\n      "],[1,[30,1,["user","username"]]],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[1,[30,1,["id"]]],[1,"\\n"]],[]]]],["@ctx"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/result-types/user.js",scope:()=>[t.default],isStrictMode:!0}),(0,o.default)(void 0,"user:User"))
e.default=i}),define("discourse/plugins/discourse-data-explorer/discourse/components/share-report",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","discourse/components/d-button","discourse/helpers/d-icon","discourse/lib/decorators","discourse/lib/get-url","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,r,s,o,i,n,a,l,u,d,c,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static{dt7948.g(this.prototype,"visible",[r.tracked],function(){return!1})}#a=void dt7948.i(this,"visible")
element
get link(){return(0,d.default)(`/g/${this.args.group}/reports/${this.args.query.id}`)}mouseDownHandler(e){this.element.contains(e.target)||this.close()}static{dt7948.n(this.prototype,"mouseDownHandler",[u.bind])}keyDownHandler(e){27===e.keyCode&&this.close()}static{dt7948.n(this.prototype,"keyDownHandler",[u.bind])}registerListeners(e){!e||this.isDestroying||this.isDestroyed||(this.element=e,document.addEventListener("mousedown",this.mouseDownHandler),e.addEventListener("keydown",this.keyDownHandler))}static{dt7948.n(this.prototype,"registerListeners",[o.action])}unregisterListeners(e){this.element=e,document.removeEventListener("mousedown",this.mouseDownHandler),e.removeEventListener("keydown",this.keyDownHandler)}static{dt7948.n(this.prototype,"unregisterListeners",[o.action])}focusInput(e){e.select(),e.focus()}static{dt7948.n(this.prototype,"focusInput",[o.action])}open(e){e.preventDefault(),this.visible=!0}static{dt7948.n(this.prototype,"open",[o.action])}close(){this.visible=!1}static{dt7948.n(this.prototype,"close",[o.action])}static{(0,p.setComponentTemplate)((0,m.createTemplateFactory)({id:"82SkFa26",block:'[[[1,"\\n    "],[10,0],[14,0,"share-report"],[12],[1,"\\n      "],[11,3],[24,6,"#"],[24,0,"share-report-button"],[4,[32,0],["click",[30,0,["open"]]],null],[12],[1,"\\n        "],[1,[28,[32,1],["link"],null]],[1,"\\n        "],[1,[30,1]],[1,"\\n      "],[13],[1,"\\n\\n"],[41,[30,0,["visible"]],[[[1,"        "],[11,0],[24,0,"popup"],[4,[32,2],[[30,0,["registerListeners"]]],null],[4,[32,3],[[30,0,["unregisterListeners"]]],null],[12],[1,"\\n          "],[10,"label"],[12],[1,[28,[32,4],["explorer.link"],null]],[1," "],[1,[30,1]],[13],[1,"\\n          "],[11,"input"],[16,2,[30,0,["link"]]],[24,4,"text"],[4,[32,2],[[30,0,["focusInput"]]],null],[12],[13],[1,"\\n\\n          "],[8,[32,5],[[24,0,"btn-flat close"]],[["@action","@icon","@aria-label","@title"],[[30,0,["close"]],"xmark","share.close","share.close"]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@group"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/components/share-report.js",scope:()=>[s.on,l.default,i.default,n.default,c.i18n,a.default],isStrictMode:!0}),this)}}e.default=h}),define("discourse/plugins/discourse-data-explorer/discourse/connectors/group-reports-nav-item/nav-item",["exports","@ember/component","@ember/routing","@ember-decorators/component","discourse/helpers/d-icon","discourse-i18n","@ember/template-factory"],function(e,t,r,s,o,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=dt7948.c(class extends t.default{static shouldRender(e){return e.group.has_visible_data_explorer_queries}static{(0,t.setComponentTemplate)((0,n.createTemplateFactory)({id:"I3RiziI8",block:'[[[1,"\\n    "],[8,[32,0],null,[["@route"],["group.reports"]],[["default"],[[[[1,"\\n      "],[1,[28,[32,1],["chart-bar"],null]],[1,[28,[32,2],["group.reports"],null]],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/connectors/group-reports-nav-item/nav-item.js",scope:()=>[r.LinkTo,o.default,i.i18n],isStrictMode:!0}),this)}},[(0,s.classNames)("group-reports-nav-item-outlet","nav-item"),(0,s.tagName)("li")])
e.default=a})
define("discourse/plugins/discourse-data-explorer/discourse/controllers/admin-plugins-explorer-index",["exports","@glimmer/tracking","@ember/controller","@ember/object","@ember/service","rsvp","discourse/lib/ajax-error","discourse/lib/decorators","discourse-i18n"],function(e,t,r,s,o,i,n,a,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends r.default{static{dt7948.g(this.prototype,"dialog",[o.service])}#l=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"appEvents",[o.service])}#u=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"router",[o.service])}#d=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"sortByProperty",[t.tracked],function(){return"last_run_at"})}#c=void dt7948.i(this,"sortByProperty")
static{dt7948.g(this.prototype,"sortDescending",[t.tracked],function(){return!0})}#p=void dt7948.i(this,"sortDescending")
static{dt7948.g(this.prototype,"params",[t.tracked])}#m=void dt7948.i(this,"params")
static{dt7948.g(this.prototype,"search",[t.tracked])}#h=void dt7948.i(this,"search")
static{dt7948.g(this.prototype,"newQueryName",[t.tracked])}#f=void dt7948.i(this,"newQueryName")
static{dt7948.g(this.prototype,"showCreate",[t.tracked])}#g=void dt7948.i(this,"showCreate")
static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#t=void dt7948.i(this,"loading")
queryParams=["id"]
explain=!1
acceptedImportFileTypes=["application/json"]
order=null
form=null
get sortedQueries(){const e=this.model.sortBy(this.sortByProperty)
return this.sortDescending?e.reverse():e}get parsedParams(){return this.params?JSON.parse(this.params):null}get filteredContent(){const e=new RegExp(this.search,"i")
return this.sortedQueries.filter(t=>e.test(t.name)||e.test(t.description))}get createDisabled(){return 0===(this.newQueryName||"").trim().length}addCreatedRecord(e){this.model.pushObject(e),this.router.transitionTo("adminPlugins.explorer.queries.details",e.id)}async _importQuery(e){const t=await this._readFileAsTextAsync(e),r=this._parseQuery(t),s=this.store.createRecord("query",r)
return(await s.save()).target}_parseQuery(e){const t=JSON.parse(e).query
if(!t||!t.sql)throw new TypeError
return t.id=0,t}_readFileAsTextAsync(e){return new i.Promise((t,r)=>{const s=new FileReader
s.onload=()=>{t(s.result)},s.onerror=r,s.readAsText(e)})}dragMove(e){if(!e.movementY&&!e.movementX)return
const t=document.querySelector(".query-editor"),r=t.querySelector(".panels-flex"),s=t.querySelector(".grippie")
this.initialPaneWidth||this.originalPaneHeight||(this.originalPaneWidth=r.clientWidth,this.originalPaneHeight=r.clientHeight)
const o=Math.max(this.originalPaneHeight,r.clientHeight+e.movementY),i=Math.max(this.originalPaneWidth,r.clientWidth+e.movementX)
r.style.height=o+"px",r.style.width=i+"px",s.style.width=i+"px",this.appEvents.trigger("ace:resize")}static{dt7948.n(this.prototype,"dragMove",[a.bind])}scrollTop(){window.scrollTo(0,0)}static{dt7948.n(this.prototype,"scrollTop",[a.bind])}async import(e){try{this.loading=!0
const t=e[0],r=await this._importQuery(t)
this.addCreatedRecord(r)}catch(t){t.jqXHR?(0,n.popupAjaxError)(t):t instanceof SyntaxError?this.dialog.alert((0,l.i18n)("explorer.import.unparseable_json")):t instanceof TypeError?this.dialog.alert((0,l.i18n)("explorer.import.wrong_json")):(this.dialog.alert((0,l.i18n)("errors.desc.unknown")),console.error(t))}finally{this.loading=!1}}static{dt7948.n(this.prototype,"import",[s.action])}displayCreate(){this.showCreate=!0}static{dt7948.n(this.prototype,"displayCreate",[s.action])}updateSortProperty(e){this.sortByProperty===e?this.sortDescending=!this.sortDescending:(this.sortByProperty=e,this.sortDescending=!0)}static{dt7948.n(this.prototype,"updateSortProperty",[s.action])}async create(){try{const e=this.newQueryName.trim()
this.loading=!0,this.showCreate=!1
const t=await this.store.createRecord("query",{name:e}).save()
this.addCreatedRecord(t.target)}catch(e){(0,n.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"create",[s.action])}updateSearch(e){this.search=e}static{dt7948.n(this.prototype,"updateSearch",[s.action])}updateNewQueryName(e){this.newQueryName=e}static{dt7948.n(this.prototype,"updateNewQueryName",[s.action])}}e.default=u}),define("discourse/plugins/discourse-data-explorer/discourse/controllers/admin-plugins-explorer-queries-details",["exports","@glimmer/tracking","@ember/controller","@ember/object","@ember/service","rsvp","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/decorators","discourse/plugins/discourse-data-explorer/discourse/components/modal/query-help","discourse/plugins/discourse-data-explorer/discourse/components/param-input-form","discourse/plugins/discourse-data-explorer/discourse/models/query"],function(e,t,r,s,o,i,n,a,l,u,d,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends r.default{static{dt7948.g(this.prototype,"modal",[o.service])}#n=void dt7948.i(this,"modal")
static{dt7948.g(this.prototype,"appEvents",[o.service])}#u=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"router",[o.service])}#d=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"params",[t.tracked])}#m=void dt7948.i(this,"params")
static{dt7948.g(this.prototype,"editingName",[t.tracked],function(){return!1})}#y=void dt7948.i(this,"editingName")
static{dt7948.g(this.prototype,"editingQuery",[t.tracked],function(){return!1})}#b=void dt7948.i(this,"editingQuery")
static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#t=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"showResults",[t.tracked],function(){return!1})}#x=void dt7948.i(this,"showResults")
static{dt7948.g(this.prototype,"hideSchema",[t.tracked],function(){return!1})}#r=void dt7948.i(this,"hideSchema")
static{dt7948.g(this.prototype,"results",[t.tracked],function(){return this.model.results})}#v=void dt7948.i(this,"results")
static{dt7948.g(this.prototype,"dirty",[t.tracked],function(){return!1})}#_=void dt7948.i(this,"dirty")
queryParams=["params"]
explain=!1
order=null
form=null
get saveDisabled(){return!this.dirty}get runDisabled(){return this.dirty}get parsedParams(){return this.params?JSON.parse(this.params):null}get editDisabled(){return parseInt(this.model.id,10)<0}get groupOptions(){return this.groups.filter(e=>0!==e.id).map(e=>({id:e.id,name:e.name}))}async save(){try{this.loading=!0,await this.model.save(),this.dirty=!1,this.editingName=!1}catch(e){throw(0,a.popupAjaxError)(e),e}finally{this.loading=!1}}static{dt7948.n(this.prototype,"save",[s.action])}saveAndRun(){this.save().then(()=>this.run())}static{dt7948.n(this.prototype,"saveAndRun",[s.action])}async _importQuery(e){const t=await this._readFileAsTextAsync(e),r=this._parseQuery(t),s=this.store.createRecord("query",r)
return(await s.save()).target}_parseQuery(e){const t=JSON.parse(e).query
if(!t||!t.sql)throw new TypeError
return t.id=0,t}_readFileAsTextAsync(e){return new i.Promise((t,r)=>{const s=new FileReader
s.onload=()=>{t(s.result)},s.onerror=r,s.readAsText(e)})}dragMove(e){if(!e.movementY&&!e.movementX)return
const t=document.querySelector(".query-editor"),r=t.querySelector(".panels-flex"),s=t.querySelector(".grippie")
this.initialPaneWidth||this.originalPaneHeight||(this.originalPaneWidth=r.clientWidth,this.originalPaneHeight=r.clientHeight)
const o=Math.max(this.originalPaneHeight,r.clientHeight+e.movementY),i=Math.max(this.originalPaneWidth,r.clientWidth+e.movementX)
r.style.height=o+"px",r.style.width=i+"px",s.style.width=i+"px",this.appEvents.trigger("ace:resize")}static{dt7948.n(this.prototype,"dragMove",[l.bind])}didStartDrag(){}static{dt7948.n(this.prototype,"didStartDrag",[l.bind])}didEndDrag(){}static{dt7948.n(this.prototype,"didEndDrag",[l.bind])}updateGroupIds(e){this.dirty=!0,this.model.set("group_ids",e)}static{dt7948.n(this.prototype,"updateGroupIds",[s.action])}updateHideSchema(e){this.hideSchema=e}static{dt7948.n(this.prototype,"updateHideSchema",[s.action])}editName(){this.editingName=!0}static{dt7948.n(this.prototype,"editName",[s.action])}editQuery(){this.editingQuery=!0}static{dt7948.n(this.prototype,"editQuery",[s.action])}download(){window.open(this.model.downloadUrl,"_blank")}static{dt7948.n(this.prototype,"download",[s.action])}goHome(){this.router.transitionTo("adminPlugins.explorer")}static{dt7948.n(this.prototype,"goHome",[s.action])}showHelpModal(){this.modal.show(u.default)}static{dt7948.n(this.prototype,"showHelpModal",[s.action])}resetParams(){this.model.resetParams()}static{dt7948.n(this.prototype,"resetParams",[s.action])}async discard(){try{this.loading=!0
const e=await this.store.find("query",this.model.id)
this.model.setProperties(e.getProperties(c.default.updatePropertyNames)),this.model.group_ids&&Array.isArray(this.model.group_ids)||this.model.set("group_ids",[]),this.dirty=!1}catch(e){(0,a.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"discard",[s.action])}async destroyQuery(){try{this.loading=!0,this.showResults=!1,await this.store.destroyRecord("query",this.model),this.model.set("destroyed",!0)}catch(e){(0,a.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"destroyQuery",[s.action])}async recover(){try{this.loading=!0,this.showResults=!0,await this.model.save(),this.model.set("destroyed",!1)}catch(e){(0,a.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"recover",[s.action])}onRegisterApi(e){this.form=e}static{dt7948.n(this.prototype,"onRegisterApi",[s.action])}setDirty(){this.dirty=!0}static{dt7948.n(this.prototype,"setDirty",[s.action])}exitEdit(){this.editingName=!1}static{dt7948.n(this.prototype,"exitEdit",[s.action])}async run(){let e=null
if(this.model.hasParams){try{e=await(this.form?.submit())}catch(t){if(t instanceof d.ParamValidationError)return}if(null==e)return}this.setProperties({loading:!0,showResults:!1,params:JSON.stringify(e)}),(0,n.ajax)("/admin/plugins/explorer/queries/"+this.model.id+"/run",{type:"POST",data:{params:JSON.stringify(e),explain:this.explain}}).then(e=>{this.results=e,e.success?this.showResults=!0:this.showResults=!1}).catch(e=>{this.showResults=!1,e.jqXHR&&422===e.jqXHR.status&&e.jqXHR.responseJSON?this.results=e.jqXHR.responseJSON:(0,a.popupAjaxError)(e)}).finally(()=>this.loading=!1)}static{dt7948.n(this.prototype,"run",[s.action])}}e.default=p}),define("discourse/plugins/discourse-data-explorer/discourse/controllers/group-reports-index",["exports","@ember/controller"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{}e.default=r}),define("discourse/plugins/discourse-data-explorer/discourse/controllers/group-reports-show",["exports","@glimmer/tracking","@ember/controller","@ember/object","@ember/service","discourse/components/modal/bookmark","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/bookmark-form-data","discourse/lib/decorators","discourse/models/bookmark","discourse/plugins/discourse-data-explorer/discourse/components/param-input-form"],function(e,t,r,s,o,i,n,a,l,u,d,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends r.default{static{dt7948.g(this.prototype,"currentUser",[o.service])}#w=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"modal",[o.service])}#n=void dt7948.i(this,"modal")
static{dt7948.g(this.prototype,"router",[o.service])}#d=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"showResults",[t.tracked],function(){return!1})}#x=void dt7948.i(this,"showResults")
static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#t=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"results",[t.tracked],function(){return this.model.results})}#v=void dt7948.i(this,"results")
static{dt7948.g(this.prototype,"queryGroupBookmark",[t.tracked],function(){return this.queryGroup?.bookmark})}#k=void dt7948.i(this,"queryGroupBookmark")
queryParams=["params"]
form=null
explain=!1
get parsedParams(){return this.params?JSON.parse(this.params):null}get hasParams(){return this.model.param_info.length>0}get bookmarkLabel(){return this.queryGroupBookmark?"bookmarked.edit_bookmark":"bookmarked.title"}get bookmarkIcon(){return this.queryGroupBookmark&&this.queryGroupBookmark.reminder_at?d.WITH_REMINDER_ICON:d.NO_REMINDER_ICON}get bookmarkClassName(){return this.queryGroupBookmark?["query-group-bookmark","bookmarked"].join(" "):"query-group-bookmark"}async run(){try{let e=null
if(this.hasParams&&(e=await this.form.submit(),null==e))return
this.loading=!0,this.showResults=!1
const t=JSON.stringify(e)
this.router.transitionTo({queryParams:{params:e?t:null}})
const r=await(0,n.ajax)(`/g/${this.get("group.name")}/reports/${this.model.id}/run`,{type:"POST",data:{params:t,explain:this.explain}})
if(this.results=r,!r.success)return
this.showResults=!0}catch(e){422===e.jqXHR?.status&&e.jqXHR.responseJSON?this.results=e.jqXHR.responseJSON:e instanceof c.ParamValidationError||(0,a.popupAjaxError)(e)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"run",[u.bind])}toggleBookmark(){const e=this.queryGroupBookmark||this.store.createRecord("bookmark",{bookmarkable_type:"DiscourseDataExplorer::QueryGroup",bookmarkable_id:this.queryGroup.id,user_id:this.currentUser.id})
return this.modal.show(i.default,{model:{bookmark:new l.BookmarkFormData(e),afterSave:e=>{const t=this.store.createRecord("bookmark",e.saveData)
this.queryGroupBookmark=t,this.appEvents.trigger("bookmarks:changed",e.saveData,t.attachedTo())},afterDelete:()=>{this.queryGroupBookmark=null}}})}static{dt7948.n(this.prototype,"toggleBookmark",[s.action])}onRegisterApi(e){this.form=e}static{dt7948.n(this.prototype,"onRegisterApi",[s.action])}}e.default=p}),define("discourse/plugins/discourse-data-explorer/discourse/explorer-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins",path:"/plugins",map(){this.route("explorer",function(){this.route("queries",function(){this.route("details",{path:"/:query_id"})})})}}}),define("discourse/plugins/discourse-data-explorer/discourse/group-reports-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"group",map(){this.route("reports",function(){this.route("show",{path:"/:query_id"})})}}}),define("discourse/plugins/discourse-data-explorer/discourse/initializers/initialize-data-explorer",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"initialize-data-explorer",initialize(e){e.lookup("service:store").addPluralization("query","queries")}}}),define("discourse/plugins/discourse-data-explorer/discourse/lib/themeColor",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){return getComputedStyle(document.body).getPropertyValue(e)}}),define("discourse/plugins/discourse-data-explorer/discourse/models/query",["exports","@ember/object","discourse/lib/get-url","discourse/models/rest"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends s.default{static updatePropertyNames=["name","description","sql","user_id","created_at","group_ids","last_run_at"]
params={}
constructor(){super(...arguments),this.param_info?.resetParams()}get downloadUrl(){return(0,r.default)(`/admin/plugins/explorer/queries/${this.id}.json?export=1`)}get hasParams(){return this.param_info.length&&!this.updating}static{dt7948.n(this.prototype,"hasParams",[(0,t.computed)("param_info","updating")])}beforeUpdate(){this.set("updating",!0)}afterUpdate(){this.set("updating",!1)}resetParams(){const e={},t=this.params
this.param_info.forEach(r=>{const s=r.identifier
t[r.identifier]?e[s]=t[s]:null!==r.default?e[s]=r.default:"boolean"===r.type?e[s]="false":"user_id"===r.type||"user_list"===r.type||"group_list"===r.type?e[s]=null:e[s]=""}),this.params=e}updateProperties(){const e=this.getProperties(o.updatePropertyNames)
return this.destroyed&&(e.id=this.id),e}createProperties(){return this.sql?this.updateProperties():this.getProperties("name")}}e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/routes/admin-plugins-explorer-index",["exports","@ember/service","discourse/lib/ajax","discourse/routes/discourse"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends s.default{static{dt7948.g(this.prototype,"router",[t.service])}#d=void dt7948.i(this,"router")
beforeModel(e){e.to.queryParams.id&&this.router.transitionTo("adminPlugins.explorer.queries.details",e.to.queryParams.id)}model(){if(!this.currentUser.admin)return{model:null,schema:null,disallow:!0,groups:null}
const e=(0,r.ajax)("/admin/plugins/explorer/groups.json"),t=this.store.findAll("query")
return e.then(e=>{let r={}
return e.forEach(e=>{r[e.id]=e.name}),t.then(t=>(t.forEach(e=>{e.set("group_names",(e.group_ids||[]).map(e=>r[e]))}),{model:t,groups:e}))})}setupController(e,t){e.setProperties(t)}}e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/routes/admin-plugins-explorer-queries-details",["exports","discourse/lib/ajax","discourse/routes/discourse"],function(e,t,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends r.default{model(e){if(!this.currentUser.admin)return{model:null,schema:null,disallow:!0,groups:null}
const r=(0,t.ajax)("/admin/plugins/explorer/groups.json"),s=(0,t.ajax)("/admin/plugins/explorer/schema.json",{cache:!0}),o=this.store.find("query",e.query_id)
return r.then(e=>{let t={}
return e.forEach(e=>{t[e.id]=e.name}),s.then(r=>o.then(s=>(s.set("group_names",(s.group_ids||[]).map(e=>t[e])),{model:s,schema:r,groups:e})))})}setupController(e,t){e.setProperties(t)}}e.default=s}),define("discourse/plugins/discourse-data-explorer/discourse/routes/group-reports-index",["exports","@ember/service","discourse/lib/ajax","discourse/routes/discourse"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends s.default{static{dt7948.g(this.prototype,"router",[t.service])}#d=void dt7948.i(this,"router")
model(){const e=this.modelFor("group")
return(0,r.ajax)(`/g/${e.name}/reports`).then(t=>({model:t,group:e})).catch(()=>this.router.transitionTo("group.members",e))}afterModel(e){e.group.get("is_group_user")||this.currentUser&&this.currentUser.admin||this.router.transitionTo("group.members",e.group)}setupController(e,t){e.setProperties(t)}}e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/routes/group-reports-show",["exports","@ember/service","discourse/lib/ajax","discourse/routes/discourse"],function(e,t,r,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends s.default{static{dt7948.g(this.prototype,"router",[t.service])}#d=void dt7948.i(this,"router")
model(e){const t=this.modelFor("group")
return(0,r.ajax)(`/g/${t.name}/reports/${e.query_id}`).then(e=>{const r=e.query,s=e.query_group,o=r.param_info.reduce((e,t)=>(e[t.identifier]=t.default,e),{})
return{model:Object.assign({params:o},r),group:t,queryGroup:s,results:null,showResults:!1}}).catch(()=>{this.router.transitionTo("group.members",t)})}setupController(e,t){e.setProperties(t)}}e.default=o}),define("discourse/plugins/discourse-data-explorer/discourse/templates/admin/plugins-explorer-index",["exports","@ember/helper","@ember/modifier","ember-route-template","truth-helpers","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/pick-files-button","discourse/components/table-header-toggle","discourse/components/text-field","discourse/helpers/bound-date","discourse/helpers/d-icon","discourse-i18n","discourse/plugins/discourse-data-explorer/discourse/components/share-report","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i,n,a,l,u,d,c,p,m,h,f,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,s.default)((0,h.setComponentTemplate)((0,f.createTemplateFactory)({id:"dAsEDNsy",block:'[[[1,"\\n"],[41,[30,1,["disallow"]],[[[1,"      "],[10,"h1"],[12],[1,[28,[32,0],["explorer.admins_only"],null]],[13],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"query-list"],[12],[1,"\\n        "],[8,[32,1],null,[["@value","@placeholderKey","@onChange"],[[30,1,["search"]],"explorer.search_placeholder",[30,1,["updateSearch"]]]],null],[1,"\\n        "],[8,[32,2],[[24,0,"no-text btn-right"]],[["@action","@icon"],[[30,1,["displayCreate"]],"plus"]],null],[1,"\\n        "],[8,[32,3],[[24,0,"import-btn"]],[["@label","@icon","@acceptedFormatsOverride","@showButton","@onFilesPicked"],["explorer.import.label","upload",[30,1,["acceptedImportFileTypes"]],"true",[30,1,["import"]]]],null],[1,"\\n      "],[13],[1,"\\n\\n"],[41,[30,1,["showCreate"]],[[[1,"        "],[10,0],[14,0,"query-create"],[12],[1,"\\n          "],[8,[32,1],null,[["@value","@placeholderKey","@onChange"],[[30,1,["newQueryName"]],"explorer.create_placeholder",[30,1,["updateNewQueryName"]]]],null],[1,"\\n          "],[8,[32,2],null,[["@action","@disabled","@label","@icon"],[[30,1,["create"]],[30,1,["createDisabled"]],"explorer.create","plus"]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["othersDirty"]],[[[1,"        "],[10,0],[14,0,"warning"],[12],[1,"\\n          "],[1,[28,[32,4],["triangle-exclamation"],null]],[1,"\\n          "],[1,[28,[32,0],["explorer.others_dirty"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["model","length"]],[[[1,"        "],[8,[32,5],null,[["@condition"],[[30,1,["loading"]]]],null],[1,"\\n\\n        "],[10,0],[14,0,"container"],[12],[1,"\\n          "],[10,"table"],[14,0,"d-admin-table recent-queries"],[12],[1,"\\n            "],[10,"thead"],[14,0,"heading-container"],[12],[1,"\\n              "],[10,"th"],[14,0,"col heading name"],[12],[1,"\\n                "],[11,0],[24,"role","button"],[24,0,"heading-toggle"],[4,[32,6],["click",[28,[32,7],[[30,1,["updateSortProperty"]],"name"],null]],null],[12],[1,"\\n                  "],[8,[32,8],null,[["@field","@labelKey","@order","@asc","@automatic"],["name","explorer.query_name",[30,1,["order"]],[28,[32,9],[[30,1,["sortDescending"]]],null],"true"]],null],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n              "],[10,"th"],[14,0,"col heading created-by"],[12],[1,"\\n                "],[11,0],[24,"role","button"],[24,0,"heading-toggle"],[4,[32,6],["click",[28,[32,7],[[30,1,["updateSortProperty"]],"username"],null]],null],[12],[1,"\\n                  "],[8,[32,8],null,[["@field","@labelKey","@order","@asc","@automatic"],["username","explorer.query_user",[30,1,["order"]],[28,[32,9],[[30,1,["sortDescending"]]],null],"true"]],null],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n              "],[10,"th"],[14,0,"col heading group-names"],[12],[1,"\\n                "],[10,0],[14,0,"group-names-header"],[12],[1,"\\n                  "],[1,[28,[32,0],["explorer.query_groups"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n              "],[10,"th"],[14,0,"col heading created-at"],[12],[1,"\\n                "],[11,0],[24,"role","button"],[24,0,"heading-toggle"],[4,[32,6],["click",[28,[32,7],[[30,1,["updateSortProperty"]],"last_run_at"],null]],null],[12],[1,"\\n                  "],[8,[32,8],null,[["@field","@labelKey","@order","@asc","@automatic"],["last_run_at","explorer.query_time",[30,1,["order"]],[28,[32,9],[[30,1,["sortDescending"]]],null],"true"]],null],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,"tbody"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1,["filteredContent"]]],null]],null],null,[[[1,"                "],[10,"tr"],[14,0,"d-admin-row__content query-row"],[12],[1,"\\n                  "],[10,"td"],[14,0,"d-admin-row__overview"],[12],[1,"\\n                    "],[11,3],[16,6,[29,["/admin/plugins/explorer/queries/",[30,2,["id"]]]]],[4,[32,6],["click",[30,1,["scrollTop"]]],null],[12],[1,"\\n                      "],[10,"b"],[14,0,"query-name"],[12],[1,[30,2,["name"]]],[13],[1,"\\n                      "],[10,1],[14,0,"query-desc"],[12],[1,[30,2,["description"]]],[13],[1,"\\n                    "],[13],[1,"\\n                  "],[13],[1,"\\n                  "],[10,"td"],[14,0,"d-admin-row__detail query-created-by"],[12],[1,"\\n                    "],[10,0],[14,0,"d-admin-row__mobile-label"],[12],[1,"\\n                      "],[1,[28,[32,0],["explorer.query_user"],null]],[1,"\\n                    "],[13],[1,"\\n"],[41,[30,2,["username"]],[[[1,"                      "],[10,0],[12],[1,"\\n                        "],[10,3],[15,6,[29,["/u/",[30,2,["username"]],"/activity"]]],[12],[1,"\\n                          "],[10,1],[12],[1,[30,2,["username"]]],[13],[1,"\\n                        "],[13],[1,"\\n                      "],[13],[1,"\\n"]],[]],null],[1,"                  "],[13],[1,"\\n                  "],[10,"td"],[14,0,"d-admin-row__detail query-group-names"],[12],[1,"\\n                    "],[10,0],[14,0,"d-admin-row__mobile-label"],[12],[1,"\\n                      "],[1,[28,[32,0],["explorer.query_groups"],null]],[1,"\\n                    "],[13],[1,"\\n                    "],[10,0],[14,0,"group-names"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,2,["group_names"]]],null]],null],null,[[[1,"                        "],[8,[32,10],null,[["@group","@query"],[[30,3],[30,2]]],null],[1,"\\n"]],[3]],null],[1,"                    "],[13],[1,"\\n                  "],[13],[1,"\\n                  "],[10,"td"],[14,0,"d-admin-row__detail query-created-at"],[12],[1,"\\n                    "],[10,0],[14,0,"d-admin-row__mobile-label"],[12],[1,"\\n                      "],[1,[28,[32,0],["explorer.query_time"],null]],[1,"\\n                    "],[13],[1,"\\n"],[41,[30,2,["last_run_at"]],[[[1,"                      "],[10,1],[12],[1,"\\n                        "],[1,[28,[32,11],[[30,2,["last_run_at"]]],null]],[1,"\\n                      "],[13],[1,"\\n"]],[]],[[[41,[30,2,["created_at"]],[[[1,"                      "],[10,1],[12],[1,"\\n                        "],[1,[28,[32,11],[[30,2,["created_at"]]],null]],[1,"\\n                      "],[13],[1,"\\n                    "]],[]],null]],[]]],[1,"                  "],[13],[1,"\\n                "],[13],[1,"\\n"]],[2]],[[[1,"                "],[10,"br"],[12],[13],[1,"\\n                "],[10,"em"],[14,0,"no-search-results"],[12],[1,"\\n                  "],[1,[28,[32,0],["explorer.no_search_results"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"explorer-pad-bottom"],[12],[13],[1,"\\n"]],[]],null]],[]]],[1,"  "]],["@controller","query","group"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/templates/admin/plugins-explorer-index.js",scope:()=>[p.i18n,u.default,n.default,a.default,c.default,i.default,r.on,t.fn,l.default,o.not,m.default,d.default],isStrictMode:!0}),(0,g.default)(void 0,void 0)))}),define("discourse/plugins/discourse-data-explorer/discourse/templates/admin/plugins-explorer-queries-details",["exports","@ember/component","@ember/helper","@ember/modifier","ember-route-template","discourse/components/ace-editor","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/d-textarea","discourse/components/text-field","discourse/helpers/d-icon","discourse/modifiers/draggable","discourse-i18n","select-kit/components/multi-select","discourse/plugins/discourse-data-explorer/discourse/components/code-view","discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema","discourse/plugins/discourse-data-explorer/discourse/components/param-input-form","discourse/plugins/discourse-data-explorer/discourse/components/query-results-wrapper","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i,n,a,l,u,d,c,p,m,h,f,g,y,b,x){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,o.default)((0,t.setComponentTemplate)((0,b.createTemplateFactory)({id:"bSwQgAgW",block:'[[[1,"\\n"],[41,[30,1,["disallow"]],[[[1,"      "],[10,"h1"],[12],[1,[28,[32,0],["explorer.admins_only"],null]],[13],[1,"\\n"]],[]],[[[1,"\\n      "],[10,0],[15,0,[29,["query-edit ",[52,[30,1,["editingName"]],"editing"]]]],[12],[1,"\\n"],[41,[30,1,["editingName"]],[[[1,"          "],[10,0],[14,0,"name"],[12],[1,"\\n            "],[8,[32,1],[[24,0,"previous"]],[["@action","@icon"],[[30,1,["goHome"]],"chevron-left"]],null],[1,"\\n            "],[8,[32,1],[[24,0,"previous"]],[["@action","@icon"],[[30,1,["exitEdit"]],"xmark"]],null],[1,"\\n            "],[10,0],[14,0,"name-text-field"],[12],[1,"\\n              "],[8,[32,2],null,[["@value","@onChange"],[[30,1,["model","name"]],[30,1,["setDirty"]]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"desc"],[12],[1,"\\n            "],[8,[32,3],null,[["@value","@placeholder","@input"],[[30,1,["model","description"]],[28,[32,0],["explorer.description_placeholder"],null],[30,1,["setDirty"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,0],[14,0,"name"],[12],[1,"\\n            "],[8,[32,1],[[24,0,"previous"]],[["@action","@icon"],[[30,1,["goHome"]],"chevron-left"]],null],[1,"\\n\\n            "],[10,"h1"],[12],[1,"\\n              "],[10,1],[12],[1,[30,1,["model","name"]]],[13],[1,"\\n"],[41,[51,[30,1,["editDisabled"]]],[[[1,"                "],[8,[32,1],[[24,0,"edit-query-name btn-transparent"]],[["@action","@icon"],[[30,1,["editName"]],"pencil"]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"desc"],[12],[1,"\\n            "],[1,[30,1,["model","description"]]],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"\\n"],[41,[51,[30,1,["model","destroyed"]]],[[[1,"          "],[10,0],[14,0,"groups"],[12],[1,"\\n            "],[10,1],[14,0,"label"],[12],[1,[28,[32,0],["explorer.allow_groups"],null]],[13],[1,"\\n            "],[10,1],[12],[1,"\\n              "],[8,[32,4],null,[["@value","@content","@options","@onChange"],[[30,1,["model","group_ids"]],[30,1,["groupOptions"]],[28,[32,5],null,[["allowAny"],[false]]],[30,1,["updateGroupIds"]]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[10,0],[14,0,"clear"],[12],[13],[1,"\\n\\n"],[41,[30,1,["editingQuery"]],[[[1,"          "],[10,0],[15,0,[29,["query-editor ",[52,[30,1,["hideSchema"]],"no-schema"]]]],[12],[1,"\\n            "],[10,0],[14,0,"panels-flex"],[12],[1,"\\n              "],[10,0],[14,0,"editor-panel"],[12],[1,"\\n                "],[8,[32,6],[[4,[32,8],["click",[30,1,["setDirty"]]],null]],[["@content","@onChange","@mode","@disabled","@save","@submit"],[[30,1,["model","sql"]],[28,[32,7],[[28,[31,2],[[30,1,["model","sql"]]],null]],null],"sql",[30,1,["model","destroyed"]],[30,1,["save"]],[30,1,["saveAndRun"]]]],null],[1,"\\n              "],[13],[1,"\\n\\n              "],[10,0],[14,0,"right-panel"],[12],[1,"\\n                "],[8,[32,9],null,[["@schema","@hideSchema","@updateHideSchema"],[[30,1,["schema"]],[30,1,["hideSchema"]],[30,1,["updateHideSchema"]]]],null],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n\\n            "],[11,0],[24,0,"grippie"],[4,[32,10],null,[["didStartDrag","didEndDrag","dragMove"],[[30,1,["didStartDrag"]],[30,1,["didEndDrag"]],[30,1,["dragMove"]]]]],[12],[1,"\\n              "],[1,[28,[32,11],["discourse-expand"],null]],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,0],[14,0,"clear"],[12],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,0],[14,0,"sql"],[12],[1,"\\n            "],[8,[32,12],null,[["@value","@codeClass","@setDirty"],[[30,1,["model","sql"]],"sql",[30,1,["setDirty"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"\\n        "],[10,0],[14,0,"clear"],[12],[13],[1,"\\n\\n        "],[10,0],[14,0,"pull-left left-buttons"],[12],[1,"\\n"],[41,[30,1,["editingQuery"]],[[[1,"            "],[8,[32,1],[[24,0,"btn-save-query"]],[["@action","@label","@disabled"],[[30,1,["save"]],"explorer.save",[30,1,["saveDisabled"]]]],null],[1,"\\n"]],[]],[[[41,[51,[30,1,["editDisabled"]]],[[[1,"              "],[8,[32,1],[[24,0,"btn-edit-query"]],[["@action","@label","@icon"],[[30,1,["editQuery"]],"explorer.edit","pencil"]],null],[1,"\\n"]],[]],null]],[]]],[1,"\\n          "],[8,[32,1],null,[["@action","@label","@disabled","@icon"],[[30,1,["download"]],"explorer.export",[30,1,["runDisabled"]],"download"]],null],[1,"\\n\\n"],[41,[30,1,["editingQuery"]],[[[1,"            "],[8,[32,1],null,[["@action","@label","@icon"],[[30,1,["showHelpModal"]],"explorer.help.label","circle-question"]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"pull-right right-buttons"],[12],[1,"\\n"],[41,[30,1,["model","destroyed"]],[[[1,"            "],[8,[32,1],null,[["@action","@icon","@label"],[[30,1,["recover"]],"arrow-rotate-left","explorer.recover"]],null],[1,"\\n"]],[]],[[[41,[30,1,["editingQuery"]],[[[1,"              "],[8,[32,1],null,[["@action","@icon","@label","@disabled"],[[30,1,["discard"]],"arrow-rotate-left","explorer.undo",[30,1,["saveDisabled"]]]],null],[1,"\\n"]],[]],null],[1,"\\n            "],[8,[32,1],[[24,0,"btn-danger"]],[["@action","@icon","@label"],[[30,1,["destroyQuery"]],"trash-can","explorer.delete"]],null],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n        "],[10,0],[14,0,"clear"],[12],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[11,"form"],[24,0,"query-run"],[4,[32,8],["submit",[30,1,["run"]]],null],[12],[1,"\\n"],[41,[30,1,["model","hasParams"]],[[[1,"          "],[8,[32,13],null,[["@initialValues","@paramInfo","@onRegisterApi"],[[30,1,["parsedParams"]],[30,1,["model","param_info"]],[30,1,["onRegisterApi"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["runDisabled"]],[[[41,[30,1,["saveDisabled"]],[[[1,"            "],[8,[32,1],[[24,0,"btn-primary"]],[["@label","@disabled"],["explorer.run","true"]],null],[1,"\\n"]],[]],[[[1,"            "],[8,[32,1],[[24,0,"btn-primary"]],[["@action","@icon","@label"],[[30,1,["saveAndRun"]],"play","explorer.saverun"]],null],[1,"\\n"]],[]]]],[]],[[[1,"          "],[8,[32,1],[[24,0,"btn-primary"]],[["@action","@icon","@label","@disabled","@type"],[[30,1,["run"]],"play","explorer.run",[30,1,["runDisabled"]],"submit"]],null],[1,"\\n"]],[]]],[1,"\\n        "],[10,"label"],[14,0,"query-plan"],[12],[1,"\\n          "],[8,[32,14],[[24,3,"explain"]],[["@type","@checked"],["checkbox",[30,1,["explain"]]]],null],[1,"\\n          "],[1,[28,[32,0],["explorer.explain_label"],null]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[10,"hr"],[12],[13],[1,"\\n\\n      "],[8,[32,15],null,[["@condition"],[[30,1,["loading"]]]],null],[1,"\\n\\n      "],[8,[32,16],null,[["@results","@showResults","@query","@content"],[[30,1,["results"]],[30,1,["showResults"]],[30,1,["model"]],[30,1,["results"]]]],null],[1,"\\n"]],[]]],[1,"  "]],["@controller"],false,["if","unless","mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/templates/admin/plugins-explorer-queries-details.js",scope:()=>[p.i18n,a.default,u.default,l.default,m.default,r.hash,i.default,r.fn,s.on,f.default,c.default,d.default,h.default,g.default,t.Input,n.default,y.default],isStrictMode:!0}),(0,x.default)(void 0,void 0)))}),define("discourse/plugins/discourse-data-explorer/discourse/templates/group-reports-index",["exports","@ember/helper","@ember/routing","ember-route-template","discourse/helpers/bound-date","discourse-i18n","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i,n,a,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,s.default)((0,n.setComponentTemplate)((0,a.createTemplateFactory)({id:"iyJBtnRl",block:'[[[1,"\\n    "],[10,"section"],[14,0,"user-content"],[12],[1,"\\n      "],[10,"table"],[14,0,"group-reports"],[12],[1,"\\n        "],[10,"thead"],[12],[1,"\\n          "],[10,"th"],[12],[1,"\\n            "],[1,[28,[32,0],["explorer.report_name"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,"th"],[12],[1,"\\n            "],[1,[28,[32,0],["explorer.query_description"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,"th"],[12],[1,"\\n            "],[1,[28,[32,0],["explorer.query_time"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n        "],[10,"tbody"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1,["model","queries"]]],null]],null],null,[[[1,"            "],[10,"tr"],[12],[1,"\\n              "],[10,"td"],[12],[1,"\\n                "],[8,[32,1],null,[["@route","@models"],["group.reports.show",[28,[32,2],[[30,1,["group","name"]],[30,2,["id"]]],null]]],[["default"],[[[[1,"\\n                  "],[1,[30,2,["name"]]],[1,"\\n                "]],[]]]]],[1,"\\n              "],[13],[1,"\\n              "],[10,"td"],[12],[1,[30,2,["description"]]],[13],[1,"\\n              "],[10,"td"],[12],[1,"\\n"],[41,[30,2,["last_run_at"]],[[[1,"                  "],[1,[28,[32,3],[[30,2,["last_run_at"]]],null]],[1,"\\n"]],[]],null],[1,"              "],[13],[1,"\\n            "],[13],[1,"\\n"]],[2]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@controller","query"],false,["each","-track-array","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/templates/group-reports-index.js",scope:()=>[i.i18n,r.LinkTo,t.array,o.default],isStrictMode:!0}),(0,l.default)(void 0,void 0)))}),define("discourse/plugins/discourse-data-explorer/discourse/templates/group-reports-show",["exports","@ember/modifier","ember-route-template","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/plugins/discourse-data-explorer/discourse/components/param-input-form","discourse/plugins/discourse-data-explorer/discourse/components/query-result","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,r,s,o,i,n,a,l,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,r.default)((0,a.setComponentTemplate)((0,l.createTemplateFactory)({id:"TeRhYCgT",block:'[[[1,"\\n    "],[10,"section"],[14,0,"user-content"],[12],[1,"\\n      "],[10,"h1"],[12],[1,[30,1,["model","name"]]],[13],[1,"\\n      "],[10,2],[12],[1,[30,1,["model","description"]]],[13],[1,"\\n\\n      "],[11,"form"],[24,0,"query-run"],[4,[32,0],["submit",[30,1,["run"]]],null],[12],[1,"\\n"],[41,[30,1,["hasParams"]],[[[1,"          "],[8,[32,1],null,[["@initialValues","@paramInfo","@onRegisterApi"],[[30,1,["parsedParams"]],[30,1,["model","param_info"]],[30,1,["onRegisterApi"]]]],null],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[32,2],[[24,0,"btn-primary"]],[["@action","@icon","@label","@type"],[[30,1,["run"]],"play","explorer.run","submit"]],null],[1,"\\n\\n        "],[8,[32,2],[[16,0,[30,1,["bookmarkClassName"]]]],[["@action","@label","@icon"],[[30,1,["toggleBookmark"]],[30,1,["bookmarkLabel"]],[30,1,["bookmarkIcon"]]]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,3],null,[["@condition"],[[30,1,["loading"]]]],null],[1,"\\n\\n"],[41,[30,1,["results"]],[[[1,"        "],[10,0],[14,0,"query-results"],[12],[1,"\\n"],[41,[30,1,["showResults"]],[[[1,"            "],[8,[32,4],null,[["@query","@content","@group"],[[30,1,["model"]],[30,1,["results"]],[30,1,["group"]]]],null],[1,"\\n"]],[]],[[[42,[28,[31,2],[[28,[31,2],[[30,1,["results","errors"]]],null]],null],null,[[[1,"              "],[10,"pre"],[14,0,"query-error"],[12],[10,"code"],[12],[1,[30,2]],[13],[13],[1,"\\n"]],[2]],null]],[]]],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@controller","err"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-data-explorer/discourse/templates/group-reports-show.js",scope:()=>[t.on,i.default,o.default,s.default,n.default],isStrictMode:!0}),(0,u.default)(void 0,void 0)))})

//# sourceMappingURL=discourse-data-explorer-33d3ca15.map