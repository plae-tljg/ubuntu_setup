define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter",["exports","discourse/adapters/rest"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{basePath(){return"/discourse-post-event/"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-event",["exports","@ember/string","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{pathFor(e,s,n){const i=this.basePath(e,s,n)+(0,t.underscore)(e.pluralize(this.apiNameFor(s)))
return this.appendQueryParams(i,n)}apiNameFor(){return"event"}}e.default=n}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-invitee",["exports","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{apiNameFor(){return"invitee"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter",["exports","@ember/string","discourse/adapters/rest","discourse/lib/ajax","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends i.default{destroyRecord(e,t,s){return(0,n.ajax)(this.pathFor(e,t,{post_id:s.post_id,id:s.id}),{type:"DELETE"})}update(e,i,o,r){const a={},d=(0,t.underscore)(this.apiNameFor(i))
return a[d]=r,(0,n.ajax)(this.pathFor(e,i,{id:o,post_id:r.post_id}),this.getPayload("PUT",a)).then(function(e){return new s.Result(e[d],e)})}createRecord(e,i,o){const r={},a=(0,t.underscore)(this.apiNameFor(i))
return r[a]=o,(0,n.ajax)(this.pathFor(e,i,o),this.getPayload("POST",r)).then(function(e){return new s.Result(e[a],e)})}pathFor(e,s,n){const i=n.post_id
delete n.post_id
const o=n.id
delete n.id
let r=this.basePath(e,s,{})+"events/"+i+"/"+(0,t.underscore)(e.pluralize(this.apiNameFor()))
return o&&(r+=`/${o}`),this.appendQueryParams(r,n)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-reminder",["exports","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{apiNameFor(){return"reminder"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/admin-calendar-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins",path:"/plugins",map(){this.route("calendar")}}}),define("discourse/plugins/discourse-calendar/discourse/api-initializers/discourse-group-timezones",["exports","discourse/lib/api","discourse/plugins/discourse-calendar/discourse/components/group-timezones","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"YBBOiGJe",block:'[[[1,"\\n  "],[8,[32,0],null,[["@members","@group","@size"],[[30,1,["members"]],[30,1,["group"]],[30,1,["size"]]]],null],[1,"\\n"]],["@data"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/api-initializers/discourse-group-timezones.js",scope:()=>[s.default],isStrictMode:!0}),(0,o.default)(void 0,"discourse-group-timezones:GroupTimezonesShim"))
e.default=(0,t.apiInitializer)(e=>{e.decorateCookedElement((e,t)=>{e.querySelectorAll(".group-timezones").forEach(e=>{const s=t.getModel()
if(!s)return
const n=e.dataset.group
if(!n)throw new Error("Group timezone element is missing 'data-group' attribute")
t.renderGlimmer(e,r,{group:n,members:(s.group_timezones||{})[n]||[],size:e.dataset.size||"medium"})})})})}),define("discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item",["exports","@ember/component","@ember/object","@ember-decorators/component","discourse/components/d-button","discourse/lib/ajax","discourse/lib/ajax-error","@ember/template-factory"],function(e,t,s,n,i,o,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=dt7948.c(class extends t.default{loading=!1
isHolidayDisabled=!1
async disableHoliday(){if(!this.loading){this.set("loading",!0)
try{await(0,o.ajax)({url:"/admin/discourse-calendar/holidays/disable",type:"POST",data:{disabled_holiday:{holiday_name:this.holiday.name,region_code:this.region_code}}}),this.set("isHolidayDisabled",!0)}catch(e){(0,r.popupAjaxError)(e)}finally{this.set("loading",!1)}}}static{dt7948.n(this.prototype,"disableHoliday",[s.action])}async enableHoliday(){if(!this.loading){this.set("loading",!0)
try{await(0,o.ajax)({url:"/admin/discourse-calendar/holidays/enable",type:"DELETE",data:{disabled_holiday:{holiday_name:this.holiday.name,region_code:this.region_code}}}),this.set("isHolidayDisabled",!1)}catch(e){(0,r.popupAjaxError)(e)}finally{this.set("loading",!1)}}}static{dt7948.n(this.prototype,"enableHoliday",[s.action])}static{(0,t.setComponentTemplate)((0,a.createTemplateFactory)({id:"369kJw5X",block:'[[[1,"\\n    "],[10,"td"],[12],[1,[30,0,["holiday","date"]]],[13],[1,"\\n    "],[10,"td"],[12],[1,[30,0,["holiday","name"]]],[13],[1,"\\n    "],[10,"td"],[12],[1,"\\n"],[41,[30,0,["isHolidayDisabled"]],[[[1,"        "],[8,[32,0],null,[["@action","@label"],[[30,0,["enableHoliday"]],"discourse_calendar.enable_holiday"]],null],[1,"\\n"]],[]],[[[1,"        "],[8,[32,0],null,[["@action","@label"],[[30,0,["disableHoliday"]],"discourse_calendar.disable_holiday"]],null],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item.js",scope:()=>[i.default],isStrictMode:!0}),this)}},[(0,n.classNameBindings)("isHolidayDisabled:disabled"),(0,n.tagName)("tr")])
e.default=d}),define("discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list",["exports","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"BI63B/cS",block:'[[[1,"\\n  "],[10,"table"],[14,0,"holidays-list"],[12],[1,"\\n    "],[10,"thead"],[12],[1,"\\n      "],[10,"tr"],[12],[1,"\\n        "],[10,"td"],[12],[1,[28,[32,0],["discourse_calendar.date"],null]],[13],[1,"\\n        "],[10,"td"],[14,"colspan","2"],[12],[1,[28,[32,0],["discourse_calendar.holiday"],null]],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,"tbody"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1]],null]],null],null,[[[1,"        "],[8,[32,1],null,[["@holiday","@isHolidayDisabled","@region_code"],[[30,2],[30,2,["disabled"]],[30,3]]],null],[1,"\\n"]],[2]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["@holidays","holiday","@region_code"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list.js",scope:()=>[t.i18n,s.default],isStrictMode:!0}),(0,o.default)(void 0,"admin-holidays-list:AdminHolidaysList"))
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file",["exports","@ember/component","@ember/object","discourse/components/d-button","@ember/template-factory"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{downloadSampleCsv(){let e="";[["my_awesome_group","going"],["lucy","interested"],["mark","not_going"],["sam","unknown"]].forEach(t=>{e+=t.join(","),e+="\n"})
const t=document.createElement("a")
t.href=`data:text/csv;charset=utf-8,${encodeURI(e)}`,t.target="_blank",t.rel="noopener noreferrer",t.download="bulk-invite-sample.csv",t.click()}static{dt7948.n(this.prototype,"downloadSampleCsv",[s.action])}static{(0,t.setComponentTemplate)((0,i.createTemplateFactory)({id:"LbfjJOB7",block:'[[[1,"\\n    "],[8,[32,0],null,[["@label","@action"],["discourse_post_event.bulk_invite_modal.download_sample_csv",[30,0,["downloadSampleCsv"]]]],null],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file.js",scope:()=>[n.default],isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/csv-uploader",["exports","@glimmer/component","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/service","truth-helpers","discourse/helpers/d-icon","discourse/lib/uppy/uppy-upload","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static{dt7948.g(this.prototype,"dialog",[i.service])}#e=void dt7948.i(this,"dialog")
uppyUpload=new a.default((0,s.getOwner)(this),{type:"csv",id:"discourse-post-event-csv-uploader",autoStartUploads:!1,uploadUrl:this.args.uploadUrl,preventDirectS3Uploads:!0,uppyReady:()=>{this.uppyUpload.uppyWrapper.uppyInstance.on("file-added",()=>{this.dialog.confirm({message:(0,d.i18n)(`${this.args.i18nPrefix}.confirmation_message`),didConfirm:()=>this.uppyUpload.startUpload(),didCancel:()=>this.uppyUpload.reset()})})},uploadDone:()=>{this.dialog.alert((0,d.i18n)(`${this.args.i18nPrefix}.success`))},validateUploadedFilesOptions:{csvOnly:!0}})
get uploadButtonText(){return this.uppyUpload.uploading?(0,d.i18n)("uploading"):(0,d.i18n)(`${this.args.i18nPrefix}.text`)}get uploadButtonDisabled(){return this.uppyUpload.uploading||this.uppyUpload.processing||null}static{(0,l.setComponentTemplate)((0,c.createTemplateFactory)({id:"ZKr+v75I",block:'[[[1,"\\n    "],[10,1],[12],[1,"\\n      "],[10,"label"],[14,0,"btn"],[15,"disabled",[30,0,["uploadButtonDisabled"]]],[12],[1,"\\n        "],[1,[28,[32,0],["upload"],null]],[1," "],[1,[30,0,["uploadButtonText"]]],[1,"\\n        "],[11,"input"],[24,0,"hidden-upload-field"],[16,"disabled",[30,0,["uppyUpload","uploading"]]],[24,"accept",".csv"],[24,4,"file"],[4,[32,1],[[30,0,["uppyUpload","setup"]]],null],[12],[13],[1,"\\n      "],[13],[1,"\\n"],[41,[28,[32,2],[[30,0,["uppyUpload","uploading"]],[30,0,["uppyUpload","processing"]]],null],[[[1,"        "],[10,1],[12],[1,[28,[32,3],["upload_selector.uploading"],null]],[1,"\\n          "],[1,[30,0,["uppyUpload","uploadProgress"]]],[1,"%"],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/csv-uploader.js",scope:()=>[r.default,n.default,o.or,d.i18n],isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/chat-channel",["exports","@ember/routing","truth-helpers","discourse/lib/utilities","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.optionalRequire)("discourse/plugins/chat/discourse/components/channel-title"),d=(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"vCJpxQyW",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,1,["channel"]],[32,1]],null],[[[1,"    "],[10,"section"],[14,0,"event__section event-chat-channel"],[12],[1,"\\n      "],[10,1],[12],[13],[1,"\\n      "],[8,[32,2],null,[["@route","@models"],["chat.channel",[30,1,["channel","routeModels"]]]],[["default"],[[[[1,"\\n        "],[8,[32,1],null,[["@channel"],[[30,1,["channel"]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n"]],[]],null]],["@event"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/chat-channel.js",scope:()=>[s.and,a,t.LinkTo],isStrictMode:!0}),(0,r.default)(void 0,"chat-channel:DiscoursePostEventChatChannel"))
e.default=d}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator",["exports","@glimmer/component","discourse/helpers/avatar","discourse/lib/utilities","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{get username(){return this.args.user.name||(0,n.formatUsername)(this.args.user.username)}static{(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"xp4ZBM+r",block:'[[[1,"\\n    "],[10,1],[14,0,"creators"],[12],[1,"\\n      "],[10,1],[14,0,"created-by"],[12],[1,[28,[32,0],["discourse_post_event.created_by"],null]],[13],[1,"\\n\\n      "],[10,1],[14,0,"event-creator"],[12],[1,"\\n        "],[10,3],[14,0,"topic-invitee-avatar"],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n          "],[1,[28,[32,1],[[30,1]],[["imageSize"],["tiny"]]]],[1,"\\n          "],[10,1],[14,0,"username"],[12],[1,[30,0,["username"]]],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@user"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator.js",scope:()=>[i.i18n,s.default],isStrictMode:!0}),this)}}e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/runloop","@ember/service","@ember/template","discourse/helpers/d-icon","discourse/lib/local-dates","discourse/lib/text","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static{dt7948.g(this.prototype,"siteSettings",[r.service])}#t=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"htmlDates",[s.tracked],function(){return""})}#s=void dt7948.i(this,"htmlDates")
get startsAt(){return moment(this.args.event.startsAt).tz(this.timezone)}get endsAt(){return this.args.event.endsAt&&moment(this.args.event.endsAt).tz(this.timezone)}get timezone(){return this.args.event.timezone||"UTC"}get startsAtFormat(){return this._buildFormat(this.startsAt,{includeYear:!this.isSameYear(this.startsAt),includeTime:this.hasTime(this.startsAt)||this.isSingleDayEvent})}get endsAtFormat(){return this.isSingleDayEvent?"LT":this._buildFormat(this.endsAt,{includeYear:!this.isSameYear(this.endsAt)||!this.isSameYear(this.endsAt,this.startsAt),includeTime:this.hasTime(this.endsAt)})}_buildFormat(e,{includeYear:t,includeTime:s}){const n=["ddd, MMM D"]
t&&n.push("YYYY")
return`"${n.join(", ")}${s?" LT":""}"`}get isSingleDayEvent(){return this.startsAt.isSame(this.endsAt,"day")}get datesBBCode(){const e=[]
return e.push(this.buildDateBBCode({date:this.startsAt,format:this.startsAtFormat,range:!!this.endsAt&&"from"})),this.endsAt&&e.push(this.buildDateBBCode({date:this.endsAt,format:this.endsAtFormat,range:"to"})),e}isSameYear(e,t){return e.isSame(t||moment(),"year")}hasTime(e){return e.hour()||e.minute()}buildDateBBCode({date:e,format:t,range:s}){const n={date:e.format("YYYY-MM-DD"),time:e.format("HH:mm"),format:t,timezone:this.timezone,hideTimezone:this.args.event.showLocalTime}
this.args.event.showLocalTime&&(n.displayedTimezone=this.args.event.timezone),s&&(n.range=s)
return`[${Object.entries(n).map(([e,t])=>`${e}=${t}`).join(" ")}]`}async computeDates(e){if(this.siteSettings.discourse_local_dates_enabled){const t=await(0,c.cook)(this.datesBBCode.join("<span> → </span>"))
this.htmlDates=(0,a.htmlSafe)(t.toString()),(0,o.next)(()=>{this.isDestroying||this.isDestroyed||(0,l.applyLocalDates)(e.querySelectorAll(`[data-post-id="${this.args.event.id}"] .discourse-local-date`),this.siteSettings)})}else{let e=`${this.startsAt.format(this.startsAtFormat)}`
this.endsAt&&(e+=` → ${moment(this.endsAt).format(this.endsAtFormat)}`),this.htmlDates=(0,a.htmlSafe)(e)}}static{dt7948.n(this.prototype,"computeDates",[n.action])}static{(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"M8tS1M4H",block:'[[[1,"\\n    "],[11,"section"],[24,0,"event__section event-dates"],[4,[32,0],[[30,0,["computeDates"]]],null],[12],[1,"\\n      "],[1,[28,[32,1],["clock"],null]],[1,[30,0,["htmlDates"]]],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates.js",scope:()=>[i.default,d.default],isStrictMode:!0}),this)}}e.default=m}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/description",["exports","discourse/components/cook-text","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"L7egA1a3",block:'[[[1,"\\n"],[41,[30,1],[[[1,"    "],[10,"section"],[14,0,"event__section event-description"],[12],[1,"\\n      "],[8,[32,0],null,[["@rawText"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null]],["@description"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/description.js",scope:()=>[t.default],isStrictMode:!0}),(0,i.default)(void 0,"description:DiscoursePostEventDescription"))
e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status",["exports","@glimmer/component","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get eventStatusLabel(){return(0,s.i18n)(`discourse_post_event.models.event.status.${this.args.event.status}.title`)}get eventStatusDescription(){return(0,s.i18n)(`discourse_post_event.models.event.status.${this.args.event.status}.description`)}get statusClass(){return`status ${this.args.event.status}`}static{(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"Mp6je1A1",block:'[[[1,"\\n"],[41,[30,1,["isExpired"]],[[[1,"      "],[10,1],[14,0,"status expired"],[12],[1,"\\n        "],[1,[28,[32,0],["discourse_post_event.models.event.expired"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isClosed"]],[[[1,"      "],[10,1],[14,0,"status closed"],[12],[1,"\\n        "],[1,[28,[32,0],["discourse_post_event.models.event.closed"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[15,0,[30,0,["statusClass"]]],[15,"title",[30,0,["eventStatusDescription"]]],[12],[1,"\\n        "],[1,[30,0,["eventStatusLabel"]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]],[]]],[1,"  "]],["@event"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status.js",scope:()=>[s.i18n],isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index",["exports","@glimmer/component","@ember/service","ember-modifier","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse/helpers/d-icon","discourse/helpers/lazy-hash","discourse/helpers/replace-emoji","discourse/helpers/route-action","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/chat-channel","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/description","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/location","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v,h,f,g,_,b,y,w,A){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const k=(0,y.setComponentTemplate)((0,w.createTemplateFactory)({id:"O0UTLdC7",block:'[[[1,"\\n  "],[10,1],[14,0,"separator"],[12],[1,"·"],[13],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",isStrictMode:!0}),(0,A.default)(void 0,"discourse-post-event:StatusSeparator")),x=(0,y.setComponentTemplate)((0,w.createTemplateFactory)({id:"NByHOHeM",block:'[[[1,"\\n  "],[11,"section"],[24,0,"event__section"],[17,1],[12],[1,"\\n"],[41,[30,2],[[[1,"      "],[1,[28,[32,0],[[30,2]],null]],[1,"\\n"]],[]],null],[1,"\\n    "],[18,3,null],[1,"\\n  "],[13],[1,"\\n"]],["&attrs","@icon","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",scope:()=>[r.default],isStrictMode:!0}),(0,A.default)(void 0,"discourse-post-event:InfoSection"))
class E extends t.default{static{dt7948.g(this.prototype,"currentUser",[s.service])}#n=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"discoursePostEventApi",[s.service])}#i=void dt7948.i(this,"discoursePostEventApi")
static{dt7948.g(this.prototype,"messageBus",[s.service])}#o=void dt7948.i(this,"messageBus")
setupMessageBus=(0,n.modifier)(()=>{const{event:e}=this.args,t=`/discourse-post-event/${e.post.topic.id}`
return this.messageBus.subscribe(t,async t=>{const s=await this.discoursePostEventApi.event(t.id)
e.updateFromEvent(s)}),()=>this.messageBus.unsubscribe(t)})
get localStartsAtTime(){let e=moment(this.args.event.startsAt)
return this.args.event.showLocalTime&&this.args.event.timezone&&(e=e.tz(this.args.event.timezone)),e}get startsAtMonth(){return this.localStartsAtTime.format("MMM")}get startsAtDay(){return this.localStartsAtTime.format("D")}get eventName(){return this.args.event.name||this.args.event.post.topic.title}get isPublicEvent(){return"public"===this.args.event.status}get isStandaloneEvent(){return"standalone"===this.args.event.status}get canActOnEvent(){return this.currentUser&&this.args.event.can_act_on_discourse_post_event}get watchingInviteeStatus(){return this.args.event.watchingInvitee?.status}static{(0,y.setComponentTemplate)((0,w.createTemplateFactory)({id:"BSg0neUQ",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["discourse-post-event",[52,[30,1],"is-loaded","is-loading"]],null]],[12],[1,"\\n      "],[10,0],[14,0,"discourse-post-event-widget"],[12],[1,"\\n"],[41,[30,1],[[[1,"          "],[11,"header"],[24,0,"event-header"],[4,[30,0,["setupMessageBus"]],null,null],[12],[1,"\\n            "],[10,0],[14,0,"event-date"],[12],[1,"\\n              "],[10,0],[14,0,"month"],[12],[1,[30,0,["startsAtMonth"]]],[13],[1,"\\n              "],[10,0],[14,0,"day"],[12],[1,[30,0,["startsAtDay"]]],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,0],[14,0,"event-info"],[12],[1,"\\n              "],[10,1],[14,0,"name"],[12],[1,"\\n                "],[1,[28,[32,1],[[30,0,["eventName"]]],null]],[1,"\\n              "],[13],[1,"\\n              "],[10,0],[14,0,"status-and-creators"],[12],[1,"\\n                "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-and-creators",[28,[32,3],null,[["event","Separator","Status","Creator"],[[30,1],[32,4],[50,[32,5],0,null,[["event"],[[30,1]]]],[50,[32,6],0,null,[["user"],[[30,1,["creator"]]]]]]]]]],[["default"],[[[[1,"\\n                  "],[8,[32,5],null,[["@event"],[[30,1]]],null],[1,"\\n                  "],[8,[32,4],null,null,null],[1,"\\n                  "],[8,[32,6],null,[["@user"],[[30,1,["creator"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n\\n            "],[8,[32,7],null,[["@event","@isStandaloneEvent","@composePrivateMessage"],[[30,1],[30,0,["isStandaloneEvent"]],[28,[32,8],["composePrivateMessage"],null]]],null],[1,"\\n          "],[13],[1,"\\n\\n          "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-info",[28,[32,3],null,[["event","Section","Url","Description","Location","Dates","Invitees","Status","ChatChannel"],[[30,1],[50,[32,9],0,null,[["event"],[[30,1]]]],[50,[32,10],0,null,[["url"],[[30,1,["url"]]]]],[50,[32,11],0,null,[["description"],[[30,1,["description"]]]]],[50,[32,12],0,null,[["location"],[[30,1,["location"]]]]],[50,[32,13],0,null,[["event"],[[30,1]]]],[50,[32,14],0,null,[["event"],[[30,1]]]],[50,[32,15],0,null,[["event"],[[30,1]]]],[50,[32,16],0,null,[["event"],[[30,1]]]]]]]]],[["default"],[[[[1,"\\n            "],[8,[32,13],null,[["@event"],[[30,1]]],null],[1,"\\n            "],[8,[32,12],null,[["@location"],[[30,1,["location"]]]],null],[1,"\\n            "],[8,[32,10],null,[["@url"],[[30,1,["url"]]]],null],[1,"\\n            "],[8,[32,16],null,[["@event"],[[30,1]]],null],[1,"\\n            "],[8,[32,14],null,[["@event"],[[30,1]]],null],[1,"\\n            "],[8,[32,11],null,[["@description"],[[30,1,["description"]]]],null],[1,"\\n"],[41,[30,1,["canUpdateAttendance"]],[[[1,"              "],[8,[32,15],null,[["@event"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@event"],false,["if","component"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",scope:()=>[o.default,d.default,i.default,a.default,k,v.default,u.default,g.default,l.default,x,b.default,m.default,f.default,p.default,h.default,_.default,c.default],isStrictMode:!0}),this)}}e.default=E}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee",["exports","@glimmer/component","@ember/helper","@ember/service","truth-helpers","discourse/components/avatar-flair","discourse/helpers/avatar","discourse/helpers/concat-class","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static{dt7948.g(this.prototype,"site",[n.service])}#r=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"currentUser",[n.service])}#n=void dt7948.i(this,"currentUser")
get statusIcon(){switch(this.args.invitee.status){case"going":return"check"
case"interested":return"star"
case"not_going":return"xmark"}}get flairName(){const e=`discourse_post_event.models.invitee.status.${this.args.invitee.status}`
return(0,d.i18n)(e)}static{(0,l.setComponentTemplate)((0,c.createTemplateFactory)({id:"XZIgZYiv",block:'[[[1,"\\n    "],[10,"li"],[15,0,[28,[32,0],["event-invitee",[52,[30,1,["status"]],[28,[32,1],["status-",[30,1,["status"]]],null]],[52,[28,[32,2],[[30,0,["currentUser","id"]],[30,1,["user","id"]]],null],"is-current-user"]],null]],[12],[1,"\\n      "],[10,3],[14,0,"topic-invitee-avatar"],[15,"data-user-card",[30,1,["user","username"]]],[12],[1,"\\n        "],[1,[28,[32,3],[[30,1,["user"]]],[["imageSize"],[[52,[30,0,["site","mobileView"]],"tiny","large"]]]]],[1,"\\n"],[41,[30,0,["statusIcon"]],[[[1,"          "],[8,[32,4],null,[["@flairName","@flairUrl"],[[30,0,["flairName"]],[30,0,["statusIcon"]]]],null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@invitee"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee.js",scope:()=>[a.default,s.concat,i.eq,r.default,o.default],isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees",["exports","@glimmer/component","discourse/helpers/d-icon","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{get hasAttendees(){return this.args.event.stats.going>0}get statsInfo(){return this.args.event.stats.going}get inviteesTitle(){return(0,n.i18n)("discourse_post_event.models.invitee.status.going_count",{count:this.args.event.stats.going})}static{(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"m+nhmxYx",block:'[[[1,"\\n"],[41,[51,[30,1,["minimal"]]],[[[41,[30,1,["shouldDisplayInvitees"]],[[[1,"        "],[10,"section"],[14,0,"event__section event-invitees"],[12],[1,"\\n          "],[10,0],[14,0,"event-invitees-avatars-container"],[12],[1,"\\n            "],[10,0],[14,0,"event-invitees-icon"],[15,"title",[30,0,["inviteesTitle"]]],[12],[1,"\\n              "],[1,[28,[32,0],["users"],null]],[1,"\\n"],[41,[30,0,["hasAttendees"]],[[[1,"                "],[10,1],[14,0,"going"],[12],[1,[30,0,["statsInfo"]]],[13],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n            "],[10,"ul"],[14,0,"event-invitees-avatars"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,1,["sampleInvitees"]]],null]],null],null,[[[1,"                "],[8,[32,1],null,[["@invitee"],[[30,2]]],null],[1,"\\n"]],[2]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[51,[30,1,["isStandalone"]]],[[[1,"          "],[10,"section"],[14,0,"event__section event-invitees no-rsvp"],[12],[1,"\\n            "],[10,2],[14,0,"no-rsvp-description"],[12],[1,[28,[32,2],["discourse_post_event.models.invitee.status.going_count.other"],[["count"],["0"]]]],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null]],[]]]],[]],null],[1,"  "]],["@event","invitee"],false,["unless","if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees.js",scope:()=>[s.default,i.default,n.i18n],isStrictMode:!0}),this)}}e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/location",["exports","discourse/components/cook-text","discourse/helpers/d-icon","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"jLL283va",block:'[[[1,"\\n"],[41,[30,1],[[[1,"    "],[10,"section"],[14,0,"event__section event-location"],[12],[1,"\\n      "],[1,[28,[32,0],["location-pin"],null]],[1,"\\n\\n      "],[8,[32,1],null,[["@rawText"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null]],["@location"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/location.js",scope:()=>[s.default,t.default],isStrictMode:!0}),(0,o.default)(void 0,"location:DiscoursePostEventLocation"))
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/dropdown-menu","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/download-calendar","discourse/lib/export-csv","discourse/lib/get-url","discourse/lib/text","discourse/lib/transformer","discourse-i18n","float-kit/components/d-menu","discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v,h,f,g,_,b,y,w,A,k){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class x extends t.default{static{dt7948.g(this.prototype,"currentUser",[o.service])}#n=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"dialog",[o.service])}#e=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"modal",[o.service])}#a=void dt7948.i(this,"modal")
static{dt7948.g(this.prototype,"router",[o.service])}#d=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"siteSettings",[o.service])}#t=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"store",[o.service])}#l=void dt7948.i(this,"store")
static{dt7948.g(this.prototype,"isSavingEvent",[s.tracked],function(){return!1})}#c=void dt7948.i(this,"isSavingEvent")
get expiredOrClosed(){return this.args.event.isExpired||this.args.event.isClosed}get canActOnEvent(){return this.currentUser&&this.args.event.canActOnDiscoursePostEvent}get shouldShowParticipants(){return(0,v.applyValueTransformer)("discourse-calendar-event-more-menu-should-show-participants",this.canActOnEvent&&!this.args.isStandaloneEvent,{event:this.args.event})}get canInvite(){return!this.expiredOrClosed&&this.canActOnEvent&&this.args.event.isPublic}get canSeeUpcomingEvents(){return!this.args.event.isClosed&&this.args.event.recurrence}get canBulkInvite(){return!this.expiredOrClosed&&!this.args.event.isStandalone}get canSendPmToCreator(){return this.currentUser&&this.currentUser.username!==this.args.event.creator.username}addToCalendar(){this.menuApi.close()
const e=this.args.event;(0,c.downloadCalendar)(e.name||e.post.topic.title,[{startsAt:e.startsAt,endsAt:e.endsAt}],{recurrenceRule:e.recurrenceRule,location:e.url,details:(0,p.getAbsoluteURL)(e.post.url)})}static{dt7948.n(this.prototype,"addToCalendar",[i.action])}sendPMToCreator(){this.menuApi.close(),this.args.composePrivateMessage(i.default.create(this.args.event.creator),i.default.create(this.args.event.post))}static{dt7948.n(this.prototype,"sendPMToCreator",[i.action])}upcomingEvents(){this.router.transitionTo("discourse-post-event-upcoming-events")}static{dt7948.n(this.prototype,"upcomingEvents",[i.action])}registerMenuApi(e){this.menuApi=e}static{dt7948.n(this.prototype,"registerMenuApi",[i.action])}async inviteUserOrGroup(){this.menuApi.close()
try{this.modal.show(y.default,{model:{event:this.args.event}})}catch(e){(0,l.popupAjaxError)(e)}}static{dt7948.n(this.prototype,"inviteUserOrGroup",[i.action])}exportPostEvent(){this.menuApi.close(),(0,u.exportEntity)("post_event",{name:"post_event",id:this.args.event.id})}static{dt7948.n(this.prototype,"exportPostEvent",[i.action])}bulkInvite(){this.menuApi.close(),this.modal.show(b.default,{model:{event:this.args.event}})}static{dt7948.n(this.prototype,"bulkInvite",[i.action])}async openEvent(){this.menuApi.close(),this.dialog.yesNoConfirm({message:(0,h.i18n)("discourse_post_event.builder_modal.confirm_open"),didConfirm:async()=>{this.isSavingEvent=!0
try{const e=await this.store.find("post",this.args.event.id)
this.args.event.isClosed=!1
const t=(0,g.buildParams)(this.args.event.startsAt,this.args.event.endsAt,this.args.event,this.siteSettings),s=(0,g.replaceRaw)(t,e.raw)
if(s){const t={raw:s,edit_reason:(0,h.i18n)("discourse_post_event.edit_reason_opened")},n=await(0,m.cook)(s)
t.cooked=n.string,await e.save(t)}}catch(e){(0,l.popupAjaxError)(e)}finally{this.isSavingEvent=!1}}})}static{dt7948.n(this.prototype,"openEvent",[i.action])}async editPostEvent(){this.menuApi.close(),this.modal.show(_.default,{model:{event:this.args.event}})}static{dt7948.n(this.prototype,"editPostEvent",[i.action])}showParticipants(){this.menuApi.close(),this.modal.show(w.default,{model:{event:this.args.event,title:this.args.event.title,extraClass:this.args.event.extraClass}})}static{dt7948.n(this.prototype,"showParticipants",[i.action])}async closeEvent(){this.menuApi.close(),this.dialog.yesNoConfirm({message:(0,h.i18n)("discourse_post_event.builder_modal.confirm_close"),didConfirm:()=>(this.isSavingEvent=!0,this.store.find("post",this.args.event.id).then(e=>{this.args.event.isClosed=!0
const t=(0,g.buildParams)(this.args.event.startsAt,this.args.event.endsAt,this.args.event,this.siteSettings),s=(0,g.replaceRaw)(t,e.raw)
if(s){const t={raw:s,edit_reason:(0,h.i18n)("discourse_post_event.edit_reason_closed")}
return(0,m.cook)(s).then(s=>(t.cooked=s.string,e.save(t))).finally(()=>{this.isSavingEvent=!1})}}))})}static{dt7948.n(this.prototype,"closeEvent",[i.action])}static{(0,A.setComponentTemplate)((0,k.createTemplateFactory)({id:"NUPA/5lN",block:'[[[1,"\\n    "],[8,[32,0],null,[["@identifier","@triggerClass","@icon","@onRegisterApi"],["discourse-post-event-more-menu",[28,[32,1],["more-dropdown",[52,[30,0,["isSavingEvent"]],"--saving"]],null],"ellipsis",[30,0,["registerMenuApi"]]]],[["content"],[[[[1,"\\n        "],[8,[32,2],null,null,[["default"],[[[[1,"\\n"],[41,[51,[30,0,["expiredOrClosed"]]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"add-to-calendar"]],null,[["default"],[[[[1,"\\n              "],[8,[32,3],null,[["@icon","@label","@action"],["file","discourse_post_event.add_to_calendar",[30,0,["addToCalendar"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canSendPmToCreator"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"send-pm-to-creator"]],null,[["default"],[[[[1,"\\n              "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["envelope",[28,[32,4],["discourse_post_event.send_pm_to_creator",[28,[32,5],null,[["username"],[[30,2,["creator","username"]]]]]],null],[30,0,["sendPMToCreator"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canInvite"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"invite-user-or-group"]],null,[["default"],[[[[1,"\\n              "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["user-plus",[28,[32,4],["discourse_post_event.invite"],null],[30,0,["inviteUserOrGroup"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canSeeUpcomingEvents"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"upcoming-events"]],null,[["default"],[[[[1,"\\n              "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["far-calendar-plus",[28,[32,4],["discourse_post_event.upcoming_events.title"],null],[30,0,["upcomingEvents"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldShowParticipants"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"show-all-participants"]],null,[["default"],[[[[1,"\\n              "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["user-group","discourse_post_event.show_participants",[30,0,["showParticipants"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n\\n            "],[8,[30,1,["divider"]],null,null,null],[1,"\\n"]],[]],null],[41,[30,0,["canActOnEvent"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"export-event"]],null,[["default"],[[[[1,"\\n              "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["file-csv","discourse_post_event.export_event",[30,0,["exportPostEvent"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["canBulkInvite"]],[[[1,"              "],[8,[30,1,["item"]],[[24,0,"bulk-invite"]],null,[["default"],[[[[1,"\\n                "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["file-arrow-up","discourse_post_event.bulk_invite",[30,0,["bulkInvite"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,2,["isClosed"]],[[[1,"              "],[8,[30,1,["item"]],[[24,0,"open-event"]],null,[["default"],[[[[1,"\\n                "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action","@disabled"],["unlock","discourse_post_event.open_event",[30,0,["openEvent"]],[30,0,["isSavingEvent"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],[[[1,"              "],[8,[30,1,["item"]],[[24,0,"edit-event"]],null,[["default"],[[[[1,"\\n                "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["pencil","discourse_post_event.edit_event",[30,0,["editPostEvent"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n"],[41,[51,[30,2,["isExpired"]]],[[[1,"                "],[8,[30,1,["item"]],[[24,0,"close-event"]],null,[["default"],[[[[1,"\\n                  "],[8,[32,3],[[24,0,"btn-transparent btn-danger"]],[["@icon","@label","@action","@disabled"],["xmark","discourse_post_event.close_event",[30,0,["closeEvent"]],[30,0,["isSavingEvent"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null]],[]]]],[]],null],[1,"        "]],[1]]]]],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["dropdown","@event"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu.js",scope:()=>[f.default,d.default,a.default,r.default,h.i18n,n.hash],isStrictMode:!0}),this)}}e.default=x}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status",["exports","@glimmer/component","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse/helpers/lazy-hash","discourse/lib/ajax-error","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static{dt7948.g(this.prototype,"appEvents",[i.service])}#u=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"discoursePostEventApi",[i.service])}#i=void dt7948.i(this,"discoursePostEventApi")
static{dt7948.g(this.prototype,"siteSettings",[i.service])}#t=void dt7948.i(this,"siteSettings")
get eventButtons(){return this.siteSettings.event_participation_buttons.split("|")}get showGoingButton(){return!!this.eventButtons.find(e=>"going"===e)}get showInterestedButton(){return!!this.eventButtons.find(e=>"interested"===e)}get showNotGoingButton(){return!!this.eventButtons.find(e=>"not going"===e)}get canLeave(){return this.args.event.watchingInvitee&&this.args.event.isPublic}get watchingInviteeStatus(){return this.args.event.watchingInvitee?.status}async leaveEvent(){try{const e=this.args.event.watchingInvitee
await this.discoursePostEventApi.leaveEvent(this.args.event,e),this.appEvents.trigger("calendar:invitee-left-event",{invitee:e,postId:this.args.event.id})}catch(e){(0,l.popupAjaxError)(e)}}static{dt7948.n(this.prototype,"leaveEvent",[n.action])}async updateEventAttendance(e){try{await this.discoursePostEventApi.updateEventAttendance(this.args.event,{status:e}),this.appEvents.trigger("calendar:update-invitee-status",{status:e,postId:this.args.event.id})}catch(t){(0,l.popupAjaxError)(t)}}static{dt7948.n(this.prototype,"updateEventAttendance",[n.action])}async joinEventWithStatus(e){try{await this.discoursePostEventApi.joinEvent(this.args.event,{status:e}),this.appEvents.trigger("calendar:create-invitee-status",{status:e,postId:this.args.event.id})}catch(t){(0,l.popupAjaxError)(t)}}static{dt7948.n(this.prototype,"joinEventWithStatus",[n.action])}async changeWatchingInviteeStatus(e){if(this.args.event.watchingInvitee){const t=this.args.event.watchingInvitee.status
this.canLeave?e===t?await this.leaveEvent():await this.updateEventAttendance(e):(e===t&&(e=null),await this.updateEventAttendance(e))}else await this.joinEventWithStatus(e)}static{dt7948.n(this.prototype,"changeWatchingInviteeStatus",[n.action])}static{(0,c.setComponentTemplate)((0,u.createTemplateFactory)({id:"94m0svTq",block:'[[[1,"\\n    "],[10,"section"],[15,0,[28,[32,0],["event__section event-actions event-status",[52,[30,0,["watchingInviteeStatus"]],[28,[32,1],["status-",[30,0,["watchingInviteeStatus"]]],null]]],null]],[12],[1,"\\n      "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-buttons",[28,[32,3],null,[["event"],[[30,1]]]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["showGoingButton"]],[[[41,[51,[30,1,["minimal"]]],[[[1,"            "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-going-button",[28,[32,3],null,[["event","markAsGoing"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"going"],null]]]]]],[["default"],[[[[1,"\\n              "],[8,[32,5],[[24,0,"going-button"]],[["@icon","@label","@action"],["check","discourse_post_event.models.invitee.status.going",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"going"],null]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null]],[]],null],[1,"\\n"],[41,[30,0,["showInterestedButton"]],[[[1,"          "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-interested-button",[28,[32,3],null,[["event","markAsInterested"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"interested"],null]]]]]],[["default"],[[[[1,"\\n            "],[8,[32,5],[[24,0,"interested-button"]],[["@icon","@label","@action"],["star","discourse_post_event.models.invitee.status.interested",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"interested"],null]]],null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showNotGoingButton"]],[[[41,[51,[30,1,["minimal"]]],[[[1,"            "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-not-going-button",[28,[32,3],null,[["event","markAsNotGoing"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"not_going"],null]]]]]],[["default"],[[[[1,"\\n              "],[8,[32,5],[[24,0,"not-going-button"]],[["@icon","@label","@action"],["xmark","discourse_post_event.models.invitee.status.not_going",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"not_going"],null]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null]],[]],null],[1,"      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["@event"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status.js",scope:()=>[a.default,s.concat,r.default,d.default,s.fn,o.default],isStrictMode:!0}),this)}}e.default=p}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url",["exports","@glimmer/component","discourse/helpers/d-icon","@ember/component","@ember/template-factory"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get url(){return this.args.url.includes("://")||this.args.url.includes("mailto:")?this.args.url:`https://${this.args.url}`}static{(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"F+RqQwEg",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,"section"],[14,0,"event__section event-url"],[12],[1,"\\n        "],[1,[28,[32,0],["link"],null]],[1,"\\n        "],[10,3],[14,0,"url"],[15,6,[30,0,["url"]]],[14,"target","_blank"],[14,"rel","noopener noreferrer"],[12],[1,"\\n          "],[1,[30,1]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@url"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url.js",scope:()=>[s.default],isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/event-date",["exports","@glimmer/component","@ember/service","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{static{dt7948.g(this.prototype,"siteSettings",[s.service])}#t=void dt7948.i(this,"siteSettings")
static{(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"RjIMaT3A",block:'[[[41,[30,0,["shouldRender"]],[[[10,1],[14,0,"header-topic-title-suffix-outlet event-date-container"],[12],[41,[30,0,["siteSettings","use_local_event_date"]],[[[10,1],[14,0,"event-date event-local-date past"],[15,"title",[30,0,["dateRange"]]],[15,"data-starts-at",[30,0,["eventStartedAt"]]],[15,"data-ends-at",[30,0,["eventEndedAt"]]],[12],[1,"\\n            "],[1,[30,0,["localDateContent"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,1],[15,0,[29,["event-date event-relative-date ",[30,0,["relativeDateType"]]]]],[15,"title",[30,0,["dateRange"]]],[15,"data-starts-at",[30,0,["eventStartedAt"]]],[15,"data-ends-at",[30,0,["eventEndedAt"]]],[12],[41,[30,0,["isWithinDateRange"]],[[[10,1],[14,0,"indicator"],[12],[13],[1,"\\n              "],[10,1],[14,0,"text"],[12],[1,[30,0,["timeRemainingContent"]]],[13],[1,"\\n"]],[]],[[[1,"              "],[1,[30,0,["relativeDateContent"]]]],[]]],[13]],[]]],[13]],[]],null]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/event-date.js",isStrictMode:!0}),this)}get shouldRender(){return this.siteSettings.discourse_post_event_enabled&&this.args.topic.event_starts_at}get eventStartedAt(){return this._parsedDate(this.args.topic.event_starts_at)}get eventEndedAt(){return this.args.topic.event_ends_at?this._parsedDate(this.args.topic.event_ends_at):this.eventStartedAt}get dateRange(){return this.args.topic.event_ends_at?`${this._formattedDate(this.eventStartedAt)} → ${this._formattedDate(this.eventEndedAt)}`:this._formattedDate(this.eventStartedAt)}get localDateContent(){return this._formattedDate(this.eventStartedAt)}get relativeDateType(){return this.isWithinDateRange?"current":this.eventStartedAt.isAfter(moment())?"future":"past"}get isWithinDateRange(){return this.eventStartedAt.isBefore(moment())&&this.eventEndedAt.isAfter(moment())}get relativeDateContent(){return{future:this.eventStartedAt.from(moment()),past:this.eventEndedAt.from(moment())}[this.relativeDateType]}get timeRemainingContent(){return(0,n.i18n)("discourse_post_event.topic_title.ends_in_duration",{duration:this.eventEndedAt.from(moment())})}_parsedDate(e){return moment.utc(e).tz(moment.tz.guess())}_guessedDateFormat(){return(0,i.default)(this.eventStartedAt)}_formattedDate(e){return e.format(this._guessedDateFormat())}}e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/event-field",["exports","truth-helpers","discourse-i18n","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"5EUfCPdK",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,1],false],null],[[[1,"    "],[11,0],[24,0,"event-field"],[17,2],[12],[1,"\\n"],[41,[30,3],[[[1,"        "],[10,0],[14,0,"event-field-label"],[12],[1,"\\n          "],[10,1],[14,0,"label"],[12],[1,[28,[32,1],[[30,3]],null]],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"event-field-control"],[12],[1,"\\n        "],[18,4,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null]],["@enabled","&attrs","@label","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/event-field.js",scope:()=>[t.notEq,s.i18n],isStrictMode:!0}),(0,o.default)(void 0,"event-field:EventField"))
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/index",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/service","truth-helpers","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/round-time","discourse/plugins/discourse-calendar/discourse/components/group-timezones/new-day","discourse/plugins/discourse-calendar/discourse/components/group-timezones/time-traveller","discourse/plugins/discourse-calendar/discourse/components/group-timezones/timezone","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static{dt7948.g(this.prototype,"siteSettings",[r.service])}#t=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"filter",[s.tracked],function(){return""})}#p=void dt7948.i(this,"filter")
static{dt7948.g(this.prototype,"localTimeOffset",[s.tracked],function(){return 0})}#m=void dt7948.i(this,"localTimeOffset")
get groupedTimezones(){let e,t=[]
return this.args.members.filterBy("timezone").forEach(e=>{if(this.#v(this.filter,e)){const s=e.timezone,n=parseInt(moment.tz(s).format("YYYYMDHm"),10)
let i=t.findBy("identifier",n)
if(i)i.members.push(e)
else{const o=this.#h(moment.tz(s)),r=this.#f(),a=moment.tz(moment.utc(),s).utcOffset()
i={identifier:n,offset:a,type:"discourse-group-timezone",nowWithOffset:o.add(this.localTimeOffset,"minutes"),closeToWorkingHours:this.#g(o,r),inWorkingHours:this.#_(o,r),utcOffset:this.#b(a),members:[e]},t.push(i)}}}),t=t.sortBy("offset").filter(e=>e.members.length),t.forEach((s,n)=>{n>0&&t[n-1].nowWithOffset.format("dddd")!==s.nowWithOffset.format("dddd")&&(e=n)}),e&&t.splice(e,0,{type:"discourse-group-timezone-new-day",beforeDate:t[e-1].nowWithOffset.format("dddd"),afterDate:t[e].nowWithOffset.format("dddd")}),t}#v(e,t){return!e||(e=e.toLowerCase(),!!(t.username.toLowerCase().indexOf(e)>-1||t.name&&t.name.toLowerCase().indexOf(e)>-1))}#h(e){return this.localTimeOffset&&(e=(0,l.default)(e)),e}#g(e,t){const s=e.hours(),n=this.siteSettings.working_day_start_hour,i=this.siteSettings.working_day_end_hour,o=this.siteSettings.close_to_working_day_hours_extension
return(s>=Math.max(n-o,0)&&s<=n||s<=Math.min(i+o,23)&&s>=i)&&t.includes(e.isoWeekday())}#_(e,t){const s=e.hours()
return s>this.siteSettings.working_day_start_hour&&s<this.siteSettings.working_day_end_hour&&t.includes(e.isoWeekday())}#b(e){const t=1===Math.sign(e)?"+":"-"
e=Math.abs(e)
let s=Math.floor(e/60).toString()
s=1===s.length?`0${s}`:s
let n=(e%60).toString()
return n=1===n.length?`:${n}0`:`:${n}`,`${t}${s.replace(/^0(\d)/,"$1")}${n.replace(/:00$/,"")}`.replace(/-0/," ")}#f(){const e=moment().locale("en")
return this.siteSettings.working_days.split("|").filter(Boolean).map(t=>{return s=t,e.localeData()._weekdays.indexOf(s)||7
var s})}handleFilterChange(e){this.filter=e.target.value}static{dt7948.n(this.prototype,"handleFilterChange",[o.action])}static{(0,m.setComponentTemplate)((0,v.createTemplateFactory)({id:"iRUJBgeZ",block:'[[[1,"\\n    "],[10,0],[14,0,"group-timezones-header"],[12],[1,"\\n      "],[8,[32,0],null,[["@localTimeOffset","@setOffset"],[[30,0,["localTimeOffset"]],[28,[32,1],[[28,[31,0],[[30,0,["localTimeOffset"]]],null]],null]]],null],[1,"\\n      "],[10,1],[14,0,"title"],[12],[1,"\\n        "],[1,[28,[32,2],["group_timezones.group_availability"],[["group"],[[30,1]]]]],[1,"\\n      "],[13],[1,"\\n      "],[11,"input"],[16,"placeholder",[28,[32,2],["group_timezones.search"],null]],[24,0,"group-timezones-filter"],[24,4,"text"],[4,[32,3],["input",[30,0,["handleFilterChange"]]],null],[12],[13],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"group-timezones-body"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["groupedTimezones"]]],null]],null],"identifier",[[[41,[28,[32,4],[[30,2,["type"]],"discourse-group-timezone-new-day"],null],[[[1,"          "],[8,[32,5],null,[["@beforeDate","@afterDate"],[[30,2,["beforeDate"]],[30,2,["afterDate"]]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,6],null,[["@groupedTimezone"],[[30,2]]],null],[1,"\\n"]],[]]]],[2]],null],[1,"    "],[13],[1,"\\n  "]],["@group","groupedTimezone"],false,["mut","each","-track-array","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/index.js",scope:()=>[u.default,n.fn,d.i18n,i.on,a.eq,c.default,p.default],isStrictMode:!0}),this)}}e.default=h}),define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/new-day",["exports","discourse/helpers/d-icon","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"IyAl3Gui",block:'[[[1,"\\n  "],[10,0],[14,0,"group-timezone-new-day"],[12],[1,"\\n    "],[10,1],[14,0,"before"],[12],[1,"\\n      "],[1,[28,[32,0],["chevron-left"],null]],[1,"\\n      "],[1,[30,1]],[1,"\\n    "],[13],[1,"\\n    "],[10,1],[14,0,"after"],[12],[1,"\\n      "],[1,[30,2]],[1,"\\n      "],[1,[28,[32,0],["chevron-right"],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["@beforeDate","@afterDate"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/new-day.js",scope:()=>[t.default],isStrictMode:!0}),(0,i.default)(void 0,"new-day:NewDay"))
e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/time-traveller",["exports","@glimmer/component","@ember/modifier","@ember/object","truth-helpers","discourse/components/d-button","discourse/plugins/discourse-calendar/discourse/lib/round-time","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get localTimeWithOffset(){let e=moment().add(this.args.localTimeOffset,"minutes")
return this.args.localTimeOffset&&(e=(0,r.default)(e)),e.format("HH:mm")}reset(){this.args.setOffset(0)}static{dt7948.n(this.prototype,"reset",[n.action])}sliderMoved(e){const t=15*parseInt(e.target.value,10)
this.args.setOffset(t)}static{dt7948.n(this.prototype,"sliderMoved",[n.action])}static{(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"EWR22AW5",block:'[[[1,"\\n    "],[10,0],[14,0,"group-timezones-time-traveler"],[12],[1,"\\n      "],[10,1],[14,0,"time"],[12],[1,"\\n        "],[1,[30,0,["localTimeWithOffset"]]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,1],[14,0,"discourse-group-timezones-slider-wrapper"],[12],[1,"\\n        "],[11,"input"],[24,0,"group-timezones-slider"],[24,"step","1"],[24,2,"0"],[24,"min","-48"],[24,"max","48"],[24,4,"range"],[4,[32,0],["input",[30,0,["sliderMoved"]]],null],[12],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"group-timezones-reset"],[12],[1,"\\n        "],[8,[32,1],[[16,"disabled",[28,[32,2],[[30,1]],null]]],[["@action","@icon"],[[30,0,["reset"]],"arrow-rotate-left"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@localTimeOffset"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/time-traveller.js",scope:()=>[s.on,o.default,i.not],isStrictMode:!0}),this)}}e.default=l}),define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/timezone",["exports","@glimmer/component","discourse/components/user-avatar","discourse/helpers/concat-class","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{get formattedTime(){return this.args.groupedTimezone.nowWithOffset.format("LT")}static{(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"H/6lvcq+",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["group-timezone",[52,[30,1,["closeToWorkingHours"]],"close-to-working-hours"],[52,[30,1,["inWorkingHours"]],"in-working-hours"]],null]],[12],[1,"\\n      "],[10,0],[14,0,"info"],[12],[1,"\\n        "],[10,1],[14,0,"time"],[12],[1,"\\n          "],[1,[30,0,["formattedTime"]]],[1,"\\n        "],[13],[1,"\\n        "],[10,1],[14,0,"offset"],[14,"title","UTC offset"],[12],[1,"\\n          "],[1,[30,1,["utcOffset"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[10,"ul"],[14,0,"group-timezones-members"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1,["members"]]],null]],null],"username",[[[1,"          "],[10,"li"],[15,0,[28,[32,0],["group-timezones-member",[52,[30,2,["on_holiday"]],"on-holiday","not-on-holiday"]],null]],[12],[1,"\\n            "],[8,[32,1],[[24,0,"group-timezones-member-avatar"]],[["@user","@size"],[[30,2],"small"]],null],[1,"\\n          "],[13],[1,"\\n"]],[2]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@groupedTimezone","member"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/timezone.js",scope:()=>[n.default,s.default],isStrictMode:!0}),this)}}e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","truth-helpers","discourse/components/conditional-loading-section","discourse/components/d-button","discourse/components/d-modal","discourse/components/date-input","discourse/components/date-time-input-range","discourse/components/group-selector","discourse/components/plugin-outlet","discourse/components/radio-button","discourse/helpers/lazy-hash","discourse/lib/ajax-error","discourse/lib/text","discourse/models/group","discourse-i18n","select-kit/components/combo-box","select-kit/components/timezone-input","discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper","discourse/plugins/discourse-calendar/discourse/components/event-field","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v,h,f,g,_,b,y,w,A,k,x,E,M){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class T extends t.default{static{dt7948.g(this.prototype,"dialog",[a.service])}#e=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"siteSettings",[a.service])}#t=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"store",[a.service])}#l=void dt7948.i(this,"store")
static{dt7948.g(this.prototype,"currentUser",[a.service])}#n=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"flash",[s.tracked],function(){return null})}#y=void dt7948.i(this,"flash")
static{dt7948.g(this.prototype,"isSaving",[s.tracked],function(){return!1})}#w=void dt7948.i(this,"isSaving")
static{dt7948.g(this.prototype,"startsAt",[s.tracked],function(){return moment(this.event.startsAt).tz(this.event.timezone||"UTC")})}#A=void dt7948.i(this,"startsAt")
static{dt7948.g(this.prototype,"endsAt",[s.tracked],function(){return this.event.endsAt&&moment(this.event.endsAt).tz(this.event.timezone||"UTC")})}#k=void dt7948.i(this,"endsAt")
get recurrenceUntil(){return this.event.recurrenceUntil&&moment(this.event.recurrenceUntil).tz(this.event.timezone||"UTC")}get event(){return this.args.model.event}get reminderTypes(){return[{value:"notification",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.types.notification")},{value:"bumpTopic",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.types.bump_topic")}]}get reminderUnits(){return[{value:"minutes",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.minutes")},{value:"hours",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.hours")},{value:"days",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.days")},{value:"weeks",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.weeks")}]}get reminderPeriods(){return[{value:"before",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.periods.before")},{value:"after",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.periods.after")}]}get shouldRenderUrl(){return void 0!==this.args.model.event.url}get availableRecurrences(){return[{id:"every_day",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_day")},{id:"every_month",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_month")},{id:"every_weekday",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_weekday")},{id:"every_week",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_week")},{id:"every_two_weeks",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_two_weeks")},{id:"every_four_weeks",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_four_weeks")}]}get allowedCustomFields(){return this.siteSettings.discourse_post_event_allowed_custom_fields.split("|").filter(Boolean)}get addReminderDisabled(){return this.event.reminders?.length>=5}get showChat(){return this.siteSettings.chat_enabled&&(this.currentUser.admin||this.currentUser.moderator)}groupFinder(e){return y.default.findAll({term:e,ignore_automatic:!0})}static{dt7948.n(this.prototype,"groupFinder",[r.action])}setCustomField(e,t){this.event.customFields[e]=t.target.value}static{dt7948.n(this.prototype,"setCustomField",[r.action])}onChangeDates(e){this.event.startsAt=e.from,this.event.endsAt=e.to,this.startsAt=e.from,this.endsAt=e.to}static{dt7948.n(this.prototype,"onChangeDates",[r.action])}onChangeStatus(e){this.event.rawInvitees=[],this.event.status=e}static{dt7948.n(this.prototype,"onChangeStatus",[r.action])}setRecurrence(e){if(!e)return this.event.recurrence=null,void(this.event.recurrenceUntil=null)
this.event.recurrence=e}static{dt7948.n(this.prototype,"setRecurrence",[r.action])}setRecurrenceUntil(e){this.event.recurrenceUntil=e?moment(e).endOf("day").toDate():null}static{dt7948.n(this.prototype,"setRecurrenceUntil",[r.action])}setRawInvitees(e,t){this.event.rawInvitees=t}static{dt7948.n(this.prototype,"setRawInvitees",[r.action])}setNewTimezone(e){this.event.timezone=e,this.event.startsAt=moment.tz(this.startsAt.format("YYYY-MM-DDTHH:mm"),e),this.event.endsAt=this.endsAt?moment.tz(this.endsAt.format("YYYY-MM-DDTHH:mm"),e):null,this.startsAt=moment(this.event.startsAt).tz(e),this.endsAt=this.event.endsAt?moment(this.event.endsAt).tz(e):null}static{dt7948.n(this.prototype,"setNewTimezone",[r.action])}async destroyPostEvent(){try{if(await this.dialog.yesNoConfirm({message:"Confirm delete"})){const e=await this.store.find("post",this.event.id),t=e.raw,s=this._removeRawEvent(t),n={raw:s,edit_reason:"Destroy event"},i=await(0,b.cook)(s)
n.cooked=i.string
await e.save(n)&&this.args.closeModal()}}catch(e){this.flash=(0,_.extractError)(e)}}static{dt7948.n(this.prototype,"destroyPostEvent",[r.action])}createEvent(){if(!this.startsAt)return void this.args.closeModal()
const e=(0,x.buildParams)(this.startsAt,this.endsAt,this.event,this.siteSettings),t=e.description?`${e.description}\n`:""
delete e.description
const s=[]
Object.keys(e).forEach(t=>{let n=e[t]
s.push(`${t}="${n}"`)}),this.args.model.toolbarEvent.addText(`[event ${s.join(" ")}]\n${t}[/event]`),this.args.closeModal()}static{dt7948.n(this.prototype,"createEvent",[r.action])}async updateEvent(){try{this.isSaving=!0
const e=await this.store.find("post",this.event.id),t=e.raw,s=(0,x.buildParams)(this.startsAt,this.endsAt,this.event,this.siteSettings),n=(0,x.replaceRaw)(s,t)
if(n){const t={raw:n,edit_reason:(0,w.i18n)("discourse_post_event.edit_reason")},s=await(0,b.cook)(n)
t.cooked=s.string
await e.save(t)&&this.args.closeModal()}}catch(e){this.flash=(0,_.extractError)(e)}finally{this.isSaving=!1}}static{dt7948.n(this.prototype,"updateEvent",[r.action])}_removeRawEvent(e){const t=new RegExp("\\[event\\s(.*?)\\]\\n\\[\\/event\\]","m")
return e.replace(t,"")}static{(0,n.setComponentTemplate)((0,M.createTemplateFactory)({id:"4aB2iqTR",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"post-event-builder-modal"]],[["@title","@closeModal","@flash"],[[28,[32,1],[[28,[32,2],["discourse_post_event.builder_modal.",[52,[30,1,["event","id"]],"update_event_title","create_event_title"]],null]],null],[30,2],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n        "],[8,[32,3],null,[["@isLoading"],[[30,0,["isSaving"]]]],[["default"],[[[[1,"\\n          "],[10,"form"],[12],[1,"\\n            "],[8,[32,4],null,[["@name","@outletArgs","@connectorTagName"],["post-event-builder-form",[28,[32,5],null,[["event"],[[30,1,["event"]]]]],"div"]],[["default"],[[[[1,"\\n              "],[8,[32,6],null,null,[["default"],[[[[1,"\\n                "],[8,[32,7],null,[["@from","@to","@timezone","@onChange"],[[30,0,["startsAt"]],[30,0,["endsAt"]],[30,1,["event","timezone"]],[30,0,["onChangeDates"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],[[24,0,"name"]],[["@label"],["discourse_post_event.builder_modal.name.label"]],[["default"],[[[[1,"\\n                "],[8,[32,8],[[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.name.placeholder"],null]]],[["@value"],[[30,1,["event","name"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],[[24,0,"location"]],[["@label"],["discourse_post_event.builder_modal.location.label"]],[["default"],[[[[1,"\\n                "],[8,[32,8],[[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.location.placeholder"],null]]],[["@value"],[[30,1,["event","location"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderUrl"]],[[[1,"                "],[8,[32,6],[[24,0,"url"]],[["@label"],["discourse_post_event.builder_modal.url.label"]],[["default"],[[[[1,"\\n                  "],[8,[32,8],[[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.url.placeholder"],null]]],[["@value"],[[30,1,["event","url"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n              "],[8,[32,6],[[24,0,"description"]],[["@label"],["discourse_post_event.builder_modal.description.label"]],[["default"],[[[[1,"\\n                "],[8,[32,9],[[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.description.placeholder"],null]]],[["@value"],[[30,1,["event","description"]]]],null],[1,"              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],[[24,0,"timezone"]],[["@label"],["discourse_post_event.builder_modal.timezone.label"]],[["default"],[[[[1,"\\n                "],[8,[32,10],null,[["@value","@onChange","@none"],[[30,1,["event","timezone"]],[30,0,["setNewTimezone"]],"discourse_post_event.builder_modal.timezone.remove_timezone"]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],[[24,0,"show-local-time"]],[["@label"],["discourse_post_event.builder_modal.show_local_time.label"]],[["default"],[[[[1,"\\n                "],[10,"label"],[14,0,"checkbox-label"],[12],[1,"\\n                  "],[8,[32,8],null,[["@type","@checked"],["checkbox",[30,1,["event","showLocalTime"]]]],null],[1,"\\n                  "],[10,1],[14,0,"message"],[12],[1,"\\n                    "],[1,[28,[32,1],["discourse_post_event.builder_modal.show_local_time.description"],[["timezone"],[[30,1,["event","timezone"]]]]]],[1,"\\n                  "],[13],[1,"\\n                "],[13],[1,"\\n              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],null,[["@label"],["discourse_post_event.builder_modal.status.label"]],[["default"],[[[[1,"\\n                "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n                  "],[8,[32,11],null,[["@name","@value","@selection","@onChange"],["status","public",[30,1,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n                  "],[10,1],[14,0,"message"],[12],[1,"\\n                    "],[10,1],[14,0,"title"],[12],[1,"\\n                      "],[1,[28,[32,1],["discourse_post_event.models.event.status.public.title"],null]],[1,"\\n                    "],[13],[1,"\\n                    "],[10,1],[14,0,"description"],[12],[1,"\\n                      "],[1,[28,[32,1],["discourse_post_event.models.event.status.public.description"],null]],[1,"\\n                    "],[13],[1,"\\n                  "],[13],[1,"\\n                "],[13],[1,"\\n                "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n                  "],[8,[32,11],null,[["@name","@value","@selection","@onChange"],["status","private",[30,1,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n                  "],[10,1],[14,0,"message"],[12],[1,"\\n                    "],[10,1],[14,0,"title"],[12],[1,"\\n                      "],[1,[28,[32,1],["discourse_post_event.models.event.status.private.title"],null]],[1,"\\n                    "],[13],[1,"\\n                    "],[10,1],[14,0,"description"],[12],[1,"\\n                      "],[1,[28,[32,1],["discourse_post_event.models.event.status.private.description"],null]],[1,"\\n                    "],[13],[1,"\\n                  "],[13],[1,"\\n                "],[13],[1,"\\n                "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n                  "],[8,[32,11],null,[["@name","@value","@selection","@onChange"],["status","standalone",[30,1,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n                  "],[10,1],[14,0,"message"],[12],[1,"\\n                    "],[10,1],[14,0,"title"],[12],[1,"\\n                      "],[1,[28,[32,1],["discourse_post_event.models.event.status.standalone.title"],null]],[1,"\\n                    "],[13],[1,"\\n                    "],[10,1],[14,0,"description"],[12],[1,"\\n                      "],[1,[28,[32,1],["discourse_post_event.models.event.status.standalone.description"],null]],[1,"\\n                    "],[13],[1,"\\n                  "],[13],[1,"\\n                "],[13],[1,"\\n              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],null,[["@enabled","@label"],[[28,[32,12],[[30,1,["event","status"]],"private"],null],"discourse_post_event.builder_modal.invitees.label"]],[["default"],[[[[1,"\\n                "],[8,[32,13],null,[["@fullWidthWrap","@groupFinder","@groupNames","@onChangeCallback","@placeholderKey"],[true,[30,0,["groupFinder"]],[30,1,["event","rawInvitees"]],[30,0,["setRawInvitees"]],"topic.invite_private.group_name"]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],[[24,0,"reminders"]],[["@label"],["discourse_post_event.builder_modal.reminders.label"]],[["default"],[[[[1,"\\n                "],[10,0],[14,0,"reminders-list"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1,["event","reminders"]]],null]],null],null,[[[1,"                    "],[10,0],[14,0,"reminder-item"],[12],[1,"\\n                      "],[8,[32,14],[[24,0,"reminder-type"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["type"]],"name","value",[30,0,["reminderTypes"]]]],null],[1,"\\n\\n                      "],[8,[32,8],[[24,"min","0"],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.name.placeholder"],null]],[24,0,"reminder-value"]],[["@value"],[[30,3,["value"]]]],null],[1,"\\n\\n                      "],[8,[32,14],[[24,0,"reminder-unit"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["unit"]],"name","value",[30,0,["reminderUnits"]]]],null],[1,"\\n\\n                      "],[8,[32,14],[[24,0,"reminder-period"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["period"]],"name","value",[30,0,["reminderPeriods"]]]],null],[1,"\\n\\n                      "],[8,[32,15],[[24,0,"remove-reminder"]],[["@action","@icon"],[[28,[32,16],[[30,1,["event","removeReminder"]],[30,3]],null],"xmark"]],null],[1,"\\n\\n                    "],[13],[1,"\\n"]],[3]],null],[1,"                "],[13],[1,"\\n\\n                "],[8,[32,15],[[24,0,"add-reminder"]],[["@disabled","@icon","@label","@action"],[[30,0,["addReminderDisabled"]],"plus","discourse_post_event.builder_modal.add_reminder",[30,1,["event","addReminder"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n              "],[8,[32,6],[[24,0,"recurrence"]],[["@label"],["discourse_post_event.builder_modal.recurrence.label"]],[["default"],[[[[1,"\\n                "],[8,[32,14],[[24,0,"available-recurrences"]],[["@value","@content","@onChange","@options"],[[30,1,["event","recurrence"]],[30,0,["availableRecurrences"]],[30,0,["setRecurrence"]],[28,[32,5],null,[["none"],["discourse_post_event.builder_modal.recurrence.none"]]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n"],[41,[30,1,["event","recurrence"]],[[[1,"                "],[8,[32,6],[[24,0,"recurrence-until"]],[["@label"],["discourse_post_event.builder_modal.recurrence_until.label"]],[["default"],[[[[1,"\\n                  "],[8,[32,17],null,[["@date","@onChange","@timezone"],[[30,0,["recurrenceUntil"]],[30,0,["setRecurrenceUntil"]],[30,1,["event","timezone"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n              "],[8,[32,6],[[24,0,"minimal-event"]],[["@label"],["discourse_post_event.builder_modal.minimal.label"]],[["default"],[[[[1,"\\n                "],[10,"label"],[14,0,"checkbox-label"],[12],[1,"\\n                  "],[8,[32,8],null,[["@type","@checked"],["checkbox",[30,1,["event","minimal"]]]],null],[1,"\\n                  "],[10,1],[14,0,"message"],[12],[1,"\\n                    "],[1,[28,[32,1],["discourse_post_event.builder_modal.minimal.checkbox_label"],null]],[1,"\\n                  "],[13],[1,"\\n                "],[13],[1,"\\n              "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["showChat"]],[[[1,"                "],[8,[32,6],[[24,0,"allow-chat"]],[["@label"],["discourse_post_event.builder_modal.allow_chat.label"]],[["default"],[[[[1,"\\n                  "],[10,"label"],[14,0,"checkbox-label"],[12],[1,"\\n                    "],[8,[32,8],null,[["@type","@checked"],["checkbox",[30,1,["event","chatEnabled"]]]],null],[1,"\\n                    "],[10,1],[14,0,"message"],[12],[1,"\\n                      "],[1,[28,[32,1],["discourse_post_event.builder_modal.allow_chat.checkbox_label"],null]],[1,"\\n                    "],[13],[1,"\\n                  "],[13],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["allowedCustomFields","length"]],[[[1,"                "],[8,[32,6],null,[["@label"],["discourse_post_event.builder_modal.custom_fields.label"]],[["default"],[[[[1,"\\n                  "],[10,2],[14,0,"event-field-description"],[12],[1,"\\n                    "],[1,[28,[32,1],["discourse_post_event.builder_modal.custom_fields.description"],null]],[1,"\\n                  "],[13],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["allowedCustomFields"]]],null]],null],null,[[[1,"                    "],[10,1],[14,0,"label custom-field-label"],[12],[1,"\\n                      "],[1,[30,4]],[1,"\\n                    "],[13],[1,"\\n                    "],[8,[32,8],[[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.custom_fields.placeholder"],null]],[24,0,"custom-field-input"],[4,[32,19],["input",[28,[32,16],[[30,0,["setCustomField"]],[30,4]],null]],null]],[["@value"],[[28,[31,3],[[28,[32,18],[[30,1,["event","customFields"]],[30,4]],null]],null]]],null],[1,"\\n"]],[4]],null],[1,"                "]],[]]]]],[1,"\\n"]],[]],null],[1,"            "]],[]]]]],[1,"\\n          "],[13],[1,"\\n        "]],[]]]]],[1,"\\n      "]],[]],[[[1,"\\n"],[41,[30,1,["event","id"]],[[[1,"          "],[8,[32,15],[[24,0,"btn-primary"]],[["@label","@icon","@action"],["discourse_post_event.builder_modal.update","calendar-day",[30,0,["updateEvent"]]]],null],[1,"\\n\\n          "],[8,[32,15],[[24,0,"btn-danger"]],[["@icon","@action"],["trash-can",[30,0,["destroyPostEvent"]]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,15],[[24,0,"btn-primary"]],[["@label","@icon","@action"],["discourse_post_event.builder_modal.create","calendar-day",[30,0,["createEvent"]]]],null],[1,"\\n"]],[]]],[1,"      "]],[]]]]],[1,"\\n  "]],["@model","@closeModal","reminder","allowedCustomField"],false,["if","each","-track-array","readonly"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder.js",scope:()=>[u.default,w.i18n,i.concat,l.default,h.default,g.default,E.default,m.default,n.Input,n.Textarea,k.default,f.default,d.eq,v.default,A.default,c.default,i.fn,p.default,i.get,o.on],isStrictMode:!0}),this)}}e.default=T})
define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/service","@ember/utils","@ember-compat/tracked-built-ins","discourse/components/d-button","discourse/components/d-modal","discourse/components/group-selector","discourse/lib/ajax","discourse/lib/ajax-error","discourse/models/group","discourse-i18n","select-kit/components/combo-box","select-kit/components/email-group-user-chooser","discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file","discourse/plugins/discourse-calendar/discourse/components/csv-uploader","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v,h,f,g,_,b,y){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class w extends t.default{static{dt7948.g(this.prototype,"dialog",[o.service])}#e=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"bulkInvites",[s.tracked],function(){return new a.TrackedArray([i.default.create({identifier:null,attendance:"unknown"})])})}#x=void dt7948.i(this,"bulkInvites")
static{dt7948.g(this.prototype,"bulkInviteDisabled",[s.tracked],function(){return!0})}#E=void dt7948.i(this,"bulkInviteDisabled")
static{dt7948.g(this.prototype,"flash",[s.tracked],function(){return null})}#y=void dt7948.i(this,"flash")
get bulkInviteStatuses(){return[{label:(0,v.i18n)("discourse_post_event.models.invitee.status.unknown"),name:"unknown"},{label:(0,v.i18n)("discourse_post_event.models.invitee.status.going"),name:"going"},{label:(0,v.i18n)("discourse_post_event.models.invitee.status.not_going"),name:"not_going"},{label:(0,v.i18n)("discourse_post_event.models.invitee.status.interested"),name:"interested"}]}groupFinder(e){return m.default.findAll({term:e,ignore_automatic:!0})}static{dt7948.n(this.prototype,"groupFinder",[i.action])}setBulkInviteDisabled(){this.bulkInviteDisabled=0===this.bulkInvites.filter(e=>(0,r.isPresent)(e.identifier)).length}static{dt7948.n(this.prototype,"setBulkInviteDisabled",[i.action])}async sendBulkInvites(){try{(await(0,u.ajax)(`/discourse-post-event/events/${this.args.model.event.id}/bulk-invite.json`,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({invitees:this.bulkInvites.filter(e=>(0,r.isPresent)(e.identifier))})})).success&&this.args.closeModal()}catch(e){this.flash=(0,p.extractError)(e)}}static{dt7948.n(this.prototype,"sendBulkInvites",[i.action])}removeBulkInvite(e){this.bulkInvites.removeObject(e),this.bulkInvites.length||this.bulkInvites.pushObject(i.default.create({identifier:null,attendance:"unknown"}))}static{dt7948.n(this.prototype,"removeBulkInvite",[i.action])}addBulkInvite(){const e=this.bulkInvites[this.bulkInvites.length-1]?.attendance||"unknown"
this.bulkInvites.pushObject(i.default.create({identifier:null,attendance:e}))}static{dt7948.n(this.prototype,"addBulkInvite",[i.action])}async uploadDone(){await this.dialog.alert((0,v.i18n)("discourse_post_event.bulk_invite_modal.success")),this.args.closeModal()}static{dt7948.n(this.prototype,"uploadDone",[i.action])}updateInviteIdentifier(e,t){e.set("identifier",t[0]),this.setBulkInviteDisabled()}static{dt7948.n(this.prototype,"updateInviteIdentifier",[i.action])}updateBulkGroupInviteIdentifier(e,t,s){e.set("identifier",s[0]),this.setBulkInviteDisabled()}static{dt7948.n(this.prototype,"updateBulkGroupInviteIdentifier",[i.action])}static{(0,b.setComponentTemplate)((0,y.createTemplateFactory)({id:"3RBRz8h5",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"post-event-bulk-invite"]],[["@closeModal","@title","@flash"],[[30,1],[28,[32,1],["discourse_post_event.bulk_invite_modal.title"],null],[30,0,["flash"]]]],[["body"],[[[[1,"\\n        "],[10,0],[14,0,"bulk-invites"],[12],[1,"\\n          "],[10,2],[14,0,"bulk-event-help"],[12],[1,"\\n            "],[1,[28,[32,1],[[28,[32,2],["discourse_post_event.bulk_invite_modal.description_",[30,2,["event","status"]]],null]],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,"h3"],[12],[1,[28,[32,1],["discourse_post_event.bulk_invite_modal.inline_title"],null]],[13],[1,"\\n\\n          "],[10,0],[14,0,"bulk-invite-rows"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["bulkInvites"]]],null]],null],null,[[[1,"              "],[10,0],[14,0,"bulk-invite-row"],[12],[1,"\\n"],[41,[30,2,["event","isPrivate"]],[[[1,"                  "],[8,[32,3],[[24,0,"bulk-invite-identifier"]],[["@single","@groupFinder","@groupNames","@placeholderKey","@onChangeCallback"],[true,[30,0,["groupFinder"]],[30,3,["identifier"]],"discourse_post_event.bulk_invite_modal.group_selector_placeholder",[28,[32,4],[[30,0,["updateBulkGroupInviteIdentifier"]],[30,3]],null]]],null],[1,"\\n"]],[]],null],[41,[30,2,["event","isPublic"]],[[[1,"                  "],[8,[32,5],[[24,0,"bulk-invite-identifier"]],[["@value","@onChange","@options"],[[30,3,["identifier"]],[28,[32,4],[[30,0,["updateInviteIdentifier"]],[30,3]],null],[28,[32,6],null,[["maximum","filterPlaceholder"],[1,"discourse_post_event.bulk_invite_modal.user_selector_placeholder"]]]]],null],[1,"\\n"]],[]],null],[1,"\\n                "],[8,[32,7],[[24,0,"bulk-invite-attendance"]],[["@value","@content","@nameProperty","@valueProperty","@onChange"],[[30,3,["attendance"]],[30,0,["bulkInviteStatuses"]],"name","name",[28,[32,4],[[28,[31,3],[[30,3,["attendance"]]],null]],null]]],null],[1,"\\n\\n                "],[8,[32,8],[[24,0,"remove-bulk-invite"]],[["@icon","@action"],["trash-can",[28,[32,4],[[30,0,["removeBulkInvite"]],[30,3]],null]]],null],[1,"\\n              "],[13],[1,"\\n"]],[3]],null],[1,"          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"bulk-invite-actions"],[12],[1,"\\n            "],[8,[32,8],[[24,0,"send-bulk-invites btn-primary"]],[["@label","@action","@disabled"],["discourse_post_event.bulk_invite_modal.send_bulk_invites",[30,0,["sendBulkInvites"]],[30,0,["bulkInviteDisabled"]]]],null],[1,"\\n            "],[8,[32,8],[[24,0,"add-bulk-invite"]],[["@icon","@action"],["plus",[30,0,["addBulkInvite"]]]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"csv-bulk-invites"],[12],[1,"\\n          "],[10,"h3"],[12],[1,[28,[32,1],["discourse_post_event.bulk_invite_modal.csv_title"],null]],[13],[1,"\\n\\n          "],[10,0],[14,0,"bulk-invite-actions"],[12],[1,"\\n            "],[8,[32,9],null,null,null],[1,"\\n\\n            "],[8,[32,10],null,[["@uploadUrl","@i18nPrefix","@uploadDone"],[[28,[32,2],["/discourse-post-event/events/",[30,2,["event","id"]],"/csv-bulk-invite"],null],"discourse_post_event.bulk_invite_modal",[30,0,["uploadDone"]]]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@model","bulkInvite"],false,["each","-track-array","if","mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite.js",scope:()=>[l.default,v.i18n,n.concat,c.default,n.fn,f.default,n.hash,h.default,d.default,g.default,_.default],isStrictMode:!0}),this)}}e.default=w}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax","discourse/lib/ajax-error","discourse-i18n","select-kit/components/email-group-user-chooser","discourse/plugins/discourse-calendar/discourse/components/event-field","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class v extends t.default{static{dt7948.g(this.prototype,"invitedNames",[s.tracked],function(){return[]})}#M=void dt7948.i(this,"invitedNames")
static{dt7948.g(this.prototype,"flash",[s.tracked],function(){return null})}#y=void dt7948.i(this,"flash")
async invite(){try{await(0,a.ajax)(`/discourse-post-event/events/${this.args.model.event.id}/invite.json`,{data:{invites:this.invitedNames},type:"POST"}),this.args.closeModal()}catch(e){this.flash=(0,d.extractError)(e)}}static{dt7948.n(this.prototype,"invite",[i.action])}static{(0,p.setComponentTemplate)((0,m.createTemplateFactory)({id:"6lj55w5y",block:'[[[1,"\\n    "],[8,[32,0],null,[["@title","@closeModal","@flash"],[[28,[32,1],["discourse_post_event.invite_user_or_group.title"],null],[30,1],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n        "],[10,"form"],[12],[1,"\\n          "],[8,[32,2],null,null,[["default"],[[[[1,"\\n            "],[8,[32,3],null,[["@value","@options"],[[30,0,["invitedNames"]],[28,[32,4],null,[["fullWidthWrap","includeMessageableGroups","filterPlaceholder","excludeCurrentUser"],[true,true,"composer.users_placeholder",true]]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,5],[[24,0,"btn-primary"]],[["@type","@label","@action"],["button","discourse_post_event.invite_user_or_group.invite",[30,0,["invite"]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group.js",scope:()=>[r.default,l.i18n,u.default,c.default,n.hash,o.default],isStrictMode:!0}),this)}}e.default=v}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/index",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/service","truth-helpers","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/d-modal","discourse/helpers/concat-class","discourse/lib/decorators","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/toggle-invitees","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v,h,f,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class _ extends t.default{static{dt7948.g(this.prototype,"discoursePostEventApi",[r.service])}#i=void dt7948.i(this,"discoursePostEventApi")
static{dt7948.g(this.prototype,"filter",[s.tracked])}#p=void dt7948.i(this,"filter")
static{dt7948.g(this.prototype,"isLoading",[s.tracked],function(){return!1})}#T=void dt7948.i(this,"isLoading")
static{dt7948.g(this.prototype,"type",[s.tracked],function(){return"going"})}#S=void dt7948.i(this,"type")
static{dt7948.g(this.prototype,"inviteesList",[s.tracked])}#j=void dt7948.i(this,"inviteesList")
constructor(){super(...arguments),this._fetchInvitees()}get hasSuggestedUsers(){return this.inviteesList?.suggestedUsers?.length>0}get hasResults(){return this.inviteesList?.invitees?.length>0||this.hasSuggestedUsers}get title(){return(0,m.i18n)(`discourse_post_event.invitees_modal.${this.args.model.title||"title_invited"}`)}toggleType(e){this.type=e,this._fetchInvitees(this.filter)}static{dt7948.n(this.prototype,"toggleType",[o.action])}onFilterChanged(e){this.filter=e.target.value,this._fetchInvitees(this.filter)}static{dt7948.n(this.prototype,"onFilterChanged",[(0,p.debounce)(250)])}async removeInvitee(e){await this.discoursePostEventApi.leaveEvent(this.args.model.event,e),this.inviteesList.remove(e)}static{dt7948.n(this.prototype,"removeInvitee",[o.action])}async addInvitee(e){const t=await this.discoursePostEventApi.joinEvent(this.args.model.event,{status:this.type,user_id:e.id})
this.inviteesList.add(t)}static{dt7948.n(this.prototype,"addInvitee",[o.action])}async _fetchInvitees(e){try{this.isLoading=!0,this.inviteesList=await this.discoursePostEventApi.listEventInvitees(this.args.model.event,{type:this.type,filter:e})}finally{this.isLoading=!1}}static{(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"/i2DUc8Y",block:'[[[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],[[28,[32,2],[[30,1,["extraClass"]],"invited"],null],"post-event-invitees-modal"],null]]],[["@title","@closeModal"],[[30,0,["title"]],[30,2]]],[["body"],[[[[1,"\\n        "],[11,"input"],[16,"placeholder",[28,[32,3],["discourse_post_event.invitees_modal.filter_placeholder"],null]],[24,0,"filter"],[24,4,"text"],[4,[32,4],["input",[30,0,["onFilterChanged"]]],null],[12],[13],[1,"\\n\\n        "],[8,[32,5],null,[["@viewType","@toggle"],[[30,0,["type"]],[30,0,["toggleType"]]]],null],[1,"\\n        "],[8,[32,6],null,[["@condition"],[[30,0,["isLoading"]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["hasResults"]],[[[1,"            "],[10,"ul"],[14,0,"invitees"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["inviteesList","invitees"]]],null]],null],null,[[[1,"                "],[10,"li"],[14,0,"invitee"],[12],[1,"\\n                  "],[8,[32,7],null,[["@user"],[[30,3,["user"]]]],null],[1,"\\n"],[41,[30,1,["event","canActOnDiscoursePostEvent"]],[[[1,"                    "],[8,[32,8],[[24,0,"remove-invitee"],[16,"title",[28,[32,3],["discourse_post_event.invitees_modal.remove_invitee"],null]]],[["@icon","@action"],["trash-can",[28,[32,9],[[30,0,["removeInvitee"]],[30,3]],null]]],null],[1,"\\n"]],[]],null],[1,"                "],[13],[1,"\\n"]],[3]],null],[1,"            "],[13],[1,"\\n"],[41,[30,0,["hasSuggestedUsers"]],[[[1,"              "],[10,"ul"],[14,0,"possible-invitees"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["inviteesList","suggestedUsers"]]],null]],null],null,[[[1,"                  "],[10,"li"],[14,0,"invitee"],[12],[1,"\\n                    "],[8,[32,7],null,[["@user"],[[30,4]]],null],[1,"\\n                    "],[8,[32,8],[[24,0,"add-invitee"],[16,"title",[28,[32,3],["discourse_post_event.invitees_modal.add_invitee"],null]]],[["@icon","@action"],["plus",[28,[32,9],[[30,0,["addInvitee"]],[30,4]],null]]],null],[1,"\\n                  "],[13],[1,"\\n"]],[4]],null],[1,"              "],[13],[1,"\\n"]],[]],null]],[]],[[[1,"            "],[10,2],[14,0,"no-users"],[12],[1,"\\n              "],[1,[28,[32,3],["discourse_post_event.models.invitee.no_users"],null]],[1,"\\n            "],[13],[1,"\\n"]],[]]],[1,"        "]],[]]]]],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@model","@closeModal","invitee","user"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/index.js",scope:()=>[c.default,u.default,a.or,m.i18n,i.on,v.default,d.default,h.default,l.default,n.fn],isStrictMode:!0}),this)}}e.default=_}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user",["exports","discourse/helpers/avatar","discourse/lib/url","discourse/lib/utilities","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"Xx8EPDPC",block:'[[[1,"\\n  "],[10,3],[15,6,[28,[32,0],[[30,1,["username"]]],null]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n    "],[10,1],[14,0,"user"],[12],[1,"\\n      "],[1,[28,[32,1],[[30,1]],[["imageSize"],["medium"]]]],[1,"\\n      "],[10,1],[14,0,"username"],[12],[1,"\\n        "],[1,[28,[32,2],[[30,1,["username"]]],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["@user"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user.js",scope:()=>[s.userPath,t.default,n.formatUsername],isStrictMode:!0}),(0,r.default)(void 0,"user:User"))
e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/region-input",["exports","@ember/object","@ember-decorators/component","discourse-i18n","select-kit/components/combo-box","select-kit/components/select-kit","discourse/plugins/discourse-calendar/discourse/lib/regions"],function(e,t,s,n,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=dt7948.c(class extends i.default{allowNoneRegion=!1
get content(){const e={}
let t=[]
return this.siteSettings.available_locales.forEach(t=>{e[t.value]=t.name}),!0===this.allowNoneRegion&&t.push({name:(0,n.i18n)("discourse_calendar.region.none"),id:null}),t=t.concat(r.HOLIDAY_REGIONS.map(e=>({name:(0,n.i18n)(`discourse_calendar.region.names.${e}`),id:e})).sort((e,t)=>e.name.localeCompare(t.name))),t}static{dt7948.n(this.prototype,"content",[t.computed])}},[(0,s.classNames)("timezone-input","region-input"),(0,o.pluginApiIdentifiers)("timezone-input"),(0,o.selectKitOptions)({filterable:!0,allowAny:!1})])
e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/toggle-invitees",["exports","@ember/helper","truth-helpers","discourse/components/d-button","discourse/helpers/concat-class","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"A7DJconU",block:'[[[1,"\\n  "],[10,0],[14,0,"invitees-type-filter"],[12],[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["btn toggle-going",[52,[28,[32,2],[[30,1],"going"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.going",[28,[32,3],[[30,2],"going"],null]]],null],[1,"\\n\\n    "],[8,[32,0],[[16,0,[28,[32,1],["btn toggle-interested",[52,[28,[32,2],[[30,1],"interested"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.interested",[28,[32,3],[[30,2],"interested"],null]]],null],[1,"\\n\\n    "],[8,[32,0],[[16,0,[28,[32,1],["btn toggle-not-going",[52,[28,[32,2],[[30,1],"not_going"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.not_going",[28,[32,3],[[30,2],"not_going"],null]]],null],[1,"\\n  "],[13],[1,"\\n"]],["@viewType","@toggle"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/toggle-invitees.js",scope:()=>[n.default,i.default,s.eq,t.fn],isStrictMode:!0}),(0,a.default)(void 0,"toggle-invitees:ToggleInvitees"))
e.default=d}),define("discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar",["exports","@glimmer/component","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/routing","@ember/runloop","@ember/service","rsvp","discourse/lib/get-url","discourse/lib/load-script","discourse/models/category","discourse-i18n","discourse/plugins/discourse-calendar/discourse/helpers/format-event-name","discourse/plugins/discourse-calendar/discourse/lib/add-recurrent-events","discourse/plugins/discourse-calendar/discourse/lib/full-calendar-default-options","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v,h,f,g,_){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class b extends t.default{static{dt7948.g(this.prototype,"currentUser",[a.service])}#n=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"site",[a.service])}#r=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"router",[a.service])}#d=void dt7948.i(this,"router")
_calendar=null
get displayFilters(){return this.currentUser&&this.args.controller}teardown(){this._calendar?.destroy?.(),this._calendar=null}static{dt7948.n(this.prototype,"teardown",[s.action])}async renderCalendar(){const e=this.site.siteSettings,t=this.site.mobileView,s=document.getElementById("upcoming-events-calendar")
if(!s)return
s.innerHTML="",await this._loadCalendar()
const n=this.args.controller?.view||(t?"listNextYear":"month"),i=new window.FullCalendar.Calendar(s,{...(0,h.default)(),timeZone:this.currentUser?.user_option?.timezone||"local",firstDay:1,height:"auto",defaultView:n,views:{listNextYear:{type:"list",duration:{days:365},buttonText:"list",listDayFormat:{month:"long",year:"numeric",day:"numeric",weekday:"long"}}},header:{left:"prev,next today",center:"title",right:"month,basicWeek,listNextYear"},datesRender:e=>{this.router?.transitionTo&&this.router.transitionTo({queryParams:{view:e.view.type}})},eventPositioned:t=>{if(0===e.events_max_rows)return
let s=t.el.querySelector(".fc-content")
if(!s)return
let n=window.getComputedStyle(s),o=parseInt(n.lineHeight,10)
0===o&&(o=20)
let r=o*e.events_max_rows
s&&(s.style.maxHeight=`${r}px`)
let a=t.el.querySelector(".fc-title")
a&&(a.style.overflow="hidden",a.style.whiteSpace="pre-wrap"),i.updateSize()}})
this._calendar=i
const o=JSON.parse(e.map_events_to_color),r=this.args.events?await this.args.events:await this.args.controller.model;((0,v.default)(r)||[]).forEach(e=>{const{startsAt:t,endsAt:s,post:n,categoryId:i}=e
let r
if(n.topic.tags){const e=o.find(e=>"tag"===e.type&&n.topic.tags.includes(e.slug))
r=e?.color}if(!r){const e=o.find(e=>"category"===e.type&&e.slug===n.topic.category_slug)
r=e?.color}const a=u.default.findById(i)?.color
let d
!r&&a&&(r=`#${a}`),moment(s||t).isBefore(moment())&&(d="fc-past-event"),this._calendar.addEvent({title:(0,m.formatEventName)(e,this.currentUser?.user_option?.timezone),start:t,end:s||t,allDay:!(0,f.isNotFullDayEvent)(moment(t),moment(s)),url:(0,l.default)(`/t/-/${n.topic.id}/${n.post_number}`),backgroundColor:r,classNames:d})}),this._calendar.render()}static{dt7948.n(this.prototype,"renderCalendar",[s.action])}_loadCalendar(){return new d.Promise(e=>{(0,c.default)("/plugins/discourse-calendar/javascripts/fullcalendar-with-moment-timezone.min.js").then(()=>{(0,r.schedule)("afterRender",()=>{this.isDestroying||this.isDestroyed||e()})})})}static{(0,g.setComponentTemplate)((0,_.createTemplateFactory)({id:"uQ95koey",block:'[[[1,"\\n"],[41,[30,0,["displayFilters"]],[[[1,"      "],[10,"ul"],[14,0,"events-filter nav nav-pills"],[12],[1,"\\n        "],[10,"li"],[12],[1,"\\n          "],[8,[32,0],[[24,0,"btn-small"]],[["@route"],["discourse-post-event-upcoming-events.index"]],[["default"],[[[[1,"\\n            "],[1,[28,[32,1],["discourse_post_event.upcoming_events.all_events"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n        "],[10,"li"],[12],[1,"\\n          "],[8,[32,0],[[24,0,"btn-small"]],[["@route"],["discourse-post-event-upcoming-events.mine"]],[["default"],[[[[1,"\\n            "],[1,[28,[32,1],["discourse_post_event.upcoming_events.my_events"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[11,0],[24,1,"upcoming-events-calendar"],[4,[32,2],[[30,0,["renderCalendar"]]],null],[4,[32,3],[[30,0,["teardown"]]],null],[12],[13],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar.js",scope:()=>[o.LinkTo,p.i18n,n.default,i.default],isStrictMode:!0}),this)}}e.default=b}),define("discourse/plugins/discourse-calendar/discourse/components/upcoming-events-list",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/routing","@ember/service","truth-helpers","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/plugin-outlet","discourse/lib/ajax","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.DEFAULT_TIME_FORMAT=void 0
const h=e.DEFAULT_TIME_FORMAT="LT"
function f(e,t,s){const n=e.format("DD"),i=e.format("YYYY-MM")
s[i]=s[i]??{},s[i][n]=s[i][n]??[],s[i][n].push(t)}class g extends t.default{static{dt7948.g(this.prototype,"appEvents",[o.service])}#u=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"siteSettings",[o.service])}#t=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"router",[o.service])}#d=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"isLoading",[s.tracked],function(){return!0})}#T=void dt7948.i(this,"isLoading")
static{dt7948.g(this.prototype,"hasError",[s.tracked],function(){return!1})}#z=void dt7948.i(this,"hasError")
static{dt7948.g(this.prototype,"eventsByMonth",[s.tracked],function(){return{}})}#P=void dt7948.i(this,"eventsByMonth")
timeFormat=this.args.params?.timeFormat??h
count=this.args.params?.count??8
upcomingDays=this.args.params?.upcomingDays??180
emptyMessage=(0,u.i18n)("discourse_post_event.upcoming_events_list.empty")
allDayLabel=(0,u.i18n)("discourse_post_event.upcoming_events_list.all_day")
errorMessage=(0,u.i18n)("discourse_post_event.upcoming_events_list.error")
viewAllLabel=(0,u.i18n)("discourse_post_event.upcoming_events_list.view_all")
constructor(){super(...arguments),this.appEvents.on("page:changed",this,this.updateEventsList)}willDestroy(){super.willDestroy(...arguments),this.appEvents.off("page:changed",this,this.updateEventsList)}get categoryId(){return this.router.currentRoute.attributes?.category?.id}get hasEmptyResponse(){return!this.isLoading&&!this.hasError&&0===Object.keys(this.eventsByMonth).length}get title(){const e=this.router.currentRoute.attributes?.category?.slug,t=this.siteSettings.map_events_title
if(""===t)return(0,u.i18n)("discourse_post_event.upcoming_events_list.title")
if(JSON.parse(t).map(({category_slug:e})=>e).includes(e)){const s=JSON.parse(t).find(t=>t.category_slug===e)
return s?.custom_title}return(0,u.i18n)("discourse_post_event.upcoming_events_list.title")}async updateEventsList(){this.isLoading=!0,this.hasError=!1
const e={limit:this.count,before:moment().add(this.upcomingDays,"days").toISOString()}
this.categoryId&&(e.category_id=this.categoryId)
try{const{events:t}=await(0,c.ajax)("/discourse-post-event/events",{data:e})
this.eventsByMonth=this.groupByMonthAndDay(t)}catch{this.hasError=!0}finally{this.isLoading=!1}}static{dt7948.n(this.prototype,"updateEventsList",[n.action])}formatTime({starts_at:e,ends_at:t}){return(0,p.isNotFullDayEvent)(moment(e),moment(t))?moment(e).format(this.timeFormat):this.allDayLabel}static{dt7948.n(this.prototype,"formatTime",[n.action])}startsAtMonth(e,t){return moment(`${e}-${t}`).format("MMM")}static{dt7948.n(this.prototype,"startsAtMonth",[n.action])}startsAtDay(e,t){return moment(`${e}-${t}`).format("D")}static{dt7948.n(this.prototype,"startsAtDay",[n.action])}groupByMonthAndDay(e){return e.reduce((e,t)=>{const s=moment(t.starts_at),n=t.ends_at?moment(t.ends_at):null,i=moment()
if(!n)return f(s,t,e),e
for(;s.isSameOrBefore(n,"day");)s.isAfter(i)&&f(s,t,e),s.add(1,"day")
return e},{})}static{(0,m.setComponentTemplate)((0,v.createTemplateFactory)({id:"bLph0vTS",block:'[[[1,"\\n    "],[10,0],[14,0,"upcoming-events-list"],[12],[1,"\\n      "],[10,"h3"],[14,0,"upcoming-events-list__heading"],[12],[1,"\\n        "],[1,[30,0,["title"]]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"upcoming-events-list__container"],[12],[1,"\\n        "],[8,[32,0],null,[["@condition"],[[30,0,["isLoading"]]]],null],[1,"\\n\\n"],[41,[30,0,["hasEmptyResponse"]],[[[1,"          "],[10,0],[14,0,"upcoming-events-list__empty-message"],[12],[1,"\\n            "],[1,[30,0,["emptyMessage"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hasError"]],[[[1,"          "],[10,0],[14,0,"upcoming-events-list__error-message"],[12],[1,"\\n            "],[1,[30,0,["errorMessage"]]],[1,"\\n          "],[13],[1,"\\n          "],[8,[32,1],[[24,0,"btn-link upcoming-events-list__try-again"]],[["@action","@label"],[[30,0,["updateEventsList"]],"discourse_post_event.upcoming_events_list.try_again"]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[51,[30,0,["isLoading"]]],[[[1,"          "],[8,[32,2],null,[["@name"],["upcoming-events-list-container"]],[["default"],[[[[1,"\\n"],[42,[28,[31,3],[[30,0,["eventsByMonth"]]],null],null,[[[42,[28,[31,3],[[30,1]],null],null,[[[42,[28,[31,4],[[28,[31,4],[[30,3]],null]],null],null,[[[1,"                  "],[10,3],[14,0,"upcoming-events-list__event"],[15,6,[30,5,["post","url"]]],[12],[1,"\\n                    "],[10,0],[14,0,"upcoming-events-list__event-date"],[12],[1,"\\n                      "],[10,0],[14,0,"month"],[12],[1,[28,[30,0,["startsAtMonth"]],[[30,2],[30,4]],null]],[13],[1,"\\n                      "],[10,0],[14,0,"day"],[12],[1,[28,[30,0,["startsAtDay"]],[[30,2],[30,4]],null]],[13],[1,"\\n                    "],[13],[1,"\\n                    "],[10,0],[14,0,"upcoming-events-list__event-content"],[12],[1,"\\n                      "],[10,1],[14,0,"upcoming-events-list__event-name"],[15,"title",[28,[32,3],[[30,5,["name"]],[30,5,["post","topic","title"]]],null]],[12],[1,"\\n                        "],[1,[28,[32,3],[[30,5,["name"]],[30,5,["post","topic","title"]]],null]],[1,"\\n                      "],[13],[1,"\\n"],[41,[30,0,["timeFormat"]],[[[1,"                        "],[10,1],[14,0,"upcoming-events-list__event-time"],[12],[1,"\\n                          "],[1,[28,[30,0,["formatTime"]],[[30,5]],null]],[1,"\\n                        "],[13],[1,"\\n"]],[]],null],[1,"                    "],[13],[1,"\\n                  "],[13],[1,"\\n"]],[5]],null]],[3,4]],null]],[1,2]],null],[1,"          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"upcoming-events-list__footer"],[12],[1,"\\n        "],[8,[32,4],[[24,0,"upcoming-events-list__view-all"]],[["@route"],["discourse-post-event-upcoming-events"]],[["default"],[[[[1,"\\n          "],[1,[30,0,["viewAllLabel"]]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["monthData","month","events","day","event"],false,["if","unless","each","-each-in","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/upcoming-events-list.js",scope:()=>[a.default,d.default,l.default,r.or,i.LinkTo],isStrictMode:!0}),this)}}e.default=g}),define("discourse/plugins/discourse-calendar/discourse/connectors/before-topic-list-body/category-calendar",["exports","@glimmer/component","@ember/component","@ember/template-factory"],function(e,t,s,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{static shouldRender(e,t){return"before-topic-list-body"===t.siteSettings.calendar_categories_outlet}static{(0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"s4OTe9xw",block:'[[[1,"\\n    "],[10,0],[14,0,"before-topic-list-body-outlet category-calendar"],[12],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/before-topic-list-body/category-calendar.js",isStrictMode:!0}),this)}}e.default=i}),define("discourse/plugins/discourse-calendar/discourse/connectors/category-custom-settings/show-event-category-sorting-settings",["exports","@ember/component","@ember-decorators/component","truth-helpers","discourse-i18n","@ember/template-factory"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=dt7948.c(class extends t.default{static{(0,t.setComponentTemplate)((0,o.createTemplateFactory)({id:"ukMLJBj5",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["siteSettings","sort_categories_by_event_start_date_enabled"]],[30,0,["siteSettings","disable_resorting_on_categories_enabled"]]],null],[[[1,"      "],[10,"section"],[12],[1,"\\n        "],[10,"h3"],[12],[1,[28,[32,1],["discourse_post_event.category.settings_sections.event_sorting"],null]],[13],[1,"\\n\\n"],[41,[30,0,["siteSettings","sort_categories_by_event_start_date_enabled"]],[[[1,"          "],[10,"section"],[14,0,"field show-subcategory-list-field"],[12],[1,"\\n            "],[10,"label"],[12],[1,"\\n              "],[8,[32,2],null,[["@type","@checked"],["checkbox",[30,0,["category","custom_fields","sort_topics_by_event_start_date"]]]],null],[1,"\\n              "],[1,[28,[32,1],["discourse_post_event.category.sort_topics_by_event_start_date"],null]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["siteSettings","disable_resorting_on_categories_enabled"]],[[[1,"          "],[10,"section"],[14,0,"field show-subcategory-list-field"],[12],[1,"\\n            "],[10,"label"],[12],[1,"\\n              "],[8,[32,2],null,[["@type","@checked"],["checkbox",[30,0,["category","custom_fields","disable_topic_resorting"]]]],null],[1,"\\n              "],[1,[28,[32,1],["discourse_post_event.category.disable_topic_resorting"],null]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/category-custom-settings/show-event-category-sorting-settings.js",scope:()=>[n.or,i.i18n,t.Input],isStrictMode:!0}),this)}},[(0,s.tagName)("")])
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/connectors/discovery-list-container-top/category-events-calendar",["exports","@glimmer/component","@ember/component","@ember/template-factory"],function(e,t,s,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{static shouldRender(e,t){return"discovery-list-container-top"===t.siteSettings.calendar_categories_outlet}static{(0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"1b80e/zg",block:'[[[1,"\\n    "],[10,0],[14,1,"category-events-calendar"],[12],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/discovery-list-container-top/category-events-calendar.js",isStrictMode:!0}),this)}}e.default=i}),define("discourse/plugins/discourse-calendar/discourse/connectors/header-topic-title-suffix/event-date-container",["exports","discourse/plugins/discourse-calendar/discourse/components/event-date","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"1C/MLESD",block:'[[[1,"\\n  "],[8,[32,0],null,[["@topic"],[[30,1,["topic"]]]],null],[1,"\\n"]],["@outletArgs"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/header-topic-title-suffix/event-date-container.js",scope:()=>[t.default],isStrictMode:!0}),(0,i.default)(void 0,"event-date-container:EventDateContainer"))
e.default=o}),define("discourse/plugins/discourse-calendar/discourse/connectors/topic-list-after-title/event-badge",["exports","@glimmer/component","@ember/service","discourse/plugins/discourse-calendar/discourse/components/event-date","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static{dt7948.g(this.prototype,"siteSettings",[s.service])}#t=void dt7948.i(this,"siteSettings")
static{(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"HUnvx4VE",block:'[[[41,[30,0,["siteSettings","discourse_post_event_enabled"]],[[[41,[30,1,["topic","event_starts_at"]],[[[8,[32,0],null,[["@topic"],[[30,1,["topic"]]]],null]],[]],null]],[]],null]],["@outletArgs"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/topic-list-after-title/event-badge.js",scope:()=>[n.default],isStrictMode:!0}),this)}}e.default=r}),define("discourse/plugins/discourse-calendar/discourse/connectors/user-custom-preferences/region",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/region-input","discourse/plugins/discourse-calendar/discourse/lib/regions","@ember/component","@ember/template-factory"],function(e,t,s,n,i,o,r,a,d,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static shouldRender(e,t){return t.siteSettings.calendar_enabled}static{dt7948.g(this.prototype,"siteSettings",[n.service])}#t=void dt7948.i(this,"siteSettings")
onChange(e){this.args.outletArgs.model.set("custom_fields.holidays-region",e)}static{dt7948.n(this.prototype,"onChange",[s.action])}useCurrentRegion(){this.args.outletArgs.model.set("custom_fields.holidays-region",a.TIME_ZONE_TO_REGION[moment.tz.guess()]||"us")}static{dt7948.n(this.prototype,"useCurrentRegion",[s.action])}static{(0,d.setComponentTemplate)((0,l.createTemplateFactory)({id:"gQBAam+3",block:'[[[1,"\\n    "],[10,0],[14,0,"control-group region"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[32,0],["discourse_calendar.region.title"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"controls"],[12],[1,"\\n        "],[8,[32,1],null,[["@value","@allowNoneRegion","@onChange"],[[30,1,["model","custom_fields","holidays-region"]],true,[30,0,["onChange"]]]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,2],null,[["@icon","@label","@action"],["globe","discourse_calendar.region.use_current_region",[30,0,["useCurrentRegion"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@outletArgs"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/user-custom-preferences/region.js",scope:()=>[o.i18n,r.default,i.default],isStrictMode:!0}),this)}}e.default=c}),define("discourse/plugins/discourse-calendar/discourse/controllers/admin-plugins-calendar",["exports","@ember/controller","@ember/object","discourse/lib/ajax","discourse/lib/ajax-error"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{selectedRegion=null
loading=!1
async getHolidays(e){if(!this.loading)return this.set("selectedRegion",e),this.set("loading",!0),(0,n.ajax)(`/admin/discourse-calendar/holiday-regions/${e}/holidays`).then(e=>{this.model.set("holidays",e.holidays)}).catch(i.popupAjaxError).finally(()=>this.set("loading",!1))}static{dt7948.n(this.prototype,"getHolidays",[s.action])}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/controllers/discourse-post-event-upcoming-events-index",["exports","@ember/controller"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{queryParams=["view"]}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/controllers/discourse-post-event-upcoming-events-mine",["exports","@ember/controller"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{queryParams=["view"]}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/discourse-event-upcoming-events-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("discourse-post-event-upcoming-events",{path:"/upcoming-events"},function(){this.route("index",{path:"/"}),this.route("mine")})}}),define("discourse/plugins/discourse-calendar/discourse/helpers/format-event-name",["exports","discourse-i18n"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.formatEventName=function(e,s){let n=e.name||e.post.topic.title
e.showLocalTime&&e.timezone&&!function(e,t){if(!e||!t)return!1
const s=moment.tz(e).utcOffset(),n=moment.tz(t).utcOffset()
return s===n}(e.timezone,s)&&(n+=` (${(0,t.i18n)("discourse_calendar.local_time")}: `+moment(e.startsAt).tz(e.timezone).format("H:mma")+")")
return n}}),define("discourse/plugins/discourse-calendar/discourse/helpers/format-future-date",["exports","@ember/template","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){e=moment.utc(e).tz(moment.tz.guess())
const n=(0,s.default)(e)
return(0,t.htmlSafe)(e.format(n))}}),define("discourse/plugins/discourse-calendar/discourse/initializers/add-event-ui-builder",["exports","discourse/lib/plugin-api","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder"],function(e,t,s,n){"use strict"
function i(e){const t=e.getCurrentUser(),i=e.container.lookup("service:modal")
e.addComposerToolbarPopupMenuOption({action:e=>{const t=s.default.create({status:"public",starts_at:moment(),timezone:moment.tz.guess()})
i.show(n.default,{model:{event:t,toolbarEvent:e}})},group:"insertions",icon:"calendar-day",label:"discourse_post_event.builder_modal.attach",condition:e=>{if(!t||!t.can_create_discourse_post_event)return!1
const s=e.model
return s&&!s.replyingToTopic&&(s.topicFirstPost||s.creatingPrivateMessage||s.editingPost&&s.post&&1===s.post.post_number)}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"add-post-event-builder",initialize(e){e.lookup("service:site-settings").discourse_post_event_enabled&&(0,t.withPluginApi)(i)}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/add-upcoming-events-to-sidebar",["exports","discourse/lib/plugin-api","discourse-i18n"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"add-upcoming-events-to-sidebar",initialize(e){const n=e.lookup("service:site-settings")
n.discourse_post_event_enabled&&n.sidebar_show_upcoming_events&&(0,t.withPluginApi)(e=>{e.addCommunitySectionLink(e=>class extends e{name="upcoming-events"
route="discourse-post-event-upcoming-events"
text=(0,s.i18n)("discourse_post_event.upcoming_events.title")
title=(0,s.i18n)("discourse_post_event.upcoming_events.title")
defaultPrefixValue="calendar-day"})})}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/disable-sort",["exports","discourse/lib/plugin-api"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"disable-sort",initialize(e){(0,t.withPluginApi)(t=>{t.registerValueTransformer("topic-list-header-sortable-column",({value:t,context:s})=>{if(!t)return t
return!(e.lookup("service:site-settings").disable_resorting_on_categories_enabled&&s.category?.custom_fields?.disable_topic_resorting)})})}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/discourse-calendar",["exports","@ember/utils","jquery","pretty-text/sanitizer","rsvp","discourse/lib/ajax","discourse/lib/get-url","discourse/lib/icon-library","discourse/lib/load-script","discourse/lib/plugin-api","discourse/lib/text","discourse/lib/url","discourse/lib/utilities","discourse/models/category","discourse-i18n","discourse/plugins/discourse-calendar/discourse/helpers/format-event-name","discourse/plugins/discourse-calendar/discourse/lib/add-recurrent-events","discourse/plugins/discourse-calendar/discourse/lib/colors","discourse/plugins/discourse-calendar/discourse/lib/full-calendar-default-options","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","discourse/plugins/discourse-calendar/discourse/lib/popover"],function(e,t,s,n,i,o,r,a,d,l,c,u,p,m,v,h,f,g,_,b,y){"use strict"
function w(){return(0,d.default)("/plugins/discourse-calendar/javascripts/fullcalendar-with-moment-timezone.min.js")}function A(e){const d=e.container.lookup("service:site-settings")
if(d.login_required&&!e.getCurrentUser())return
let l,A=d.default_timezone_offset_user_option
const k=d.calendar_categories_outlet,x=e.container.lookup("service:site"),E=x&&x.mobileView,M=e.container.lookup("service:router")
let T=`.${k}-outlet`
function S(t,n){const i=function(e,t){let s=e.attr("data-calendar-default-timezone")
moment.tz.zone(s)||(s=null)
return s||t?.timezone||moment.tz.guess()}(t=t.empty(),e.getCurrentUser()),o=function(e,t){let s=document.querySelector(".discourse-calendar-header > .discourse-calendar-title")
const n=(0,p.escapeExpression)(e.attr("data-calendar-default-view")||(E?"listNextYear":"month")),i="false"!==e.attr("data-calendar-show-add-to-calendar")
return new window.FullCalendar.Calendar(e[0],{...(0,_.default)(),timeZone:t,timeZoneImpl:"moment-timezone",nextDayThreshold:"06:00:00",displayEventEnd:!0,height:650,firstDay:1,defaultView:n,views:{listNextYear:{type:"list",duration:{days:365},buttonText:"list",listDayFormat:{month:"long",year:"numeric",day:"numeric",weekday:"long"}}},header:{left:"prev,next today",center:"title",right:"month,basicWeek,listNextYear"},eventOrder:["start",j,"-participantCount","-duration","allDay","title"],datesRender:e=>{i&&U(e),s.innerText=e.view.title},eventPositioned:e=>{(function(e){if(!d.enable_timezone_offset_for_calendar_events||!A||"listNextYear"===e.view.type)return
const t=e.event.extendedProps.timezoneOffset,s=e.el.parentNode?.colSpan,n=100/s,i=5.5-s
if(t>0){if(e.isStart){const s=Math.abs(t)/24,o=n*s+"%",r=i*s+2+"px"
e.el.style.marginLeft=`calc(${o} + ${r})`}if(e.isEnd){const s=(24-Math.abs(t))/24,o=n*s+"%",r=i*s+2+"px"
e.el.style.marginRight=`calc(${o} + ${r})`}}else if(t<0){if(e.isStart){const s=(24-Math.abs(t))/24,o=n*s+"%",r=i*s+2+"px"
e.el.style.marginLeft=`calc(${o} + ${r})`}if(e.isEnd){const s=Math.abs(t)/24,o=n*s+"%",r=i*s+2+"px"
e.el.style.marginRight=`calc(${o} + ${r})`}}})(e)}})}(t,i),r="static"===t.attr("data-calendar-type"),c="true"===t.attr("data-calendar-full-day")
r?(o.render(),function(e,t,n){(0,s.default)(`<div>${n.cooked}</div>`).find('.calendar[data-calendar-type="static"] p').html().trim().split("<br>").forEach(t=>{const n=s.default.parseHTML(t),i=n.filter(e=>(0,s.default)(e).hasClass("discourse-local-date"))
let o=P(z((0,s.default)(i[0])),z((0,s.default)(i[1])))
o.title=n[0].textContent.trim(),e.addEvent(o)})}(o,0,n)):(D(o,n,c,i),o.render(),function(t,s){const n="false"===s.attr("data-weekends"),i=s.attr("data-hidden-days")
n&&t.setOption("weekends",!1)
i&&t.setOption("hiddenDays",i.split(",").map(e=>parseInt(e,10)))
t.setOption("eventClick",({event:t,jsEvent:s})=>{(0,y.destroyPopover)()
const{htmlContent:n,postNumber:i,postUrl:o}=t.extendedProps
o?u.default.routeTo(o):i?(l=l||e.container.lookup("controller:topic"),l.send("jumpToPost",i)):E&&n&&(0,y.buildPopover)(s,n)}),t.setOption("eventMouseEnter",({event:e,jsEvent:t})=>{(0,y.destroyPopover)()
const{htmlContent:s}=e.extendedProps;(0,y.buildPopover)(t,s)}),t.setOption("eventMouseLeave",()=>{(0,y.destroyPopover)()})}(o,t))
const m=()=>{const e=o.getOption("timeZone")
o.getEvents().forEach(e=>e.remove()),D(o,n,c,e)};(function(e,t,s){const n=document.querySelector(".discourse-calendar-timezone-picker")
n?(n.addEventListener("change",function(t){e.setOption("timeZone",t.target.value),A&&(s(),U(e))}),moment.tz.names().filter(e=>!e.startsWith("Etc/GMT")).forEach(e=>{n.appendChild(new Option(e,e))}),n.value=t):document.querySelector(".discourse-calendar-timezone-wrap").innerText=t})(o,i,m),d.enable_timezone_offset_for_calendar_events&&function(e){const t=document.querySelector(".discourse-calendar-timezone-wrap"),s=document.createElement("button")
s.title=(0,v.i18n)("discourse_calendar.toggle_timezone_offset_title"),s.classList.add("timezone-offset-button","btn","btn-default","btn-icon","no-text"),s.innerHTML=(0,a.iconHTML)("globe"),t.appendChild(s),s.addEventListener("click",()=>{A=!A,e(),s.blur()})}(m)}function j(e,t){if(!d.enable_timezone_offset_for_calendar_events&&!A)return 0
const s=e.extendedProps.timezoneOffset,n=t.extendedProps.timezoneOffset
return s===n?0:s<n?-1:1}function z(e){const t=e.attr("data-date")
if(!t)return null
const s=e.attr("data-time"),n=e.attr("data-timezone")
let i=t
return s&&(i=`${i} ${s}`),{weeklyRecurring:"1.weeks"===e.attr("data-recurring"),dateTime:moment.tz(i,n||"Etc/UTC")}}function P(e,t){const s=e=>!!e&&(0!==e.hours()||0!==e.minutes()||0!==e.seconds()),n=s(t?.dateTime)||s(e?.dateTime),i=n?"YYYY-MM-DD HH:mm:ssZ":"YYYY-MM-DD"
let o={start:e.dateTime.format(i),allDay:!1}
return t?n?o.end=t.dateTime.format(i):(o.end=t.dateTime.add(1,"days").format(i),o.allDay=!0):o.allDay=!0,e.weeklyRecurring&&(o.startTime={hours:e.dateTime.hours(),minutes:e.dateTime.minutes(),seconds:e.dateTime.seconds()},o.daysOfWeek=[e.dateTime.day()]),o}function C(e){const t=P(e.from?{dateTime:moment(e.from),weeklyRecurring:"1.weeks"===e.recurring}:null,e.to?{dateTime:moment(e.to),weeklyRecurring:"1.weeks"===e.recurring}:null)
return t.extendedProps={},e.post_url?t.extendedProps.postUrl=e.post_url:e.post_number?t.extendedProps.postNumber=e.post_number:t.classNames=["holiday"],e.timezoneOffset&&(t.extendedProps.timezoneOffset=e.timezoneOffset),t}function O(e,t,s){const i=C(s),o=parseInt(d.holiday_calendar_topic_id,10),r=s.message.split("\n").filter(e=>e)
if(r.length&&t.topic_id&&o!==t.topic_id)i.title=r[0],i.extendedProps.description=r.slice(1).join(" ")
else{const e=(0,g.stringToColor)(s.username)
i.title=s.username,i.backgroundColor=(0,g.colorToHex)(e),i.textColor=(0,g.contrastColor)(e)}let a=s.message.slice(0,100)
s.message.length>100&&(a+="…"),i.extendedProps.htmlContent=(0,n.escape)(a),i.title=i.title.replace(/<img[^>]*>/g,""),i.participantCount=1,e.addEvent(i)}function I(e,t,s,n,i){const o=d.enable_timezone_offset_for_calendar_events&&A&&n?function(e,t){const s=moment.tz(t).utcOffset()
let n=[],i=[]
return Object.values(e.localEvents).forEach(e=>{e.users.forEach(e=>{const t=moment.tz(e.timezone).utcOffset(),i=(s-t)/60
e.timezoneOffset=i,n.push(i)})}),[...new Set(n)].forEach((t,s)=>{let n={},o=[]
if(Object.keys(e.localEvents).forEach(i=>{const r=d.split_grouped_events_by_timezone_threshold,a=e.localEvents[i].users.filter(e=>Math.abs(e.timezoneOffset-(t+r*s))<=r)
a.length>0&&(n[i]={users:a},a.forEach(t=>{e.localEvents[i].users.splice(e.localEvents[i].users.findIndex(e=>e.username===t.username),1),o.find(e=>e.timezoneOffset===t.timezoneOffset)||o.push({timezone:t.timezone,timezoneOffset:t.timezoneOffset})}))}),Object.keys(n).length>0){const t=function(e){const t=e.reduce((e,t)=>e+t.timezoneOffset,0),s=t/e.length
return e.reduce((e,t)=>Math.abs(t.timezoneOffset-s)<Math.abs(e.timezoneOffset-s)?t:e)}(o)
let s=moment.tz(e.from,t.timezone),r=moment.tz(e.to,t.timezone)
L(s,r,t.timezoneOffset),i.push({timezoneOffset:t.timezoneOffset,localEvents:n,from:s.format("YYYY-MM-DD"),to:r.format("YYYY-MM-DD")})}}),i}(s,i):[s]
o.forEach(t=>{let s="",n=[],i=[]
Object.keys(t.localEvents).sort().forEach(e=>{const o=t.localEvents[e]
s+=`<b>${e}</b>: ${o.users.map(e=>e.username).sort().join(", ")}<br>`,n=n.concat(o.users),i.push(e)})
const o=C(t)
o.classNames=["grouped-event"],n.length>2?o.title=`(${n.length}) ${i[0]}`:1===n.length?o.title=n[0].username:o.title=E?`(${n.length}) ${i[0]}`:`(${n.length}) `+n.map(e=>e.username).join(", "),i.length>1||n.length>1?o.extendedProps.htmlContent=s:o.extendedProps.htmlContent=i[0],o.participantCount=n.length,e.addEvent(o)})}function D(e,t,s,n){const i=[],o=moment.tz(n).utcOffset();(t.calendar_details||[]).forEach(n=>{switch(n.type){case"grouped":s&&n.timezone&&(n.from=moment.tz(n.from,n.timezone).format("YYYY-MM-DD")),i.push(n)
break
case"standalone":if(s&&n.timezone){const s={...n}
let i=moment.tz(n.from,n.timezone),r=moment.tz(n.to,n.timezone)
if(d.enable_timezone_offset_for_calendar_events&&A){const e=moment.tz(n.timezone).utcOffset(),t=(o-e)/60
s.timezoneOffset=t,L(i,r,t)}s.from=i.format("YYYY-MM-DD"),s.to=r.format("YYYY-MM-DD"),O(e,t,s)}else O(e,t,n)}})
const r={}
i.forEach(e=>{const t=s?moment(e.from).format("YYYY-MM-DD"):moment(e.from).utc().startOf("day").toISOString(),n=s?moment(e.to||e.from).format("YYYY-MM-DD"):moment(e.to||e.from).utc().endOf("day").toISOString(),i=`${t}-${n}`
r[i]=r[i]||{from:t,to:n||t,localEvents:{}},r[i].localEvents[e.name]=r[i].localEvents[e.name]||{users:[]},r[i].localEvents[e.name].users.push.apply(r[i].localEvents[e.name].users,e.users)}),Object.keys(r).forEach(t=>{const i=r[t]
I(e,0,i,s,n)})}function L(e,t,s){s>0?t.isValid()?t.add(1,"day"):t=e.clone().add(1,"day"):s<0&&(t.isValid()||(t=e.clone()),e.subtract(1,"day"))}function U(e){if("listNextYear"!==e.view.type)return
const t=e.view.eventRenderer.segs,s=function(e){let t={}
for(let s of e.view.calendar.getEvents())t[s._instance.defId]={start:s.start,end:s.end}
return t}(e)
for(const n of t)N(n,s)}function N(e,t){const s=e.eventRange.def.title
let n=t[e.eventRange.def.defId],i=n.start,o=n.end
o=o?R(o,e.eventRange.def.allDay):function(e,t){const s=t?"days":"hours"
return R(moment(e).add(1,s).toDate(),t)}(i,e.eventRange.def.allDay),i=R(i,e.eventRange.def.allDay)
const r=document.createElement("a"),a=(0,v.i18n)("discourse_calendar.add_to_calendar")
r.title=a,r.appendChild(document.createTextNode(a)),r.href=`\n      http://www.google.com/calendar/event?action=TEMPLATE&text=${encodeURIComponent(s)}&dates=${i}/${o}&details=${encodeURIComponent(e.eventRange.def.extendedProps.description)}`,r.target="_blank",r.classList.add("fc-list-item-add-to-calendar"),e.el.querySelector(".fc-list-item-title").appendChild(r)}function R(e,t=!1){return t?moment(e).utc().format("YYYYMMDD"):e.toISOString().replace(/-|:|\.\d\d\d/g,"")}"before-topic-list-body"===k&&(T=`.topic-list:not(.shared-drafts) .${k}-outlet`),e.onPageChange(async n=>{(0,y.destroyPopover)()
const a=document.querySelector(`${T}.category-calendar`)
a&&(a.innerHTML="")
const l=document.getElementById("category-events-calendar")
l&&(l.innerHTML="")
const u=M.recognize(n)
if(!u?.params?.category_slug_path_with_id)return
const v=m.default.findBySlugPathWithID(u.params.category_slug_path_with_id)
if(!v)return
const g=d.calendar_categories.split("|").filter(Boolean).map(e=>{const t={}
return e.split(";").filter(Boolean).forEach(e=>{const s=e.split("=")
t[s[0]]=s[1]}),t}).findBy("categoryId",v.id.toString())
if(a&&g&&g.postId){const e=g.postId
a.innerHTML='<div class="calendar"><div class="spinner medium"></div></div>',await w()
const n=[`postId=${e}`];["weekends","tzPicker","defaultView"].forEach(e=>{(0,t.isPresent)(g[e])&&n.push(`${e}=${(0,p.escapeExpression)(g[e])}`)})
const r=`[calendar ${n.join(" ")}]\n[/calendar]`,d=(0,c.cook)(r),l=(0,o.ajax)(`/posts/${e}.json`),[u,m]=await i.Promise.all([d,l])
a.innerHTML=u.toString(),S((0,s.default)(".calendar"),m)}else{if(!l)return
if(d.events_calendar_categories.split("|").find(e=>e===v.id.toString())){await w()
let t=new window.FullCalendar.Calendar(l,{...(0,_.default)(),firstDay:1,eventPositioned:e=>{if(0===d.events_max_rows)return
let s=e.el.querySelector(".fc-content"),n=window.getComputedStyle(s),i=parseInt(n.lineHeight,10)
0===i&&(i=20)
let o=i*d.events_max_rows
s&&(s.style.maxHeight=`${o}px`)
let r=e.el.querySelector(".fc-title")
r&&(r.style.overflow="hidden",r.style.whiteSpace="pre-wrap"),t.updateSize()}})
const s={category_id:v.id,include_subcategories:!0}
d.include_expired_events_on_calendar&&(s.include_expired=!0)
const n=JSON.parse(d.map_events_to_color),i=e.container.lookup("service:discourse-post-event-api"),o=await i.events(s);(0,f.default)(o).forEach(s=>{const{startsAt:i,endsAt:o,post:a,categoryId:d}=s
let l,c
if(a.topic.tags){const e=n.find(e=>"tag"===e.type&&a.topic.tags.includes(e.slug))
l=e?e.color:null}if(!l){const e=n.find(e=>"category"===e.type&&e.slug===a.topic.category_slug)?.color
l=e||`#${m.default.findById(d)?.color}`}moment(o||i).isBefore(moment())&&(c="fc-past-event"),t.addEvent({title:(0,h.formatEventName)(s,e.getCurrentUser()?.user_option?.timezone),start:i,end:o||i,allDay:!(0,b.isNotFullDayEvent)(moment(i),moment(o)),url:(0,r.default)(`/t/-/${a.topic.id}/${a.post_number}`),backgroundColor:l,classNames:c})}),t.render()}}}),e.decorateCooked((e,t)=>function(e,t){const n=(0,s.default)(".calendar",e)
if(0===n.length)return
w().then(()=>S(n,t.getModel()))}(e,t),{onlyStream:!0,id:"discourse-calendar"}),e.registerCustomPostMessageCallback("calendar_change",e=>{const t=e.get("model.postStream"),n=t.findLoadedPost(t.get("firstPostId")),i=(0,s.default)(".topic-post article#post_1").find(".calendar").first()
n&&i.length>0&&(0,o.ajax)(`/posts/${n.id}.json`).then(()=>w().then(()=>S(i,n)))}),e.registerNotificationTypeRenderer&&(e.registerNotificationTypeRenderer("event_reminder",e=>class extends e{get linkTitle(){return this.notification.data.title?(0,v.i18n)(this.notification.data.title):super.linkTitle}get icon(){return"calendar-day"}get label(){return(0,v.i18n)(this.notification.data.message)}get description(){return this.notification.data.topic_title}}),e.registerNotificationTypeRenderer("event_invitation",e=>class extends e{get icon(){return"calendar-day"}get label(){return"discourse_post_event.notifications.invite_user_predefined_attendance_notification"===this.notification.data.message?(0,v.i18n)(this.notification.data.message,{username:this.username,eventName:this.notification.data.event_name||(0,v.i18n)("discourse_post_event.notifications.an_event")}):super.label}get description(){return this.notification.data.topic_title}}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-calendar",initialize(e){e.lookup("service:site-settings").calendar_enabled&&(0,l.withPluginApi)(A)}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator",["exports","discourse/lib/environment","discourse/lib/plugin-api","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o,r,a,d,l){"use strict"
function c(e){e.innerHTML="",e.classList.add("discourse-post-event-preview")
const s=`discourse_post_event.models.event.status.${e.dataset.status||"public"}.title`
if(n.default.lookup(s,{locale:"en"})){const t=document.createElement("div")
t.classList.add("event-preview-status"),t.innerText=(0,n.i18n)(s),e.appendChild(t)}const i=document.createElement("div")
i.classList.add("event-preview-dates")
const o=moment.tz(e.dataset.start,e.dataset.timezone||"UTC"),a=e.dataset.end&&moment.tz(e.dataset.end,e.dataset.timezone||"UTC"),d=(0,r.default)(o,a),l=(0,t.isTesting)()?"UTC":moment.tz.guess()
let c=`<span class='start'>${o.tz(l).format(d)}</span>`
a&&(c+=` → <span class='end'>${a.tz(l).format(d)}</span>`),i.innerHTML=c,e.appendChild(i)}function u(e,t){t.querySelectorAll(".discourse-post-event").forEach((e,t)=>{t>0?function(e){e.classList.add("discourse-post-event-preview","alert","alert-error"),e.classList.remove("discourse-post-event"),e.innerText=(0,n.i18n)("discourse_post_event.preview.more_than_one_event")}(e):c(e)})}function p(e){e.decorateCookedElement((e,t)=>{if(e.classList.contains("d-editor-preview"))u(0,e)
else if(t){const s=t.getModel()
if(!s?.event)return
const n=e.querySelector(".discourse-post-event")
if(!n)return
const r=document.createElement("div")
n.before(r)
const c=o.default.create(s.event)
t.renderGlimmer(r,(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"QiC3s8Lf",block:'[[[8,[32,0],null,[["@event"],[[32,1]]],null]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator.js",scope:()=>[i.default,c],isStrictMode:!0}),(0,l.default)(void 0,void 0)))}},{id:"discourse-post-event-decorator"}),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_auto_notification","calendar-day"),e.replaceIcon("notification.discourse_calendar.invite_user_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_predefined_attendance_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.before_event_reminder","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.after_event_reminder","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.ongoing_event_reminder","calendar-day")}Object.defineProperty(e,"__esModule",{value:!0}),e.buildEventPreview=c,e.default=void 0
e.default={name:"discourse-post-event-decorator",initialize(e){e.lookup("service:site-settings").discourse_post_event_enabled&&(0,s.withPluginApi)(p)}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/event-relative-date",["exports","@ember/runloop","discourse/lib/environment","discourse/lib/later","discourse/plugins/discourse-calendar/discourse/lib/event-relative-date"],function(e,t,s,n,i){"use strict"
function o(){document.querySelectorAll(".event-relative-date.topic-list").forEach(e=>(0,i.default)(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"event-future-date",initialize(){o(),(0,s.isTesting)()||this._tick()},teardown(){this._interval&&((0,t.cancel)(this._interval),this._interval=null)},_tick(){this._interval&&(0,t.cancel)(this._interval),this._interval=(0,n.default)(()=>{o(),this._tick()},6e4)}}}),define("discourse/plugins/discourse-calendar/discourse/lib/add-recurrent-events",["exports","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){try{return e.flatMap(e=>{if(!e.upcomingDates?.length)return[e]
return e.upcomingDates?.map(s=>t.default.create({name:e.name,post:e.post,category_id:e.categoryId,starts_at:s.starts_at,ends_at:s.ends_at}))||[]})}catch(s){return console.error("Failed to retrieve events:",s),[]}}}),define("discourse/plugins/discourse-calendar/discourse/lib/calendar-locale",["exports","discourse-i18n"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getCalendarButtonsText=function(){return{today:(0,t.i18n)("discourse_calendar.toolbar_button.today"),month:(0,t.i18n)("discourse_calendar.toolbar_button.month"),week:(0,t.i18n)("discourse_calendar.toolbar_button.week"),day:(0,t.i18n)("discourse_calendar.toolbar_button.day"),list:(0,t.i18n)("discourse_calendar.toolbar_button.list")}},e.getCurrentBcp47Locale=function(){return t.default.currentLocale().replace("_","-").toLowerCase()}}),define("discourse/plugins/discourse-calendar/discourse/lib/colors",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.colorToHex=function(e){let t="#"
for(let s=0;s<3;s++)t+=("00"+Math.round(e[s]).toString(16)).slice(-2)
return t},e.contrastColor=function(e){return(.2126*e[0]+.7152*e[1]+.0722*e[2])/255>=.5?"#000d":"#fffd"},e.stringToColor=function(e){let t=0
for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t)
let s=[]
for(let n=0;n<3;n++){let e=t>>8*n&255
s.push(e)}return s}}),define("discourse/plugins/discourse-calendar/discourse/lib/discourse-markdown/discourse-calendar",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div.calendar","div.discourse-calendar-header","div.discourse-calendar-wrap","select.discourse-calendar-timezone-picker","span.discourse-calendar-timezone-wrap","h2.discourse-calendar-title","div[data-calendar-type]","div[data-calendar-default-view]","div[data-calendar-default-timezone]","div[data-weekends]","div[data-hidden-days]","div.group-timezones","div[data-group]","div[data-size]"]),e.registerOptions((e,t)=>{e.features["discourse-calendar-enabled"]=!!t.calendar_enabled}),e.registerPlugin(e=>{e.options.discourse.features["discourse-calendar-enabled"]&&(e.block.bbcode.ruler.push("discourse-calendar",t),e.block.bbcode.ruler.push("discourse-group-timezones",s))})}
const t={tag:"calendar",before:function(e,t){e.push("div_calendar_wrap","div",1).attrs=[["class","discourse-calendar-wrap"]],e.push("div_calendar_header","div",1).attrs=[["class","discourse-calendar-header"]],e.push("h2_open","h2",1).attrs=[["class","discourse-calendar-title"]],e.push("h2_close","h2",-1),e.push("span_open","span",1).attrs=[["class","discourse-calendar-timezone-wrap"]],"true"===t.attrs.tzPicker&&function(e){const t=e.push("select_open","select",1)
t.attrs=[["class","discourse-calendar-timezone-picker"]],e.push("select_close","select",-1)}(e),e.push("span_close","span",-1),e.push("div_calendar_header","div",-1)
let s=e.push("div_calendar","div",1)
s.attrs=[["class","calendar"],["data-calendar-type",t.attrs.type||"dynamic"],["data-calendar-default-timezone",t.attrs.defaultTimezone]],t.attrs.defaultView&&s.attrs.push(["data-calendar-default-view",t.attrs.defaultView]),t.attrs.weekends&&s.attrs.push(["data-weekends",t.attrs.weekends]),t.attrs.showAddToCalendar&&s.attrs.push(["data-calendar-show-add-to-calendar","true"===t.attrs.showAddToCalendar]),t.attrs.fullDay&&s.attrs.push(["data-calendar-full-day","true"===t.attrs.fullDay]),t.attrs.hiddenDays&&s.attrs.push(["data-hidden-days",t.attrs.hiddenDays])},after:function(e){e.push("div_calendar","div",-1),e.push("div_calendar_wrap","div",-1)}},s={tag:"timezones",before:function(e,t){e.push("div_group_timezones","div",1).attrs=[["class","group-timezones"],["data-group",t.attrs.group],["data-size",t.attrs.size||"medium"]]},after:function(e){e.push("div_group_timezones","div",-1)}}})
define("discourse/plugins/discourse-calendar/discourse/lib/discourse-markdown/discourse-post-event-block",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div.discourse-post-event"]),e.registerOptions((e,t)=>{e.features.discourse_post_event=t.calendar_enabled&&t.discourse_post_event_enabled}),e.registerPlugin(e=>e.block.bbcode.ruler.push("discourse-post-event",t))}
const t={tag:"event",wrap:(e,t)=>!!t.attrs.start&&(e.attrs=[["class","discourse-post-event"]],Object.keys(t.attrs).forEach(s=>{const n=t.attrs[s]
var i
void 0!==n&&e.attrs.push([`data-${i=s,i.replace(/[A-Z]/g,function(e,t){return(0!==t?"-":"")+e.toLowerCase()})}`,n])}),!0)}}),define("discourse/plugins/discourse-calendar/discourse/lib/event-relative-date",["exports","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){e.classList.remove("past","current","future"),e.innerHTML=""
const n=moment.utc(e.dataset.starts_at).tz(moment.tz.guess()),i=moment.utc(e.dataset.ends_at).tz(moment.tz.guess()),o=(0,s.default)(n)
let r=n.format(o)
i&&(r+=` → ${i.format(o)}`)
if(e.setAttribute("title",r),n.isAfter(moment())&&i.isAfter(moment()))return e.classList.add("future"),void function(e,t){e.innerText=t.from(moment())}(e,n)
if(n.isBefore(moment())&&i.isAfter(moment()))return e.classList.add("current"),void function(e,s){const n=document.createElement("div")
n.classList.add("indicator"),e.appendChild(n)
const i=document.createElement("span")
i.classList.add("text"),i.innerText=(0,t.i18n)("discourse_post_event.topic_title.ends_in_duration",{duration:s.from(moment())}),e.appendChild(i)}(e,i)
if(n.isBefore(moment())&&i.isBefore(moment()))return e.classList.add("past"),void function(e,t){e.innerText=t.from(moment())}(e,i)}}),define("discourse/plugins/discourse-calendar/discourse/lib/full-calendar-default-options",["exports","pretty-text/sanitizer","discourse/plugins/discourse-calendar/discourse/lib/calendar-locale","discourse/plugins/discourse-calendar/discourse/lib/popover"],function(e,t,s,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return{eventClick:function(){(0,n.destroyPopover)()},locale:(0,s.getCurrentBcp47Locale)(),buttonText:(0,s.getCalendarButtonsText)(),eventMouseEnter:function({event:e,jsEvent:s}){(0,n.destroyPopover)()
const i=(0,t.escape)(e.title);(0,n.buildPopover)(s,i)},eventMouseLeave:function(){(0,n.destroyPopover)()}}}}),define("discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format",["exports"],function(e){"use strict"
function t(e,t){return e.hours()>0||e.minutes()>0||t&&(moment(t).hours()>0||moment(t).minutes()>0)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,s){let n
n=t(e,s)?"LLL":"LL"
return n},e.isNotFullDayEvent=t}),define("discourse/plugins/discourse-calendar/discourse/lib/popover",["exports","@popperjs/core"],function(e,t){"use strict"
let s
Object.defineProperty(e,"__esModule",{value:!0}),e.buildPopover=function(e,i){const o=document.createElement("div")
o.setAttribute("id",n),o.innerHTML=i
const r=document.createElement("span")
r.dataset.popperArrow=!0,o.appendChild(r),document.body.appendChild(o),s=(0,t.createPopper)(e.target,document.getElementById(n),{placement:"bottom",modifiers:[{name:"arrow"},{name:"offset",options:{offset:[20,10]}}]})},e.destroyPopover=function(){s?.destroy(),document.getElementById(n)?.remove()}
const n="event-popover"}),define("discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.buildParams=function(e,t,s,n){const i={},o=s.timezone||"UTC"
i.start=moment(e).tz(o).format("YYYY-MM-DD HH:mm"),s.isClosed&&(i.closed="true")
s.status&&(i.status=s.status)
s.name&&(i.name=s.name)
s.location&&(i.location=s.location)
s.description&&(i.description=s.description)
s.url&&(i.url=s.url)
s.timezone&&(i.timezone=s.timezone)
s.recurrence&&(i.recurrence=s.recurrence)
s.recurrenceUntil&&(i.recurrenceUntil=moment(s.recurrenceUntil).tz(o).format("YYYY-MM-DD HH:mm"))
s.showLocalTime&&(i.showLocalTime="true")
s.minimal&&(i.minimal="true")
s.chatEnabled&&(i.chatEnabled="true")
t&&(i.end=moment(t).tz(o).format("YYYY-MM-DD HH:mm"))
"private"===s.status&&(i.allowedGroups=(s.rawInvitees||[]).join(","))
s.reminders&&s.reminders.length&&(i.reminders=s.reminders.map(e=>{const t=Object.assign({},e)
return"after"===t.period&&(t.value=`-${Math.abs(parseInt(t.value,10))}`),"before"===t.period&&(t.value=Math.abs(parseInt(`${t.value}`,10))),`${t.type}.${t.value}.${t.unit}`}).join(","))
return n.discourse_post_event_allowed_custom_fields.split("|").filter(Boolean).forEach(e=>{const t=e.toLowerCase().replace(/-/g,"_").replace(/_(.)/g,function(e,t){return t.toUpperCase()})
void 0!==s.customFields[e]&&(i[t]=s.customFields[e])}),i},e.replaceRaw=function(e,t){const s=/\[event (.*?)\](.*?)\[\/event\]/s,n=t.match(s)
if(n&&n[1]){const n=[]
let i=e.description
return i=i?`${i}\n`:"",delete e.description,Object.keys(e).forEach(t=>{const s=e[t]
s&&s.length&&n.push(`${t}="${s.replace(/"/g,"")}"`)}),t.replace(s,`[event ${n.join(" ")}]\n${i}[/event]`)}return!1}}),define("discourse/plugins/discourse-calendar/discourse/lib/regions",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.TIME_ZONE_TO_REGION=e.HOLIDAY_REGIONS=void 0
e.HOLIDAY_REGIONS=["ae","ar","at","au","au_nsw","au_vic","au_qld","au_nt","au_act","au_sa","au_wa","au_tas","au_tas_south","au_qld_cairns","au_qld_brisbane","au_tas_north","au_vic_melbourne","be_fr","be_nl","br","br_spcapital","br_sp","bg_en","bg_bg","ca","ca_qc","ca_ab","ca_sk","ca_on","ca_bc","ca_nb","ca_mb","ca_ns","ca_pe","ca_nl","ca_nt","ca_nu","ca_yt","us","ch_zh","ch_be","ch_lu","ch_ur","ch_sz","ch_ow","ch_nw","ch_gl","ch_zg","ch_fr","ch_so","ch_bs","ch_bl","ch_sh","ch_ar","ch_ai","ch_sg","ch_gr","ch_ag","ch_tg","ch_ti","ch_vd","ch_ne","ch_ge","ch_ju","ch_vs","ch","cl","co","cr","cz","dk","de","de_bw","de_by","de_he","de_nw","de_rp","de_sl","de_sn_sorbian","de_th_cath","de_sn","de_st","de_be","de_by_cath","de_by_augsburg","de_bb","de_mv","de_th","de_hb","de_hh","de_ni","de_sh","ee","el","es_pv","es_na","es_an","es_ib","es_cm","es_mu","es_m","es_ar","es_cl","es_cn","es_lo","es_ga","es_ce","es_o","es_ex","es","es_ct","es_v","es_vc","fi","fr_a","fr_m","fr","gb","gb_eng","gb_wls","gb_eaw","gb_nir","je","gb_jsy","gg","gb_gsy","gb_sct","gb_con","im","gb_iom","ge","gh","hr","hk","hu","id","ie","in","in_mh","in_gj","in_ka","in_tn","is","it","it_ve","it_tv","it_vr","it_pd","it_fi","it_ge","it_to","it_rm","it_vi","it_bl","it_ro","kr","kz","li","lt","lv","ma","mt_mt","mt_en","mx","mx_pue","nl","lu","no","nz","nz_sl","nz_we","nz_ak","nz_nl","nz_ne","nz_ot","nz_ta","nz_sc","nz_hb","nz_mb","nz_ca","nz_ch","nz_wl","pe","ph","pl","pt","pt_li","pt_po","ro","rs_cyrl","rs_la","ru","se","sa","tn","tr","ua","us_fl","us_la","us_ct","us_de","us_gu","us_hi","us_in","us_ky","us_nj","us_nc","us_nd","us_pr","us_tn","us_ms","us_id","us_ar","us_tx","us_dc","us_md","us_va","us_vt","us_ak","us_ca","us_me","us_ma","us_al","us_ga","us_ne","us_mo","us_sc","us_wv","us_vi","us_ut","us_ri","us_az","us_co","us_oh","us_or","us_sd","us_wy","us_nv","us_mt","us_ny","us_pa","us_nm","us_ia","us_il","us_ks","us_mi","us_mn","us_nh","us_ok","us_wa","us_wi","za","ve","sk","si","jp","vi","sg","my","th","ng","ke","zw"],e.TIME_ZONE_TO_REGION={"Africa/Accra":"gh","Africa/Casablanca":"ma","Africa/Ceuta":"es","Africa/Harare":"zw","Africa/Johannesburg":"za","Africa/Lagos":"ng","Africa/Nairobi":"ke","Africa/Tunis":"tn","America/Adak":"us","America/Anchorage":"us","America/Araguaina":"br","America/Argentina/Buenos_Aires":"ar","America/Argentina/Catamarca":"ar","America/Argentina/Cordoba":"ar","America/Argentina/Jujuy":"ar","America/Argentina/La_Rioja":"ar","America/Argentina/Mendoza":"ar","America/Argentina/Rio_Gallegos":"ar","America/Argentina/Salta":"ar","America/Argentina/San_Juan":"ar","America/Argentina/San_Luis":"ar","America/Argentina/Tucuman":"ar","America/Argentina/Ushuaia":"ar","America/Atikokan":"ca","America/Bahia":"br","America/Bahia_Banderas":"mx","America/Belem":"br","America/Blanc-Sablon":"ca","America/Boa_Vista":"br","America/Bogota":"co","America/Boise":"us","America/Cambridge_Bay":"ca","America/Campo_Grande":"br","America/Cancun":"mx","America/Caracas":"ve","America/Chicago":"us","America/Chihuahua":"mx","America/Ciudad_Juarez":"mx","America/Costa_Rica":"cr","America/Coyhaique":"cl","America/Creston":"ca","America/Cuiaba":"br","America/Dawson":"ca","America/Dawson_Creek":"ca","America/Denver":"us","America/Detroit":"us","America/Edmonton":"ca","America/Eirunepe":"br","America/Fort_Nelson":"ca","America/Fortaleza":"br","America/Glace_Bay":"ca","America/Goose_Bay":"ca","America/Halifax":"ca","America/Hermosillo":"mx","America/Indiana/Indianapolis":"us","America/Indiana/Knox":"us","America/Indiana/Marengo":"us","America/Indiana/Petersburg":"us","America/Indiana/Tell_City":"us","America/Indiana/Vevay":"us","America/Indiana/Vincennes":"us","America/Indiana/Winamac":"us","America/Inuvik":"ca","America/Iqaluit":"ca","America/Juneau":"us","America/Kentucky/Louisville":"us","America/Kentucky/Monticello":"us","America/Lima":"pe","America/Los_Angeles":"us","America/Maceio":"br","America/Manaus":"br","America/Matamoros":"mx","America/Mazatlan":"mx","America/Menominee":"us","America/Merida":"mx","America/Metlakatla":"us","America/Mexico_City":"mx","America/Moncton":"ca","America/Monterrey":"mx","America/New_York":"us","America/Nome":"us","America/Noronha":"br","America/North_Dakota/Beulah":"us","America/North_Dakota/Center":"us","America/North_Dakota/New_Salem":"us","America/Ojinaga":"mx","America/Phoenix":"us","America/Porto_Velho":"br","America/Punta_Arenas":"cl","America/Rankin_Inlet":"ca","America/Recife":"br","America/Regina":"ca","America/Resolute":"ca","America/Rio_Branco":"br","America/Santarem":"br","America/Santiago":"cl","America/Sao_Paulo":"br","America/Sitka":"us","America/St_Johns":"ca","America/St_Thomas":"vi","America/Swift_Current":"ca","America/Tijuana":"mx","America/Toronto":"ca","America/Vancouver":"ca","America/Whitehorse":"ca","America/Winnipeg":"ca","America/Yakutat":"us","Antarctica/Macquarie":"au","Asia/Almaty":"kz","Asia/Anadyr":"ru","Asia/Aqtau":"kz","Asia/Aqtobe":"kz","Asia/Atyrau":"kz","Asia/Bangkok":"th","Asia/Barnaul":"ru","Asia/Chita":"ru","Asia/Dubai":"ae","Asia/Hong_Kong":"hk","Asia/Irkutsk":"ru","Asia/Jakarta":"id","Asia/Jayapura":"id","Asia/Kamchatka":"ru","Asia/Khandyga":"ru","Asia/Kolkata":"in","Asia/Krasnoyarsk":"ru","Asia/Kuala_Lumpur":"my","Asia/Kuching":"my","Asia/Magadan":"ru","Asia/Makassar":"id","Asia/Manila":"ph","Asia/Novokuznetsk":"ru","Asia/Novosibirsk":"ru","Asia/Omsk":"ru","Asia/Oral":"kz","Asia/Pontianak":"id","Asia/Qostanay":"kz","Asia/Qyzylorda":"kz","Asia/Riyadh":"sa","Asia/Sakhalin":"ru","Asia/Seoul":"kr","Asia/Singapore":"sg","Asia/Srednekolymsk":"ru","Asia/Tbilisi":"ge","Asia/Tokyo":"jp","Asia/Tomsk":"ru","Asia/Ust-Nera":"ru","Asia/Vladivostok":"ru","Asia/Yakutsk":"ru","Asia/Yekaterinburg":"ru","Atlantic/Azores":"pt","Atlantic/Canary":"es","Atlantic/Madeira":"pt","Atlantic/Reykjavik":"is","Australia/Adelaide":"au","Australia/Brisbane":"au","Australia/Broken_Hill":"au","Australia/Darwin":"au","Australia/Eucla":"au","Australia/Hobart":"au","Australia/Lindeman":"au","Australia/Lord_Howe":"au","Australia/Melbourne":"au","Australia/Perth":"au","Australia/Sydney":"au","Europe/Amsterdam":"nl","Europe/Astrakhan":"ru","Europe/Athens":"el","Europe/Berlin":"de","Europe/Bratislava":"sk","Europe/Bucharest":"ro","Europe/Budapest":"hu","Europe/Busingen":"de","Europe/Copenhagen":"dk","Europe/Dublin":"ie","Europe/Guernsey":"gg","Europe/Helsinki":"fi","Europe/Isle_of_Man":"im","Europe/Istanbul":"tr","Europe/Jersey":"je","Europe/Kaliningrad":"ru","Europe/Kirov":"ru","Europe/Kyiv":"ua","Europe/Lisbon":"pt","Europe/Ljubljana":"si","Europe/London":"gb","Europe/Luxembourg":"lu","Europe/Madrid":"es","Europe/Moscow":"ru","Europe/Oslo":"no","Europe/Paris":"fr","Europe/Prague":"cz","Europe/Riga":"lv","Europe/Rome":"it","Europe/Samara":"ru","Europe/Saratov":"ru","Europe/Simferopol":"ru","Europe/Stockholm":"se","Europe/Tallinn":"ee","Europe/Ulyanovsk":"ru","Europe/Vaduz":"li","Europe/Vienna":"at","Europe/Vilnius":"lt","Europe/Volgograd":"ru","Europe/Warsaw":"pl","Europe/Zagreb":"hr","Europe/Zurich":"ch","Pacific/Auckland":"nz","Pacific/Chatham":"nz","Pacific/Easter":"cl","Pacific/Honolulu":"us"}}),define("discourse/plugins/discourse-calendar/discourse/lib/round-time",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){return e.round(t,"minutes")},"function"!=typeof moment.fn.round&&(moment.fn.round=function(e,t,s){s=s||"round"
let n,i=this,o={hours:{name:"Hours",maxValue:24},minutes:{name:"Minutes",maxValue:60},seconds:{name:"Seconds",maxValue:60},milliseconds:{name:"Milliseconds",maxValue:1e3}},r={mm:o.milliseconds.name,milliseconds:o.milliseconds.name,Milliseconds:o.milliseconds.name,s:o.seconds.name,seconds:o.seconds.name,Seconds:o.seconds.name,m:o.minutes.name,minutes:o.minutes.name,Minutes:o.minutes.name,H:o.hours.name,h:o.hours.name,hours:o.hours.name,Hours:o.hours.name},a=0,d=!1,l=1
if(t.length>1&&"mm"!==t&&"s"!==t.slice(-1)&&(t+="s"),!o[t=r[t].toLowerCase()])throw new Error('The value to round is not valid. Possibles ["hours", "minutes", "seconds", "milliseconds"]')
let c="get"+o[t].name,u="set"+o[t].name
for(let p in o)p===t?(a=i._d[c](),n=o[p].maxValue,d=!0):d&&(l*=o[p].maxValue,a+=i._d["get"+o[p].name]()/l,i._d["set"+o[p].name](0))
return a=Math[s](a/e)*e,a=Math.min(a,n),i._d[u](a),i}),"function"!=typeof moment.fn.ceil&&(moment.fn.ceil=function(e,t){return this.round(e,t,"ceil")}),"function"!=typeof moment.fn.floor&&(moment.fn.floor=function(e,t){return this.round(e,t,"floor")})
const t=15}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event-stats",["exports","@glimmer/tracking"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s{static create(e={}){return new s(e)}static{dt7948.g(this.prototype,"going",[t.tracked],function(){return 0})}#C=void dt7948.i(this,"going")
static{dt7948.g(this.prototype,"interested",[t.tracked],function(){return 0})}#O=void dt7948.i(this,"interested")
static{dt7948.g(this.prototype,"invited",[t.tracked],function(){return 0})}#I=void dt7948.i(this,"invited")
static{dt7948.g(this.prototype,"notGoing",[t.tracked],function(){return 0})}#D=void dt7948.i(this,"notGoing")
constructor(e={}){this.going=e.going,this.invited=e.invited,this.interested=e.interested,this.notGoing=e.not_going}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event",["exports","@glimmer/tracking","@ember/object","@ember-compat/tracked-built-ins","discourse/lib/decorators","discourse/lib/utilities","discourse/models/user","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event-stats","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee"],function(e,t,s,n,i,o,r,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,o.optionalRequire)("discourse/plugins/chat/discourse/models/chat-channel"),c={type:"notification",value:15,unit:"minutes",period:"before"}
class u{static create(e={}){return new u(e)}static{dt7948.g(this.prototype,"title",[t.tracked])}#L=void dt7948.i(this,"title")
static{dt7948.g(this.prototype,"name",[t.tracked])}#U=void dt7948.i(this,"name")
static{dt7948.g(this.prototype,"categoryId",[t.tracked])}#N=void dt7948.i(this,"categoryId")
static{dt7948.g(this.prototype,"startsAt",[t.tracked])}#A=void dt7948.i(this,"startsAt")
static{dt7948.g(this.prototype,"endsAt",[t.tracked])}#k=void dt7948.i(this,"endsAt")
static{dt7948.g(this.prototype,"rawInvitees",[t.tracked])}#R=void dt7948.i(this,"rawInvitees")
static{dt7948.g(this.prototype,"location",[t.tracked])}#F=void dt7948.i(this,"location")
static{dt7948.g(this.prototype,"url",[t.tracked])}#B=void dt7948.i(this,"url")
static{dt7948.g(this.prototype,"description",[t.tracked])}#$=void dt7948.i(this,"description")
static{dt7948.g(this.prototype,"timezone",[t.tracked])}#Y=void dt7948.i(this,"timezone")
static{dt7948.g(this.prototype,"showLocalTime",[t.tracked])}#H=void dt7948.i(this,"showLocalTime")
static{dt7948.g(this.prototype,"status",[t.tracked])}#q=void dt7948.i(this,"status")
static{dt7948.g(this.prototype,"post",[t.tracked])}#W=void dt7948.i(this,"post")
static{dt7948.g(this.prototype,"minimal",[t.tracked])}#G=void dt7948.i(this,"minimal")
static{dt7948.g(this.prototype,"chatEnabled",[t.tracked])}#V=void dt7948.i(this,"chatEnabled")
static{dt7948.g(this.prototype,"canUpdateAttendance",[t.tracked])}#J=void dt7948.i(this,"canUpdateAttendance")
static{dt7948.g(this.prototype,"canActOnDiscoursePostEvent",[t.tracked])}#K=void dt7948.i(this,"canActOnDiscoursePostEvent")
static{dt7948.g(this.prototype,"shouldDisplayInvitees",[t.tracked])}#Z=void dt7948.i(this,"shouldDisplayInvitees")
static{dt7948.g(this.prototype,"isClosed",[t.tracked])}#Q=void dt7948.i(this,"isClosed")
static{dt7948.g(this.prototype,"isExpired",[t.tracked])}#X=void dt7948.i(this,"isExpired")
static{dt7948.g(this.prototype,"isStandalone",[t.tracked])}#ee=void dt7948.i(this,"isStandalone")
static{dt7948.g(this.prototype,"recurrenceUntil",[t.tracked])}#te=void dt7948.i(this,"recurrenceUntil")
static{dt7948.g(this.prototype,"recurrence",[t.tracked])}#se=void dt7948.i(this,"recurrence")
static{dt7948.g(this.prototype,"recurrenceRule",[t.tracked])}#ne=void dt7948.i(this,"recurrenceRule")
static{dt7948.g(this.prototype,"customFields",[t.tracked])}#ie=void dt7948.i(this,"customFields")
static{dt7948.g(this.prototype,"channel",[t.tracked])}#oe=void dt7948.i(this,"channel")
static{dt7948.g(this.prototype,"_watchingInvitee",[t.tracked])}#re=void dt7948.i(this,"_watchingInvitee")
static{dt7948.g(this.prototype,"_sampleInvitees",[t.tracked])}#ae=void dt7948.i(this,"_sampleInvitees")
static{dt7948.g(this.prototype,"_stats",[t.tracked])}#de=void dt7948.i(this,"_stats")
static{dt7948.g(this.prototype,"_creator",[t.tracked])}#le=void dt7948.i(this,"_creator")
static{dt7948.g(this.prototype,"_reminders",[t.tracked])}#ce=void dt7948.i(this,"_reminders")
constructor(e={}){this.id=e.id,this.name=e.name,this.categoryId=e.category_id,this.upcomingDates=e.upcoming_dates,this.startsAt=e.starts_at,this.endsAt=e.ends_at,this.rawInvitees=e.raw_invitees,this.sampleInvitees=e.sample_invitees||[],this.location=e.location,this.url=e.url,this.description=e.description,this.timezone=e.timezone,this.showLocalTime=e.show_local_time,this.status=e.status,this.creator=e.creator,this.post=e.post,this.isClosed=e.is_closed,this.isExpired=e.is_expired,this.isStandalone=e.is_standalone,this.minimal=e.minimal,this.chatEnabled=e.chat_enabled,this.recurrenceRule=e.recurrence_rule,this.recurrence=e.recurrence,this.recurrenceUntil=e.recurrence_until,this.canUpdateAttendance=e.can_update_attendance,this.canActOnDiscoursePostEvent=e.can_act_on_discourse_post_event,this.shouldDisplayInvitees=e.should_display_invitees,this.watchingInvitee=e.watching_invitee,this.stats=e.stats,this.reminders=e.reminders
this.customFields=s.default.create(e.custom_fields||{}),e.channel&&l&&(this.channel=l.create(e.channel))}get watchingInvitee(){return this._watchingInvitee}set watchingInvitee(e){this._watchingInvitee=e?d.default.create(e):null}get sampleInvitees(){return this._sampleInvitees}set sampleInvitees(e=[]){this._sampleInvitees=new n.TrackedArray(e.map(e=>d.default.create(e)))}get stats(){return this._stats}set stats(e){this._stats=this.#ue(e)}get reminders(){return this._reminders}set reminders(e=[]){this._reminders=new n.TrackedArray(e)}get creator(){return this._creator}set creator(e){this._creator=this.#pe(e)}get isPublic(){return"public"===this.status}get isPrivate(){return"private"===this.status}updateFromEvent(e){this.name=e.name,this.startsAt=e.startsAt,this.endsAt=e.endsAt,this.location=e.location,this.url=e.url,this.timezone=e.timezone,this.showLocalTime=e.showLocalTime,this.description=e.description,this.status=e.status,this.creator=e.creator,this.isClosed=e.isClosed,this.isExpired=e.isExpired,this.isStandalone=e.isStandalone,this.minimal=e.minimal,this.chatEnabled=e.chatEnabled,this.recurrenceRule=e.recurrenceRule,this.recurrence=e.recurrence,this.recurrenceUntil=e.recurrenceUntil,this.canUpdateAttendance=e.canUpdateAttendance,this.canActOnDiscoursePostEvent=e.canActOnDiscoursePostEvent,this.shouldDisplayInvitees=e.shouldDisplayInvitees,this.stats=e.stats,this.sampleInvitees=e.sampleInvitees||[],this.reminders=e.reminders}removeReminder(e){const t=this.reminders.findIndex(t=>t.id===e.id)
t>-1&&this.reminders.splice(t,1)}static{dt7948.n(this.prototype,"removeReminder",[i.bind])}addReminder(e){e??={...c},this.reminders.push(e)}static{dt7948.n(this.prototype,"addReminder",[i.bind])}#pe(e){return!e||e instanceof r.default?e:r.default.create(e)}#ue(e){return!e||e instanceof a.default?e:a.default.create(e)}}e.default=u}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee",["exports","@glimmer/tracking","discourse/models/user"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n{static create(e={}){return new n(e)}static{dt7948.g(this.prototype,"status",[t.tracked])}#q=void dt7948.i(this,"status")
constructor(e={}){this.id=e.id,this.post_id=e.post_id,this.status=e.status,this.user=this.#pe(e.user)}#pe(e){return!e||e instanceof s.default?e:s.default.create(e)}}e.default=n}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitees",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/models/user","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static create(e={}){return new o(e)}static{dt7948.g(this.prototype,"_invitees",[t.tracked])}#me=void dt7948.i(this,"_invitees")
static{dt7948.g(this.prototype,"_suggestedUsers",[t.tracked])}#ve=void dt7948.i(this,"_suggestedUsers")
constructor(e={}){this.invitees=e.invitees||[],this.suggestedUsers=e.meta?.suggested_users||[]}get invitees(){return this._invitees}set invitees(e=[]){this._invitees=new s.TrackedArray(e.map(e=>i.default.create(e)))}get suggestedUsers(){return this._suggestedUsers}set suggestedUsers(e=[]){this._suggestedUsers=new s.TrackedArray(e.map(e=>n.default.create(e)))}add(e){this.invitees.push(e),this.suggestedUsers=this.suggestedUsers.filter(t=>t.id!==e.user.id)}remove(e){this.invitees=this.invitees.filter(t=>t.user.id!==e.user.id)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-reminder",["exports","discourse/models/rest"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{init(){super.init(...arguments),this.__type="discourse-post-event-reminder"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/pre-initializers/rich-editor-extension",["exports","@ember/string","discourse/lib/plugin-api","discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator"],function(e,t,s,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i={nodeSpec:{event:{attrs:{name:{default:null},start:{default:null},end:{default:null},reminders:{default:null},minimal:{default:null},closed:{default:null},status:{default:"public"},timezone:{default:"UTC"},showLocalTime:{default:null},allowedGroups:{default:null},recurrence:{default:null},recurrenceUntil:{default:null},chatEnabled:{default:null},chatChannelId:{default:null}},group:"block",defining:!0,isolating:!0,draggable:!0,parseDOM:[{tag:"div.discourse-post-event",getAttrs:e=>({...e.dataset})}],toDOM(e){const t=document.createElement("div")
t.classList.add("discourse-post-event")
for(const[s,n]of Object.entries(e.attrs))null!==n&&(t.dataset[s]=n)
return(0,n.buildEventPreview)(t),t}}},parse:{wrap_bbcode(e,s){if("div"===s.tag){if(-1===s.nesting&&"event"===e.top().type.name)return e.closeNode(),!0
if(1===s.nesting&&"discourse-post-event"===s.attrGet("class")){const n=Object.fromEntries(s.attrs.filter(([e])=>e.startsWith("data-")).map(([e,s])=>[(0,t.camelize)(e.slice(5)),s]))
return e.openNode(e.schema.nodes.event,n),!0}}return!1}},serializeNode:{event(e,t){let s="[event"
Object.entries(t.attrs).forEach(([e,t])=>{null!==t&&(s+=` ${e}="${t}"`)}),s+="]\n[/event]\n",e.write(s)}}}
e.default={initialize(){(0,s.withPluginApi)(e=>{e.registerRichEditorExtension(i)})}}}),define("discourse/plugins/discourse-calendar/discourse/pre-initializers/transformers",["exports","discourse/lib/plugin-api"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={before:"freeze-valid-transformers",initialize(){(0,t.withPluginApi)(e=>{e.addValueTransformerName("discourse-calendar-event-more-menu-should-show-participants")})}}}),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events-index",["exports","@ember/object","@ember/service","discourse/lib/url","discourse/routes/discourse"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends i.default{static{dt7948.g(this.prototype,"discoursePostEventService",[s.service])}#he=void dt7948.i(this,"discoursePostEventService")
activate(){this.siteSettings.discourse_post_event_enabled||n.default.redirectTo("/404")}static{dt7948.n(this.prototype,"activate",[t.action])}async model(e){return await this.discoursePostEventService.fetchEvents(e)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events-mine",["exports","@ember/object","@ember/service","discourse/lib/url","discourse/routes/discourse"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends i.default{static{dt7948.g(this.prototype,"discoursePostEventApi",[s.service])}#i=void dt7948.i(this,"discoursePostEventApi")
static{dt7948.g(this.prototype,"discoursePostEventService",[s.service])}#he=void dt7948.i(this,"discoursePostEventService")
static{dt7948.g(this.prototype,"currentUser",[s.service])}#n=void dt7948.i(this,"currentUser")
activate(){this.siteSettings.discourse_post_event_enabled||n.default.redirectTo("/404")}static{dt7948.n(this.prototype,"activate",[t.action])}async model(e){return e.attending_user=this.currentUser?.username,await this.discoursePostEventService.fetchEvents(e)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/services/discourse-post-event-api",["exports","@ember/service","discourse/lib/ajax","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitees"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{async event(e){const t=await this.#fe(`/events/${e}`)
return n.default.create(t.event)}async events(e={}){return(await this.#fe("/events",e)).events.map(e=>n.default.create(e))}async listEventInvitees(e,t={}){const s=await this.#fe(`/events/${e.id}/invitees`,t)
return o.default.create(s)}async updateEvent(e,t={}){const s=await this.#ge(`/events/${e.id}`,{event:t})
return e.updateFromEvent(s),e}async updateEventAttendance(e,t={}){if(!e.watchingInvitee)return
const s=await this.#ge(`/events/${e.id}/invitees/${e.watchingInvitee.id}`,{invitee:t})
return e.watchingInvitee=i.default.create(s.invitee),e.sampleInvitees.forEach(t=>{t.id===e.watchingInvitee.id&&(t.status=e.watchingInvitee.status)}),e.stats=s.invitee.meta.event_stats,e.shouldDisplayInvitees=s.invitee.meta.event_should_display_invitees,e}async leaveEvent(e,t){await this.#_e(`/events/${e.id}/invitees/${t.id}`),e.sampleInvitees=e.sampleInvitees.filter(e=>e.id!==t.id),e.watchingInvitee?.id===t.id&&(e.watchingInvitee=null)}async joinEvent(e,t={}){const s=await this.#be(`/events/${e.id}/invitees`,{invitee:t}),n=i.default.create(s.invitee)
return t.user_id||(e.watchingInvitee=n,e.sampleInvitees.push(e.watchingInvitee)),e.stats=s.invitee.meta.event_stats,e.shouldDisplayInvitees=s.invitee.meta.event_should_display_invitees,n}get#ye(){return"/discourse-post-event"}#fe(e,t={}){return(0,s.ajax)(`${this.#ye}${e}`,{type:"GET",data:t})}#ge(e,t={}){return(0,s.ajax)(`${this.#ye}${e}`,{type:"PUT",data:t})}#be(e,t={}){return(0,s.ajax)(`${this.#ye}${e}`,{type:"POST",data:t})}#_e(e,t={}){return(0,s.ajax)(`${this.#ye}${e}`,{type:"DELETE",data:t})}}e.default=r}),define("discourse/plugins/discourse-calendar/discourse/services/discourse-post-event-service",["exports","@ember/service"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{static{dt7948.g(this.prototype,"siteSettings",[t.service])}#t=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"discoursePostEventApi",[t.service])}#i=void dt7948.i(this,"discoursePostEventApi")
async fetchEvents(e={}){this.siteSettings.include_expired_events_on_calendar&&(e.include_expired=!0)
const t=await this.discoursePostEventApi.events(e)
return await t}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/templates/admin-plugins-calendar",["exports","ember-route-template","discourse/components/conditional-loading-spinner","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list","discourse/plugins/discourse-calendar/discourse/components/region-input","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o,r,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.default)((0,r.setComponentTemplate)((0,a.createTemplateFactory)({id:"7aALn6cy",block:'[[[1,"\\n    "],[10,"h3"],[12],[1,"\\n      "],[1,[28,[32,0],["discourse_calendar.holidays.header_title"],null]],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[32,1],null,[["@value","@onChange"],[[30,1,["selectedRegion"]],[30,1,["getHolidays"]]]],null],[1,"\\n\\n    "],[10,2],[14,0,"desc"],[12],[1,"\\n      "],[1,[28,[32,0],["discourse_calendar.holidays.pick_region_description"],null]],[1,"\\n      "],[10,"br"],[12],[13],[10,"br"],[12],[13],[1,"\\n      "],[1,[28,[32,0],["discourse_calendar.holidays.disabled_holidays_description"],null]],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[32,2],null,[["@condition"],[[30,1,["loading"]]]],null],[1,"\\n\\n"],[41,[30,1,["model","holidays"]],[[[1,"      "],[8,[32,3],null,[["@holidays","@region_code"],[[30,1,["model","holidays"]],[30,1,["selectedRegion"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],["@controller"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/templates/admin-plugins-calendar.js",scope:()=>[n.i18n,o.default,s.default,i.default],isStrictMode:!0}),(0,d.default)(void 0,void 0)))}),define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events-index",["exports","ember-route-template","discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.default)((0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"SbakckJ+",block:'[[[1,"\\n    "],[10,0],[14,0,"discourse-post-event-upcoming-events"],[12],[1,"\\n      "],[8,[32,0],null,[["@controller"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@controller"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events-index.js",scope:()=>[s.default],isStrictMode:!0}),(0,o.default)(void 0,void 0)))}),define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events-mine",["exports","ember-route-template","discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.default)((0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"cicwjyFO",block:'[[[1,"\\n    "],[10,0],[14,0,"discourse-post-event-upcoming-events"],[12],[1,"\\n      "],[8,[32,0],null,[["@controller"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@controller"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events-mine.js",scope:()=>[s.default],isStrictMode:!0}),(0,o.default)(void 0,void 0)))}),define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events",["exports","ember-route-template","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.default)((0,s.setComponentTemplate)((0,n.createTemplateFactory)({id:"LN3r6xpl",block:'[[[46,[28,[31,1],null,null],null,null,null]],[],false,["component","-outlet"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events.js",isStrictMode:!0}),(0,i.default)(void 0,void 0)))})

//# sourceMappingURL=discourse-calendar-412d5c3e.map